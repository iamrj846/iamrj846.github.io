
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
            <!-- Google tag (gtag.js) -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
            <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-TFCQEJR7TD');
            </script>
            
            <title>How do I use Redis transactions?</title>
            <meta name="description" content="Learn how to use Redis transactions effectively with our step-by-step guide. Master atomic operations and data integrity today!">
            <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	        <script src="/assets/js/blog.js"></script>
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">How do I use Redis transactions?</h1>
                        </header>

                        <div class="blog-post-body">
                            <h1 id="redis-transactions-a-beginners-guide">Redis Transactions: A
Beginner’s Guide</h1>
<p>Redis transactions are a handy tool. They let us run a group of
commands in one go. This way, we make sure that either all commands work
or none do. This keeps our data safe. We start a transaction with the
MULTI command. Then, we add our commands. Finally, we finish with the
EXEC command. This process is very important when we need our data to be
consistent and reliable.</p>
<p>In this article, we will talk about how to use Redis transactions
well. We will cover important topics like what Redis transactions are,
how they work, how to start a transaction with MULTI, how to run
commands, how to deal with mistakes, and some examples. We will also
look at the limits of Redis transactions and answer common questions
about this feature. Here is what we will learn:</p>
<ul>
<li>How can we use Redis transactions well?</li>
<li>What are Redis transactions and how do they work?</li>
<li>How do we start a Redis transaction with MULTI?</li>
<li>How do we run commands in a Redis transaction?</li>
<li>How do we deal with mistakes in Redis transactions?</li>
<li>Some examples of using Redis transactions</li>
<li>What are the limits of Redis transactions?</li>
<li>Common questions</li>
</ul>
<p>If we want to learn more about Redis, we can check out articles on <a
href="https://bestonlinetutorial.com/redis/what-is-redis.html">what
Redis is</a>, <a
href="https://bestonlinetutorial.com/redis/how-do-i-install-redis.html">how
to install Redis</a>, and <a
href="https://bestonlinetutorial.com/redis/what-are-redis-data-types.html">what
Redis data types are available</a>.</p>
<h2 id="what-are-redis-transactions-and-how-do-they-work">What are Redis
transactions and how do they work?</h2>
<p>Redis transactions let us run a group of commands as one operation.
This means that either all commands work, or none do. This helps keep
our data safe and correct. We use the <code>MULTI</code>,
<code>EXEC</code>, <code>WATCH</code>, and <code>DISCARD</code> commands
to manage transactions in Redis.</p>
<h3 id="key-concepts-of-redis-transactions">Key Concepts of Redis
Transactions:</h3>
<ul>
<li><strong>Atomicity</strong>: All commands run one after the other and
as a single unit.</li>
<li><strong>Isolation</strong>: Commands in a transaction do not mix
with others.</li>
<li><strong>No Rollback</strong>: If one command does not work, the
whole transaction still runs. But the command that failed will not
run.</li>
</ul>
<h3 id="how-redis-transactions-work">How Redis Transactions Work:</h3>
<ol type="1">
<li><strong>Start Transaction</strong>: We start with the
<code>MULTI</code> command to begin a transaction.</li>
<li><strong>Queue Commands</strong>: After <code>MULTI</code>, we add
all the next commands to a list.</li>
<li><strong>Execute Commands</strong>: We use the <code>EXEC</code>
command to run all commands in the list at once.</li>
<li><strong>Handle Errors</strong>: If a command fails, it tells us
there is an error, but the other commands still run.</li>
</ol>
<h3 id="example-of-a-redis-transaction">Example of a Redis
Transaction:</h3>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">MULTI</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">SET</span> key1 <span class="st">&quot;value1&quot;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">SET</span> key2 <span class="st">&quot;value2&quot;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="ex">INCR</span> counter</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="ex">EXEC</span></span></code></pre></div>
<p>In this example, we set <code>key1</code> and <code>key2</code>, and
we increase <code>counter</code> all in one transaction. If one command
fails, the transaction still finishes, but the failed command does not
run.</p>
<h3 id="important-command-details">Important Command Details:</h3>
<ul>
<li><strong>MULTI</strong>: This starts a transaction block.</li>
<li><strong>EXEC</strong>: This runs all commands in the
transaction.</li>
<li><strong>DISCARD</strong>: This stops the transaction and clears the
list of commands.</li>
<li><strong>WATCH</strong>: This looks at certain keys for changes
before running the transaction. It helps with optimistic locking.</li>
</ul>
<p>For more details about Redis transactions, visit <a
href="https://bestonlinetutorial.com/redis/what-are-redis-transactions.html">What
are Redis transactions?</a>.</p>
<h2 id="how-do-i-start-a-redis-transaction-with-multi">How do I start a
Redis transaction with MULTI?</h2>
<p>To start a Redis transaction, we use the <code>MULTI</code> command.
This command begins a block where all the next commands will wait until
we call <code>EXEC</code> to run them all together. Here is how we start
a transaction:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">MULTI</span></span></code></pre></div>
<p>After we use the <code>MULTI</code> command, Redis will say
<code>OK</code>. This means the transaction has started. Now we can add
more commands. For example:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">MULTI</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">OK</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="ex">SET</span> key1 <span class="st">&quot;value1&quot;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="ex">QUEUED</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="ex">SET</span> key2 <span class="st">&quot;value2&quot;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="ex">QUEUED</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="ex">INCR</span> counter</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="ex">QUEUED</span></span></code></pre></div>
<p>In this example, the commands <code>SET key1 "value1"</code>,
<code>SET key2 "value2"</code>, and <code>INCR counter</code> are now
waiting to run.</p>
<p>When we have added all the commands we need, we can run them using
<code>EXEC</code>:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">EXEC</span></span></code></pre></div>
<p>This command will run all the waiting commands at once. If we want to
cancel the transaction, we can use <code>DISCARD</code>:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">DISCARD</span></span></code></pre></div>
<p>This will remove all the waiting commands and bring Redis back to
normal.</p>
<p>We need to remember that all commands must be correct Redis commands.
If one command fails when we run them, Redis will not run the other
commands in the transaction. If we want to learn more, we can check out
the details on <a
href="https://bestonlinetutorial.com/redis/what-are-redis-transactions.html">what
are Redis transactions</a>.</p>
<h2 id="how-do-we-execute-commands-in-a-redis-transaction">How do we
execute commands in a Redis transaction?</h2>
<p>To execute commands in a Redis transaction, we first need to start
the transaction with the <code>MULTI</code> command. After we start it,
we can add many commands. These commands will run all together when we
call the <code>EXEC</code> command. This way, we make sure either all
commands run or none do. This helps keep our data safe.</p>
<h3 id="step-by-step-execution">Step-by-step execution:</h3>
<ol type="1">
<li><p><strong>Start a transaction:</strong> We use the
<code>MULTI</code> command to start the transaction.</p>
<pre class="redis"><code>MULTI</code></pre></li>
<li><p><strong>Queue commands:</strong> We add commands that we want to
run in the transaction. These commands do not run right away. They are
just lined up for later.</p>
<pre class="redis"><code>SET key1 &quot;value1&quot;
INCR counter
LPUSH mylist &quot;item1&quot;</code></pre></li>
<li><p><strong>Execute the transaction:</strong> We call the
<code>EXEC</code> command to run all the commands we lined up.</p>
<pre class="redis"><code>EXEC</code></pre></li>
</ol>
<h3 id="example">Example:</h3>
<p>Here is a full example showing how we can execute commands in a Redis
transaction:</p>
<pre class="redis"><code>127.0.0.1:6379&gt; MULTI
OK
127.0.0.1:6379&gt; SET user:1000 &quot;Alice&quot;
QUEUED
127.0.0.1:6379&gt; INCR user:1000:login_count
QUEUED
127.0.0.1:6379&gt; LPUSH user:1000:messages &quot;Hello!&quot;
QUEUED
127.0.0.1:6379&gt; EXEC
1) OK
2) (integer) 1
3) (integer) 1</code></pre>
<h3 id="important-notes">Important Notes:</h3>
<ul>
<li>If any command inside the transaction fails, like if there is a
mistake in the command, none of the commands will run.</li>
<li>We can cancel the queued commands by using the <code>DISCARD</code>
command before we run <code>EXEC</code>.</li>
</ul>
<p>For more details about Redis transactions, we can check <a
href="https://bestonlinetutorial.com/redis/what-are-redis-transactions.html">what
are Redis transactions</a>.</p>
<h2 id="how-do-we-handle-errors-in-redis-transactions">How do we handle
errors in Redis transactions?</h2>
<p>In Redis, handling errors during transactions is very important for
keeping our data safe. When we start a transaction, we use the
<code>MULTI</code> command. This command gets Redis ready to run a list
of commands as one unit. But if something goes wrong while executing,
the whole transaction will be canceled if the <code>EXEC</code> command
does not run right.</p>
<h3 id="key-points-on-error-handling">Key Points on Error Handling:</h3>
<ul>
<li><p><strong>Watch Command</strong>: We should use the
<code>WATCH</code> command before starting a transaction. This helps us
keep an eye on the keys. If any of the watched keys change, the
transaction will fail when we try to execute it. This way, we can manage
the error better.</p></li>
<li><p><strong>Discarding Transactions</strong>: If we face a problem,
we can stop the transaction by using the <code>DISCARD</code>
command.</p></li>
<li><p><strong>Error Response</strong>: If a command in the transaction
does not work (like a syntax mistake or wrong data type), Redis will
give us an error. Then, the following commands will not run.</p></li>
</ul>
<h3 id="example-1">Example:</h3>
<pre class="redis"><code>WATCH key1
MULTI
SET key1 &quot;value1&quot;
SET key2 &quot;value2&quot;
EXEC</code></pre>
<p>If another client changes <code>key1</code> after the
<code>WATCH</code> command, the <code>EXEC</code> will not work. Redis
will then give a <code>nil</code> response. We can manage this in our
application code like this:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> redis</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> redis.Redis()</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Start a transaction</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    r.watch(<span class="st">&#39;key1&#39;</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    pipe <span class="op">=</span> r.pipeline()</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    pipe.multi()</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    pipe.<span class="bu">set</span>(<span class="st">&#39;key1&#39;</span>, <span class="st">&#39;value1&#39;</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    pipe.<span class="bu">set</span>(<span class="st">&#39;key2&#39;</span>, <span class="st">&#39;value2&#39;</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    pipe.execute()</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> redis.WatchError:</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Transaction failed due to a watched key being modified.&quot;</span>)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    r.unwatch()  <span class="co"># Unwatch the keys</span></span></code></pre></div>
<p>This example shows how we can use the <code>WATCH</code> command to
check for changes and manage possible transaction failures by catching
errors.</p>
<p>For more details on Redis transactions, check this link: <a
href="https://bestonlinetutorial.com/redis/what-are-redis-transactions.html">What
are Redis transactions?</a>.</p>
<h2 id="practical-examples-of-using-redis-transactions">Practical
examples of using Redis transactions</h2>
<p>Redis transactions let us run a group of commands all at once. This
helps us keep data safe and accurate. Here are some simple examples that
show how to use Redis transactions well.</p>
<h3 id="example-1-basic-usage-of-multiexec">Example 1: Basic Usage of
MULTI/EXEC</h3>
<p>To start a transaction, we first use the <code>MULTI</code> command.
Then, we add our commands. Finally, we run them with <code>EXEC</code>.
Here is a basic example:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> MULTI</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="ex">OK</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> SET key1 <span class="st">&quot;value1&quot;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="ex">QUEUED</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> INCR counter</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="ex">QUEUED</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> EXEC</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="ex">1</span><span class="er">)</span> <span class="ex">OK</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="ex">2</span><span class="er">)</span> <span class="kw">(</span><span class="ex">integer</span><span class="kw">)</span> <span class="ex">1</span></span></code></pre></div>
<p>In this example, we set the key <code>key1</code> and increase a
counter at the same time.</p>
<h3 id="example-2-using-watch-for-optimistic-locking">Example 2: Using
WATCH for Optimistic Locking</h3>
<p>We can use the <code>WATCH</code> command to do optimistic locking.
This lets us watch keys for changes before we run the transaction:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> WATCH key1</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="ex">OK</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> GET key1</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;value1&quot;</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> MULTI</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="ex">OK</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> SET key1 <span class="st">&quot;new_value&quot;</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="ex">QUEUED</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> EXEC</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="ex">1</span><span class="er">)</span> <span class="ex">OK</span></span></code></pre></div>
<p>If another client changes <code>key1</code> after we use
<code>WATCH</code> but before we do <code>EXEC</code>, the transaction
will not work and will give us <code>nil</code>.</p>
<h3 id="example-3-managing-user-balance">Example 3: Managing User
Balance</h3>
<p>Let’s say we want to manage user balances in a money app:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> MULTI</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="ex">OK</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> DECR balance:user123 50</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="ex">QUEUED</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> INCR balance:user456 50</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="ex">QUEUED</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> EXEC</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="ex">1</span><span class="er">)</span> <span class="kw">(</span><span class="ex">integer</span><span class="kw">)</span> <span class="ex">950</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="ex">2</span><span class="er">)</span> <span class="kw">(</span><span class="ex">integer</span><span class="kw">)</span> <span class="ex">1050</span></span></code></pre></div>
<p>This transaction lowers <code>user123</code>’s balance by 50 and
raises <code>user456</code>’s balance by 50 all at once.</p>
<h3 id="example-4-batch-processing-with-redis-lists">Example 4: Batch
Processing with Redis Lists</h3>
<p>We can also use transactions to add many items to lists:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> MULTI</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="ex">OK</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> LPUSH tasks <span class="st">&quot;task1&quot;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="ex">QUEUED</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> LPUSH tasks <span class="st">&quot;task2&quot;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="ex">QUEUED</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> LPUSH tasks <span class="st">&quot;task3&quot;</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="ex">QUEUED</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> EXEC</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="ex">1</span><span class="er">)</span> <span class="kw">(</span><span class="ex">integer</span><span class="kw">)</span> <span class="ex">3</span></span></code></pre></div>
<p>In this example, we add three tasks to the <code>tasks</code> list in
one go.</p>
<h3 id="example-5-conditional-updates">Example 5: Conditional
Updates</h3>
<p>With <code>WATCH</code>, we can update keys based on their
values:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> WATCH stock:item1</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="ex">OK</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> GET stock:item1</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;10&quot;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> MULTI</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="ex">OK</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> DECR stock:item1</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="ex">QUEUED</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="ex">127.0.0.1:6379</span><span class="op">&gt;</span> EXEC</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="ex">1</span><span class="er">)</span> <span class="kw">(</span><span class="ex">integer</span><span class="kw">)</span> <span class="ex">9</span></span></code></pre></div>
<p>Here, the stock for <code>item1</code> goes down if no one else
changed it between the <code>WATCH</code> and <code>EXEC</code>.</p>
<p>These examples show how we can use Redis transactions to keep data
safe and do batch tasks easily. For more details about Redis
transactions, we can check <a
href="https://bestonlinetutorial.com/redis/what-are-redis-transactions.html">what
are Redis transactions</a>.</p>
<h2 id="what-are-the-limitations-of-redis-transactions">What are the
limitations of Redis transactions?</h2>
<p>Redis transactions help us to run a series of commands together as
one operation. We use the <code>MULTI</code>, <code>EXEC</code>, and
<code>WATCH</code> commands for this. But there are some limits we
should know when we use Redis transactions.</p>
<ol type="1">
<li><p><strong>No Rollback</strong>: After we run a transaction with
<code>EXEC</code>, all commands will be done. There is no way to go back
if something goes wrong.</p></li>
<li><p><strong>Atomicity at Command Level</strong>: Redis transactions
only make sure that the whole transaction is atomic. If one command
fails inside the transaction, Redis does not stop the whole transaction.
It just skips the failed command.</p></li>
<li><p><strong>No Isolation</strong>: Redis transactions do not keep
transactions separate. If many clients run transactions at the same
time, they might see other transactions’ temporary states.</p></li>
<li><p><strong>Limited Command Set</strong>: We cannot use all Redis
commands in transactions. Some commands like <code>SUBSCRIBE</code>,
<code>UNSUBSCRIBE</code>, and <code>PUBLISH</code> are not allowed in a
transaction.</p></li>
<li><p><strong>WATCH Command Limitations</strong>: The
<code>WATCH</code> command helps with optimistic locking. But if the
keys we watch change before we run the transaction, the transaction will
fail.</p></li>
<li><p><strong>Blocking Commands</strong>: If any command in a
transaction takes a long time (like <code>BLPOP</code>), the whole
transaction will wait until that command can run.</p></li>
<li><p><strong>No Nested Transactions</strong>: Redis does not allow
nested transactions. If we try to start a new transaction inside an
existing one, we will get an error.</p></li>
<li><p><strong>Single Database Context</strong>: Transactions work only
in one Redis database. We cannot run commands in different databases in
a single transaction.</p></li>
</ol>
<p>For more details on Redis transactions, we can check out <a
href="https://bestonlinetutorial.com/redis/what-are-redis-transactions.html">what
are Redis transactions</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3 id="what-are-redis-transactions">1. What are Redis
transactions?</h3>
<p>Redis transactions are a group of commands. We can run them at once.
This means they all succeed or none do. It is important to keep data
safe when we do many operations. To learn more, see our guide on <a
href="https://bestonlinetutorial.com/redis/what-are-redis-transactions.html">what
are Redis transactions</a>.</p>
<h3 id="how-do-i-start-a-redis-transaction-with-multi-1">2. How do I
start a Redis transaction with MULTI?</h3>
<p>To start a Redis transaction, we use the <code>MULTI</code> command.
This tells Redis that the next commands will run in a transaction. It
helps us group commands together. This way, they run in order and
safely. For more details on commands, check our article on <a
href="https://bestonlinetutorial.com/redis/how-do-i-work-with-redis-strings.html">how
do I work with Redis strings</a>.</p>
<h3 id="can-redis-transactions-handle-errors">3. Can Redis transactions
handle errors?</h3>
<p>Yes, Redis transactions can handle errors. But it is not like
traditional databases. If one command fails during a transaction, Redis
keeps running the other commands. However, the whole transaction will
not be successful. To know more about errors in Redis transactions, look
at our guide on <a
href="https://bestonlinetutorial.com/redis/what-are-redis-data-types.html">what
are Redis data types</a>.</p>
<h3 id="what-are-the-limitations-of-redis-transactions-1">4. What are
the limitations of Redis transactions?</h3>
<p>Redis transactions have some limits. They do not have rollback
features or isolation levels. If one command fails, the transaction will
still run the other commands. This can cause partial updates. For more
details about the limits of Redis transactions, read our article on <a
href="https://bestonlinetutorial.com/redis/how-do-i-install-redis.html">how
do I install Redis</a>.</p>
<h3 id="how-can-i-implement-redis-transactions-in-real-applications">5.
How can I implement Redis transactions in real applications?</h3>
<p>To use Redis transactions in real applications, we usually start with
the <code>MULTI</code> command. Then, we add the commands we want to run
together. Finally, we call <code>EXEC</code> to run them all at the same
time. This is very useful when we need data to be correct. For examples,
see our guide on <a
href="https://bestonlinetutorial.com/redis/what-are-redis-transactions.html">practical
examples of using Redis transactions</a>.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            