
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
            <!-- Google tag (gtag.js) -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
            <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-TFCQEJR7TD');
            </script>
            <meta charset="utf-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            
            <meta property="og:title" content="How Can You Implement Redis Key Expire Notifications Using Jedis?" />
            <meta property="og:description" content="Learn to implement Redis key expire notifications with Jedis in this comprehensive guide for efficient data management strategies." />
            <meta property="og:url" content="https://www.bestonlinetutorial.com/redis/how-can-you-implement-redis-key-expire-notifications-using-jedis.html" />
            <link rel="canonical" href="https://www.bestonlinetutorial.com/redis/how-can-you-implement-redis-key-expire-notifications-using-jedis.html">
            <meta property="og:type" content="article" />
            <meta property="og:site_name" content=“BestOnlineTutorial” />
            <meta name="twitter:title" content="How Can You Implement Redis Key Expire Notifications Using Jedis?" />
            <meta name="twitter:description" content="Learn to implement Redis key expire notifications with Jedis in this comprehensive guide for efficient data management strategies." />
            <meta name="pinterest-rich-pin" content="true" />

            <script type="application/ld+json">
                {
                "@context": "https://schema.org",
                "@type": "WebSite",
                "name": "BestOnlineTutorial",
                "url": "https://www.bestonlinetutorial.com/"
                }
            </script>
            <!-- Common CSS & Icons -->
            <link rel="icon" href="/favicon.ico" type="image/x-icon">
            <link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
            <link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
            <link rel="stylesheet" href="/assets/css/post.css">
            <title>How Can You Implement Redis Key Expire Notifications Using Jedis?</title>
            <meta name="description" content="Learn to implement Redis key expire notifications with Jedis in this comprehensive guide for efficient data management strategies.">
            <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	        <script src="/assets/js/blog.js"></script>
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">How Can You Implement Redis Key Expire Notifications Using Jedis?</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>To use Redis key expire notifications with Jedis, we need to set up
Redis first. We should make Redis send out expiration events. Then, we
will create a subscriber in our application. This way, we can know when
keys expire. It helps us to manage these events in our application. By
using Jedis, a popular Java client for Redis, we can easily get these
notifications. This makes our application respond better to key
expirations.</p>
<p>In this article, we will look at how to use Redis key expire
notifications with Jedis. We will talk about important topics like how
the Redis key expiration works. We will also see how to set up Jedis for
notifications. Next, we will configure Redis to send expiration events.
Then, we will learn how to subscribe to these notifications using Jedis.
Lastly, we will explain how to manage expiration events in our
application. Here is what we will explore:</p>
<ul>
<li>How to Implement Redis Key Expire Notifications Using Jedis</li>
<li>Understanding Redis Key Expiration Mechanism</li>
<li>Setting Up Jedis for Redis Key Expire Notifications</li>
<li>Configuring Redis to Publish Expiration Events</li>
<li>Subscribing to Key Expire Notifications with Jedis</li>
<li>Handling Expiration Events in Your Application</li>
<li>Frequently Asked Questions</li>
</ul>
<h2 id="understanding-redis-key-expiration-mechanism">Understanding
Redis Key Expiration Mechanism</h2>
<p>We can use Redis key expiration to set a lifetime for keys. When a
key reaches its expiration time, Redis deletes it by itself. This is
helpful for caching and managing temporary data.</p>
<h3 id="key-concepts">Key Concepts</h3>
<ul>
<li><strong>TTL (Time To Live)</strong>: This is the time after which a
key will expire. It is set in seconds.</li>
<li><strong>Expire Command</strong>: We can set expiration on a key
using the <code>EXPIRE</code> command.</li>
<li><strong>Timeouts</strong>: Redis can expire keys in two ways:
<ul>
<li><strong>Passive expiration</strong>: The key gets removed only when
we try to access it after it has expired.</li>
<li><strong>Active expiration</strong>: Redis looks at keys regularly
and removes those that have expired.</li>
</ul></li>
</ul>
<h3 id="commands">Commands</h3>
<ul>
<li><p>To set expiration on a key:</p>
<pre class="plaintext"><code>EXPIRE mykey 3600  # Set key expiration time to 1 hour</code></pre></li>
<li><p>To get the remaining time to live:</p>
<pre class="plaintext"><code>TTL mykey  # Returns the remaining time in seconds</code></pre></li>
<li><p>To remove a key:</p>
<pre class="plaintext"><code>DEL mykey</code></pre></li>
</ul>
<h3 id="use-cases">Use Cases</h3>
<ul>
<li>Caching: We can store temporary data that should expire after some
time.</li>
<li>Session management: We can automatically end user sessions after
they are inactive.</li>
<li>Rate limiting: We can limit how many requests a user can make in a
certain time.</li>
</ul>
<p>For more information, we can check out <a
href="https://bestonlinetutorial.com/redis/what-is-redis.html">what is
Redis</a> to learn about its main features.</p>
<h2 id="setting-up-jedis-for-redis-key-expire-notifications">Setting Up
Jedis for Redis Key Expire Notifications</h2>
<p>To use Redis key expire notifications with Jedis, we first need to
set up the Jedis client in our Java application. Jedis is a Java client
for Redis. It helps us easily connect to a Redis server and do
operations.</p>
<h3 id="step-1-add-jedis-dependency">Step 1: Add Jedis Dependency</h3>
<p>If we are using Maven, we should add this dependency to our
<code>pom.xml</code>:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode xml"><code class="sourceCode xml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">dependency</span>&gt;</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">groupId</span>&gt;redis.clients&lt;/<span class="kw">groupId</span>&gt;</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">artifactId</span>&gt;jedis&lt;/<span class="kw">artifactId</span>&gt;</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">version</span>&gt;4.3.1&lt;/<span class="kw">version</span>&gt;</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">dependency</span>&gt;</span></code></pre></div>
<p>For Gradle, we add this line to our <code>build.gradle</code>:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>implementation <span class="st">&#39;redis.clients:jedis:4.3.1&#39;</span></span></code></pre></div>
<h3 id="step-2-initialize-jedis-client">Step 2: Initialize Jedis
Client</h3>
<p>Next, we create an instance of the Jedis client to connect to our
Redis server:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">redis</span><span class="op">.</span><span class="im">clients</span><span class="op">.</span><span class="im">jedis</span><span class="op">.</span><span class="im">Jedis</span><span class="op">;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> JedisSetup <span class="op">{</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> Jedis jedis<span class="op">;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="fu">JedisSetup</span><span class="op">(</span><span class="bu">String</span> host<span class="op">,</span> <span class="dt">int</span> port<span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">jedis</span> <span class="op">=</span> <span class="kw">new</span> <span class="fu">Jedis</span><span class="op">(</span>host<span class="op">,</span> port<span class="op">);</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> Jedis <span class="fu">getJedis</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> jedis<span class="op">;</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">close</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>jedis <span class="op">!=</span> <span class="kw">null</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>            jedis<span class="op">.</span><span class="fu">close</span><span class="op">();</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="step-3-configure-jedis-for-notifications">Step 3: Configure
Jedis for Notifications</h3>
<p>To turn on key expiration notifications, we need to set the right
Redis configuration. In our Redis configuration file
(<code>redis.conf</code>), we make sure this line is there to enable
keyspace notifications:</p>
<pre class="plaintext"><code>notify-keyspace-events Ex</code></pre>
<p>This setting will turn on expiration notifications. We can also set
this configuration in our code using Jedis:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">void</span> <span class="fu">enableKeyspaceNotifications</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    jedis<span class="op">.</span><span class="fu">configSet</span><span class="op">(</span><span class="st">&quot;notify-keyspace-events&quot;</span><span class="op">,</span> <span class="st">&quot;Ex&quot;</span><span class="op">);</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="step-4-use-jedis-client">Step 4: Use Jedis Client</h3>
<p>Now that we have set up the Jedis client and turned on notifications,
we can do operations with it. Here is an example of how to set a key
with an expiration time:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">void</span> <span class="fu">setKeyWithExpiry</span><span class="op">(</span><span class="bu">String</span> key<span class="op">,</span> <span class="bu">String</span> value<span class="op">,</span> <span class="dt">int</span> seconds<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    jedis<span class="op">.</span><span class="fu">set</span><span class="op">(</span>key<span class="op">,</span> value<span class="op">);</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    jedis<span class="op">.</span><span class="fu">expire</span><span class="op">(</span>key<span class="op">,</span> seconds<span class="op">);</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="step-5-closing-the-connection">Step 5: Closing the
Connection</h3>
<p>We should always close the Jedis connection after we use it. This
helps to prevent resource leaks:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span><span class="op">(</span><span class="bu">String</span><span class="op">[]</span> args<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    JedisSetup jedisSetup <span class="op">=</span> <span class="kw">new</span> <span class="fu">JedisSetup</span><span class="op">(</span><span class="st">&quot;localhost&quot;</span><span class="op">,</span> <span class="dv">6379</span><span class="op">);</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    jedisSetup<span class="op">.</span><span class="fu">enableKeyspaceNotifications</span><span class="op">();</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    jedisSetup<span class="op">.</span><span class="fu">setKeyWithExpiry</span><span class="op">(</span><span class="st">&quot;testKey&quot;</span><span class="op">,</span> <span class="st">&quot;testValue&quot;</span><span class="op">,</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    jedisSetup<span class="op">.</span><span class="fu">close</span><span class="op">();</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>By following these steps, we can set up Jedis for Redis key expire
notifications. This will help our application to handle expiration
events well.</p>
<h2 id="configuring-redis-to-publish-expiration-events">Configuring
Redis to Publish Expiration Events</h2>
<p>To make Redis publish expiration events, we need to set up the
server. This will let clients know when keys expire. We do this with the
<code>notify-keyspace-events</code> setting. Here are the steps we
should follow:</p>
<ol type="1">
<li><p><strong>Edit the Redis Configuration File</strong>:<br />
We open the <code>redis.conf</code> file. This file usually is in
<code>/etc/redis/</code> or <code>/usr/local/etc/redis/</code>. We find
the <code>notify-keyspace-events</code> line and change it to the right
event types. For key expiration notifications, we use the
<code>Ex</code> option.</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">notify-keyspace-events</span> Ex</span></code></pre></div></li>
<li><p><strong>Using the Redis CLI</strong>:<br />
If we do not want to change the configuration file, we can set this
option directly using the Redis command line interface:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">CONFIG</span> SET notify-keyspace-events Ex</span></code></pre></div></li>
<li><p><strong>Restart Redis</strong>:<br />
If we changed the <code>redis.conf</code> file, we need to restart the
Redis service. This helps the changes take effect:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl restart redis</span></code></pre></div></li>
<li><p><strong>Verify Configuration</strong>:<br />
To check if we set it correctly, we can run this command in the Redis
CLI:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">CONFIG</span> GET notify-keyspace-events</span></code></pre></div>
<p>The output should show <code>Ex</code>. This means expiration events
are now enabled.</p></li>
</ol>
<p>By doing these steps, Redis will publish notifications on the
<code>__keyevent@&lt;db&gt;__:expired</code> channel when a key expires.
This lets our application listen to these events. For more information
on the Redis pub/sub system, we can look at <a
href="https://bestonlinetutorial.com/redis/what-is-redis-pub-sub.html">Redis
Pub/Sub</a>.</p>
<h2 id="subscribing-to-key-expire-notifications-with-jedis">Subscribing
to Key Expire Notifications with Jedis</h2>
<p>We can subscribe to Redis key expire notifications with Jedis. We
will use Redis’s Pub/Sub system. This helps us listen for events when
keys expire.</p>
<h3 id="step-by-step-implementation">Step-by-Step Implementation:</h3>
<ol type="1">
<li><p><strong>Set Up Jedis</strong>: First, we need to have Jedis in
our project. If we use Maven, we will add this to our
<code>pom.xml</code>:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode xml"><code class="sourceCode xml"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">dependency</span>&gt;</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">groupId</span>&gt;redis.clients&lt;/<span class="kw">groupId</span>&gt;</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">artifactId</span>&gt;jedis&lt;/<span class="kw">artifactId</span>&gt;</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">version</span>&gt;4.3.0&lt;/<span class="kw">version</span>&gt; <span class="co">&lt;!-- Check for the latest version --&gt;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">dependency</span>&gt;</span></code></pre></div></li>
<li><p><strong>Create a Subscriber Class</strong>: Next, we create a
subscriber that listens for expiration events.</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">redis</span><span class="op">.</span><span class="im">clients</span><span class="op">.</span><span class="im">jedis</span><span class="op">.</span><span class="im">JedisPubSub</span><span class="op">;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ExpirySubscriber <span class="kw">extends</span> JedisPubSub <span class="op">{</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">@Override</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">onMessage</span><span class="op">(</span><span class="bu">String</span> channel<span class="op">,</span> <span class="bu">String</span> message<span class="op">)</span> <span class="op">{</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Expired key: &quot;</span> <span class="op">+</span> message<span class="op">);</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><p><strong>Subscribe to Notifications</strong>: Then, we use Jedis
to subscribe to the channel <code>__keyevent@0__:expired</code>. Here,
<code>0</code> is the database index.</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">redis</span><span class="op">.</span><span class="im">clients</span><span class="op">.</span><span class="im">jedis</span><span class="op">.</span><span class="im">Jedis</span><span class="op">;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> RedisKeyExpireNotification <span class="op">{</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span><span class="op">(</span><span class="bu">String</span><span class="op">[]</span> args<span class="op">)</span> <span class="op">{</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>        Jedis jedis <span class="op">=</span> <span class="kw">new</span> <span class="fu">Jedis</span><span class="op">(</span><span class="st">&quot;localhost&quot;</span><span class="op">,</span> <span class="dv">6379</span><span class="op">);</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>        ExpirySubscriber subscriber <span class="op">=</span> <span class="kw">new</span> <span class="fu">ExpirySubscriber</span><span class="op">();</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Start a new thread for subscribing</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span> <span class="bu">Thread</span><span class="op">(()</span> <span class="op">-&gt;</span> <span class="op">{</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>            jedis<span class="op">.</span><span class="fu">subscribe</span><span class="op">(</span>subscriber<span class="op">,</span> <span class="st">&quot;__keyevent@0__:expired&quot;</span><span class="op">);</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}).</span><span class="fu">start</span><span class="op">();</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><p><strong>Configure Redis for Keyspace Notifications</strong>: We
must enable keyspace notifications in our Redis config file
(<code>redis.conf</code>). Or we can run this command in the Redis
CLI:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">CONFIG</span> SET notify-keyspace-events Ex</span></code></pre></div>
<p>We can also set this in our application code with Jedis:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>jedis<span class="op">.</span><span class="fu">configSet</span><span class="op">(</span><span class="st">&quot;notify-keyspace-events&quot;</span><span class="op">,</span> <span class="st">&quot;Ex&quot;</span><span class="op">);</span></span></code></pre></div></li>
</ol>
<h3 id="example-usage">Example Usage:</h3>
<ul>
<li><p>To see the key expiration notifications, we can set a key with an
expiration time:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>jedis<span class="op">.</span><span class="fu">setex</span><span class="op">(</span><span class="st">&quot;testKey&quot;</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="st">&quot;value&quot;</span><span class="op">);</span> <span class="co">// Key will expire in 5 seconds</span></span></code></pre></div></li>
<li><p>After 5 seconds, we will see this output:
<code>Expired key: testKey</code>.</p></li>
</ul>
<p>By following these steps, we can subscribe to Redis key expire
notifications with Jedis. This will help our application respond to
changes in the Redis data store. For more about Redis Pub/Sub, check <a
href="https://bestonlinetutorial.com/redis/what-is-redis-pub-sub.html">this
detailed article</a>.</p>
<h2 id="handling-expiration-events-in-your-application">Handling
Expiration Events in Your Application</h2>
<p>To handle Redis key expiration events in our application using Jedis,
we need to create a subscriber that listens for key expiration messages
from Redis. Here is how we can set it up:</p>
<ol type="1">
<li><strong>Create a Subscriber Class:</strong></li>
</ol>
<div class="sourceCode" id="cb21"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">redis</span><span class="op">.</span><span class="im">clients</span><span class="op">.</span><span class="im">jedis</span><span class="op">.</span><span class="im">JedisPubSub</span><span class="op">;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> KeyExpirySubscriber <span class="kw">extends</span> JedisPubSub <span class="op">{</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">@Override</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">onMessage</span><span class="op">(</span><span class="bu">String</span> channel<span class="op">,</span> <span class="bu">String</span> message<span class="op">)</span> <span class="op">{</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Key expired: &quot;</span> <span class="op">+</span> message<span class="op">);</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Handle the expiration event. For example, clean up resources or update cache.</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<ol start="2" type="1">
<li><strong>Set Up the Subscriber in Your Application:</strong></li>
</ol>
<div class="sourceCode" id="cb22"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">redis</span><span class="op">.</span><span class="im">clients</span><span class="op">.</span><span class="im">jedis</span><span class="op">.</span><span class="im">Jedis</span><span class="op">;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ExpirationEventHandler <span class="op">{</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span><span class="op">(</span><span class="bu">String</span><span class="op">[]</span> args<span class="op">)</span> <span class="op">{</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        Jedis jedis <span class="op">=</span> <span class="kw">new</span> <span class="fu">Jedis</span><span class="op">(</span><span class="st">&quot;localhost&quot;</span><span class="op">);</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Start a new thread to subscribe to key expiration events</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span> <span class="bu">Thread</span><span class="op">(()</span> <span class="op">-&gt;</span> <span class="op">{</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>            jedis<span class="op">.</span><span class="fu">subscribe</span><span class="op">(</span><span class="kw">new</span> <span class="fu">KeyExpirySubscriber</span><span class="op">(),</span> <span class="st">&quot;__keyevent@0__:expired&quot;</span><span class="op">);</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}).</span><span class="fu">start</span><span class="op">();</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">// For demo, set a key with expiration time</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        jedis<span class="op">.</span><span class="fu">set</span><span class="op">(</span><span class="st">&quot;testKey&quot;</span><span class="op">,</span> <span class="st">&quot;testValue&quot;</span><span class="op">);</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        jedis<span class="op">.</span><span class="fu">expire</span><span class="op">(</span><span class="st">&quot;testKey&quot;</span><span class="op">,</span> <span class="dv">10</span><span class="op">);</span> <span class="co">// Set expiration time to 10 seconds</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<ol start="3" type="1">
<li><p><strong>Understanding the Channel:</strong></p>
<ul>
<li>The channel for key expiration messages is in the format
<code>__keyevent@&lt;db&gt;__:expired</code>. We need to replace
<code>&lt;db&gt;</code> with the correct database number. For example,
use <code>0</code> for the default database.</li>
<li>We can listen to other event types too, like <code>set</code> or
<code>del</code>, by changing the channel name.</li>
</ul></li>
<li><p><strong>Configure Redis for Expiration
Notifications:</strong></p></li>
</ol>
<p>We must make sure that Redis can publish keyspace notifications. We
can do this in the Redis configuration file (<code>redis.conf</code>) or
while Redis is running:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">CONFIG</span> SET notify-keyspace-events Ex</span></code></pre></div>
<p>This command lets Redis send notifications for expired keys.
<code>E</code> means expired events.</p>
<ol start="5" type="1">
<li><strong>Handling Expiration Logic:</strong></li>
</ol>
<p>In the <code>onMessage</code> method of our subscriber class, we can
add the logic for what to do when a key expires. For example:</p>
<ul>
<li>Clean up related resources.</li>
<li>Update application state.</li>
<li>Notify other parts of our application.</li>
</ul>
<p>This way, our application can react to changes in Redis data. We use
Jedis to manage key expiration notifications well.</p>
<p>For more info on Redis key expiration and notifications, see <a
href="https://bestonlinetutorial.com/redis/what-is-redis-pub-sub.html">Redis
Pub/Sub</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3 id="what-are-redis-key-expire-notifications">1. What are Redis key
expire notifications?</h3>
<p>We can say that Redis key expire notifications let developers know
when keys in Redis expire. This is useful for apps that need to manage
data well and clean up old info. By using Redis key expire notifications
with Jedis, we can subscribe to these events. This helps our app to
react, like cleaning up resources or updating caches when keys
expire.</p>
<h3 id="how-do-i-configure-redis-to-publish-expiration-events">2. How do
I configure Redis to publish expiration events?</h3>
<p>To set up Redis to send expiration events, we must change the
<code>notify-keyspace-events</code> setting in the Redis config file or
use the command line. For example, we can run
<code>CONFIG SET notify-keyspace-events Ex</code> to enable expiration
notifications. This works well with Jedis. It helps us manage key
expiration notifications in our Java apps easily.</p>
<h3 id="can-i-use-jedis-to-subscribe-to-redis-key-expiration-events">3.
Can I use Jedis to subscribe to Redis key expiration events?</h3>
<p>Yes, we can use Jedis to listen for Redis key expiration events. We
can make a subscriber with Jedis to catch events on the
<code>__keyevent@&lt;db&gt;__:expired</code> channel. This way, our app
can react right away when certain keys expire. It helps us manage
temporary data and resources better.</p>
<h3 id="what-is-the-benefit-of-using-key-expiration-in-redis">4. What is
the benefit of using key expiration in Redis?</h3>
<p>Using key expiration in Redis helps us save memory by removing keys
that we do not need anymore. This is very helpful in caching, where old
data can take up important memory space. By using Redis key expire
notifications with Jedis, we can make sure our app responds to these
expirations. This keeps our data correct and our app running well.</p>
<h3 id="how-can-i-handle-expiration-events-in-my-application">5. How can
I handle expiration events in my application?</h3>
<p>To manage expiration events in our app, we should subscribe to the
right Redis channels using Jedis. After we subscribe, we need to add
logic in our message handler to deal with the expiration events when
they come. This might mean cleaning up related resources, removing old
caches, or updating parts of our app. This way, we can give users a
smooth experience when keys expire.</p>
<p>For more info on Redis and what it can do, we can check these useful
articles: <a
href="https://bestonlinetutorial.com/redis/what-is-redis.html">What is
Redis?</a> and <a
href="https://bestonlinetutorial.com/redis/what-are-redis-data-types.html">What
are Redis Data Types?</a>.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            