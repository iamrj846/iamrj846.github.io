
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
            <!-- Google tag (gtag.js) -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
            <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-TFCQEJR7TD');
            </script>
            
            <title>[Dynamic Programming] Longest Common Subsequence of Three Strings - Hard</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Common CSS & Icons -->
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
<link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
<link rel="stylesheet" href="/assets/css/post.css">
            <meta name="description" content="Discover the challenging dynamic programming solution for finding the longest common subsequence of three strings. Dive in!">
            <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	        <script src="/assets/js/blog.js"></script>
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">[Dynamic Programming] Longest Common Subsequence of Three Strings - Hard</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>The longest common subsequence (LCS) problem for three strings is a
well-known problem in computer science. It is especially important in
dynamic programming. This problem asks us to find the longest sequence
that appears in the same order in all three strings. The sequence does
not need to be next to itself.</p>
<p>To solve this problem, we use dynamic programming. We create a
three-dimensional table. This table keeps track of the lengths of the
longest common subsequences for each pair of positions in the three
strings. This method helps us find the best solution.</p>
<p>In this article, we will explore the LCS problem in detail. We will
look at the problem statement and the dynamic programming method to find
the longest common subsequence of three strings. We will share code
examples in Java, Python, and C++. We will also discuss ways to reduce
space use.</p>
<p>We will point out common mistakes when we implement the algorithm. We
will also compare different methods for solving the LCS problem. Lastly,
we will answer frequently asked questions to help clear up any
confusion.</p>
<ul>
<li>Dynamically Finding Longest Common Subsequence of Three Strings -
Hard</li>
<li>Understanding the Problem Statement of Longest Common
Subsequence</li>
<li>Dynamic Programming Approach to Longest Common Subsequence of Three
Strings</li>
<li>Java Implementation of Longest Common Subsequence of Three
Strings</li>
<li>Python Implementation of Longest Common Subsequence of Three
Strings</li>
<li>C++ Implementation of Longest Common Subsequence of Three
Strings</li>
<li>Optimizing Space Complexity for Longest Common Subsequence</li>
<li>Common Pitfalls in Implementing Longest Common Subsequence</li>
<li>Comparative Analysis of Different Approaches to Longest Common
Subsequence</li>
<li>Frequently Asked Questions</li>
</ul>
<h2
id="understanding-the-problem-statement-of-longest-common-subsequence">Understanding
the Problem Statement of Longest Common Subsequence</h2>
<p>The Longest Common Subsequence (LCS) problem is about finding the
longest subsequence that is common in three input strings. Substrings
are different from subsequences. We can get subsequences by removing
some characters from the original string. We do not change the order of
the remaining characters.</p>
<h3 id="problem-definition">Problem Definition</h3>
<p>We have three strings, <code>X</code>, <code>Y</code>, and
<code>Z</code>. Our job is to find the length of the longest subsequence
that is in all three strings. The subsequence does not have to be next
to each other.</p>
<h3 id="example">Example</h3>
<p>Letâ€™s look at these three strings: - <code>X = "AGGTAB"</code> -
<code>Y = "GXTXAYB"</code> - <code>Z = "AGXGTAB"</code></p>
<p>The longest common subsequence here is <code>"GTAB"</code>, and it
has a length of 4.</p>
<h3 id="inputoutput-format">Input/Output Format</h3>
<ul>
<li><strong>Input</strong>: Three strings <code>X</code>,
<code>Y</code>, <code>Z</code>.</li>
<li><strong>Output</strong>: A number that shows the length of the
longest common subsequence.</li>
</ul>
<h3 id="constraints">Constraints</h3>
<ul>
<li>Each string can be up to 100 characters long.</li>
<li>Strings can have both uppercase and lowercase letters.</li>
</ul>
<p>This problem is a good example of dynamic programming. We can build
our solution step by step. We use results we already calculated to find
the final answer more easily.</p>
<p>When we understand this problem, we can create a smart dynamic
programming solution to find the longest common subsequence of three
strings.</p>
<h2
id="dynamic-programming-approach-to-longest-common-subsequence-of-three-strings">Dynamic
Programming Approach to Longest Common Subsequence of Three Strings</h2>
<p>The Longest Common Subsequence (LCS) problem can also work with three
strings. Our goal is to find the longest subsequence that is present in
all three strings. A subsequence means a sequence that appears in the
same order but does not need to be next to each other.</p>
<h3 id="problem-definition-1">Problem Definition</h3>
<p>We have three strings: <code>X</code>, <code>Y</code>, and
<code>Z</code>. Our task is to find the length of the longest
subsequence that is common to all three.</p>
<h3 id="dynamic-programming-solution">Dynamic Programming Solution</h3>
<p>To solve this problem, we will use a 3D array <code>dp</code>. Here,
<code>dp[i][j][k]</code> shows the length of the longest common
subsequence of substrings <code>X[0...i-1]</code>,
<code>Y[0...j-1]</code>, and <code>Z[0...k-1]</code>.</p>
<h4 id="recurrence-relation">Recurrence Relation</h4>
<p>The rule for finding the longest common subsequence is like this:</p>
<ul>
<li><p>If <code>X[i-1]</code>, <code>Y[j-1]</code>, and
<code>Z[k-1]</code> are the same: [ dp[i][j][k] = dp[i-1][j-1][k-1] + 1
]</p></li>
<li><p>If they are not the same: [ dp[i][j][k] = (dp[i-1][j][k],
dp[i][j-1][k], dp[i][j][k-1]) ]</p></li>
</ul>
<h4 id="base-case">Base Case</h4>
<p>For the base case, we set <code>dp[i][0][0]</code>,
<code>dp[0][j][0]</code>, and <code>dp[0][0][k]</code> to <code>0</code>
for all <code>i</code>, <code>j</code>, and <code>k</code>.</p>
<h3 id="time-and-space-complexity">Time and Space Complexity</h3>
<p>The time it takes for this method is (O(n m p)). Here, (n), (m), and
(p) are the lengths of strings <code>X</code>, <code>Y</code>, and
<code>Z</code>. The space needed is also (O(n m p)).</p>
<h3 id="implementation">Implementation</h3>
<p>Now we show how to write the LCS of three strings in Java, Python,
and C++.</p>
<h4 id="java-implementation">Java Implementation</h4>
<div class="sourceCode" id="cb1"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> LCS3 <span class="op">{</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">int</span> <span class="fu">longestCommonSubsequence</span><span class="op">(</span><span class="bu">String</span> X<span class="op">,</span> <span class="bu">String</span> Y<span class="op">,</span> <span class="bu">String</span> Z<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> n <span class="op">=</span> X<span class="op">.</span><span class="fu">length</span><span class="op">(),</span> m <span class="op">=</span> Y<span class="op">.</span><span class="fu">length</span><span class="op">(),</span> p <span class="op">=</span> Z<span class="op">.</span><span class="fu">length</span><span class="op">();</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span><span class="op">[][][]</span> dp <span class="op">=</span> <span class="kw">new</span> <span class="dt">int</span><span class="op">[</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">][</span>m <span class="op">+</span> <span class="dv">1</span><span class="op">][</span>p <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> m<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> k <span class="op">&lt;=</span> p<span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="op">(</span>X<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">==</span> Y<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">&amp;&amp;</span> Y<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">==</span> Z<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                        dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                        dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span>dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j<span class="op">][</span>k<span class="op">],</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span>dp<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k<span class="op">],</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">]));</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                    <span class="op">}</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> dp<span class="op">[</span>n<span class="op">][</span>m<span class="op">][</span>p<span class="op">];</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h4 id="python-implementation">Python Implementation</h4>
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> longest_common_subsequence(X, Y, Z):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    n, m, p <span class="op">=</span> <span class="bu">len</span>(X), <span class="bu">len</span>(Y), <span class="bu">len</span>(Z)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    dp <span class="op">=</span> [[[<span class="dv">0</span>] <span class="op">*</span> (p <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(m <span class="op">+</span> <span class="dv">1</span>)] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, m <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, p <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> X[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">==</span> Y[j <span class="op">-</span> <span class="dv">1</span>] <span class="op">==</span> Z[k <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                    dp[i][j][k] <span class="op">=</span> dp[i <span class="op">-</span> <span class="dv">1</span>][j <span class="op">-</span> <span class="dv">1</span>][k <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                    dp[i][j][k] <span class="op">=</span> <span class="bu">max</span>(dp[i <span class="op">-</span> <span class="dv">1</span>][j][k], dp[i][j <span class="op">-</span> <span class="dv">1</span>][k], dp[i][j][k <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp[n][m][p]</span></code></pre></div>
<h4 id="c-implementation">C++ Implementation</h4>
<div class="sourceCode" id="cb3"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;string&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> longestCommonSubsequence<span class="op">(</span>string X<span class="op">,</span> string Y<span class="op">,</span> string Z<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> X<span class="op">.</span>size<span class="op">(),</span> m <span class="op">=</span> Y<span class="op">.</span>size<span class="op">(),</span> p <span class="op">=</span> Z<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span>vector<span class="op">&lt;</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;&gt;</span> dp<span class="op">(</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> vector<span class="op">&lt;</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;(</span>m <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span>p <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">)));</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> m<span class="op">;</span> <span class="op">++</span>j<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> k <span class="op">&lt;=</span> p<span class="op">;</span> <span class="op">++</span>k<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>X<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">==</span> Y<span class="op">[</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">&amp;&amp;</span> Y<span class="op">[</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">==</span> Z<span class="op">[</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                    dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                    dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j<span class="op">][</span>k<span class="op">],</span> max<span class="op">(</span>dp<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k<span class="op">],</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">]));</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span>n<span class="op">][</span>m<span class="op">][</span>p<span class="op">];</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>This dynamic programming way helps us find the length of the longest
common subsequence for three strings. It gives us a strong solution to
this problem. For more about dynamic programming, we can read <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-longest-common-subsequence-medium.html">Dynamic
Programming - Longest Common Subsequence</a>.</p>
<h2
id="java-implementation-of-longest-common-subsequence-of-three-strings">Java
Implementation of Longest Common Subsequence of Three Strings</h2>
<p>We will show how to find the Longest Common Subsequence (LCS) of
three strings using Java. We use dynamic programming for this. We create
a 3D array to keep the lengths of the longest common subsequences for
parts of the three input strings.</p>
<h3 id="steps">Steps:</h3>
<ol type="1">
<li>First, we find the lengths of the three strings.</li>
<li>Then, we create a 3D array called <code>dp</code>. Here,
<code>dp[i][j][k]</code> holds the length of the LCS of parts
<code>str1[0...i-1]</code>, <code>str2[0...j-1]</code>, and
<code>str3[0...k-1]</code>.</li>
<li>Next, we use loops to fill the <code>dp</code> array based on some
rules:
<ul>
<li><p>If the characters match
(<code>str1[i-1] == str2[j-1] == str3[k-1]</code>), we do:</p>
<pre><code>dp[i][j][k] = dp[i-1][j-1][k-1] + 1;</code></pre></li>
<li><p>If they do not match, we take the biggest value from the
options:</p>
<pre><code>dp[i][j][k] = max(dp[i-1][j][k], dp[i][j-1][k], dp[i][j][k-1]);</code></pre></li>
</ul></li>
</ol>
<h3 id="java-code">Java Code:</h3>
<div class="sourceCode" id="cb6"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> LongestCommonSubsequenceThreeStrings <span class="op">{</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">int</span> <span class="fu">lcsOfThree</span><span class="op">(</span><span class="bu">String</span> str1<span class="op">,</span> <span class="bu">String</span> str2<span class="op">,</span> <span class="bu">String</span> str3<span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> l1 <span class="op">=</span> str1<span class="op">.</span><span class="fu">length</span><span class="op">();</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> l2 <span class="op">=</span> str2<span class="op">.</span><span class="fu">length</span><span class="op">();</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> l3 <span class="op">=</span> str3<span class="op">.</span><span class="fu">length</span><span class="op">();</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span><span class="op">[][][]</span> dp <span class="op">=</span> <span class="kw">new</span> <span class="dt">int</span><span class="op">[</span>l1 <span class="op">+</span> <span class="dv">1</span><span class="op">][</span>l2 <span class="op">+</span> <span class="dv">1</span><span class="op">][</span>l3 <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> l1<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> l2<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> k <span class="op">&lt;=</span> l3<span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="op">(</span>str1<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">==</span> str2<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">&amp;&amp;</span> str1<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">==</span> str3<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>                        dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>                        dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span>dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j<span class="op">][</span>k<span class="op">],</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span>dp<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k<span class="op">],</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">]));</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>                    <span class="op">}</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> dp<span class="op">[</span>l1<span class="op">][</span>l2<span class="op">][</span>l3<span class="op">];</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span><span class="op">(</span><span class="bu">String</span><span class="op">[]</span> args<span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">String</span> str1 <span class="op">=</span> <span class="st">&quot;abc&quot;</span><span class="op">;</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">String</span> str2 <span class="op">=</span> <span class="st">&quot;ac&quot;</span><span class="op">;</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">String</span> str3 <span class="op">=</span> <span class="st">&quot;abc&quot;</span><span class="op">;</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Length of LCS is &quot;</span> <span class="op">+</span> <span class="fu">lcsOfThree</span><span class="op">(</span>str1<span class="op">,</span> str2<span class="op">,</span> str3<span class="op">));</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="explanation-of-the-code">Explanation of the Code:</h3>
<p>We start with the <code>lcsOfThree</code> method. It makes a 3D array
called <code>dp</code> to store the lengths of the common
subsequences.</p>
<p>The nested loops go through the lengths of the input strings. They
fill the <code>dp</code> array based on the matching rules we talked
about.</p>
<p>At the end, the method gives back the value at
<code>dp[l1][l2][l3]</code>. This value shows the length of the longest
common subsequence of the three strings.</p>
<p>This way, we compute the LCS of three strings. This method works well
with a time complexity of O(n * m * p). Here, n, m, and p are the
lengths of the three strings.</p>
<h2
id="python-implementation-of-longest-common-subsequence-of-three-strings">Python
Implementation of Longest Common Subsequence of Three Strings</h2>
<p>We can implement the Longest Common Subsequence (LCS) of three
strings using dynamic programming in Python. We will use a 3D list to
keep track of the lengths of the longest common subsequence for each
index of the three strings.</p>
<p>Here is a simple implementation:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> longest_common_subsequence(str1, str2, str3):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    len1, len2, len3 <span class="op">=</span> <span class="bu">len</span>(str1), <span class="bu">len</span>(str2), <span class="bu">len</span>(str3)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a 3D DP array initialized to 0</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    dp <span class="op">=</span> [[[<span class="dv">0</span>] <span class="op">*</span> (len3 <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(len2 <span class="op">+</span> <span class="dv">1</span>)] <span class="cf">for</span> __ <span class="kw">in</span> <span class="bu">range</span>(len1 <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, len1 <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, len2 <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, len3 <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> str1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">==</span> str2[j <span class="op">-</span> <span class="dv">1</span>] <span class="op">==</span> str3[k <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                    dp[i][j][k] <span class="op">=</span> dp[i <span class="op">-</span> <span class="dv">1</span>][j <span class="op">-</span> <span class="dv">1</span>][k <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                    dp[i][j][k] <span class="op">=</span> <span class="bu">max</span>(dp[i <span class="op">-</span> <span class="dv">1</span>][j][k], </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                                      dp[i][j <span class="op">-</span> <span class="dv">1</span>][k], </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                                      dp[i][j][k <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp[len1][len2][len3]</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>str1 <span class="op">=</span> <span class="st">&quot;abcde&quot;</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>str2 <span class="op">=</span> <span class="st">&quot;ace&quot;</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>str3 <span class="op">=</span> <span class="st">&quot;abc&quot;</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Length of LCS is:&quot;</span>, longest_common_subsequence(str1, str2, str3))</span></code></pre></div>
<h3 id="explanation">Explanation:</h3>
<ul>
<li><strong>3D DP Array:</strong> We use <code>dp[i][j][k]</code> to
show the length of the LCS for the first <code>i</code> characters of
<code>str1</code>, the first <code>j</code> characters of
<code>str2</code>, and the first <code>k</code> characters of
<code>str3</code>.</li>
<li><strong>Base Case:</strong> If any string is empty (when
<code>i</code>, <code>j</code>, or <code>k</code> is 0), the LCS length
is 0.</li>
<li><strong>Recurrence Relation:</strong>
<ul>
<li>If the current characters from all three strings are the same, we
add 1 to the count from the previous indices.</li>
<li>If not, we find the maximum value from the previous states by
leaving out one of the strings.</li>
</ul></li>
</ul>
<p>This implementation can find the length of the longest common
subsequence of three strings using dynamic programming. For more details
on advanced dynamic programming methods, you can check <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-longest-common-subsequence-medium.html">this
related article</a>.</p>
<h2
id="c-implementation-of-longest-common-subsequence-of-three-strings">C++
Implementation of Longest Common Subsequence of Three Strings</h2>
<p>To find the longest common subsequence (LCS) of three strings in C++,
we use a dynamic programming method. We create a 3D table called
<code>dp</code>. Here, <code>dp[i][j][k]</code> shows the length of the
LCS of the substrings <code>str1[0:i-1]</code>,
<code>str2[0:j-1]</code>, and <code>str3[0:k-1]</code>.</p>
<h3 id="c-code-implementation">C++ Code Implementation</h3>
<div class="sourceCode" id="cb8"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;string&gt;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> longestCommonSubsequence<span class="op">(</span>string str1<span class="op">,</span> string str2<span class="op">,</span> string str3<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> len1 <span class="op">=</span> str1<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> len2 <span class="op">=</span> str2<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> len3 <span class="op">=</span> str3<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span>vector<span class="op">&lt;</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;&gt;</span> dp<span class="op">(</span>len1 <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> vector<span class="op">&lt;</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;(</span>len2 <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span>len3 <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">)));</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> len1<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> len2<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> k <span class="op">&lt;=</span> len3<span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>str1<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">==</span> str2<span class="op">[</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">&amp;&amp;</span> str2<span class="op">[</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">==</span> str3<span class="op">[</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>                    dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                    dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> max<span class="op">({</span>dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j<span class="op">][</span>k<span class="op">],</span> dp<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k<span class="op">],</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">]});</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span>len1<span class="op">][</span>len2<span class="op">][</span>len3<span class="op">];</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    string str1 <span class="op">=</span> <span class="st">&quot;abcde&quot;</span><span class="op">;</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    string str2 <span class="op">=</span> <span class="st">&quot;ace&quot;</span><span class="op">;</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    string str3 <span class="op">=</span> <span class="st">&quot;bce&quot;</span><span class="op">;</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> result <span class="op">=</span> longestCommonSubsequence<span class="op">(</span>str1<span class="op">,</span> str2<span class="op">,</span> str3<span class="op">);</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;Length of Longest Common Subsequence: &quot;</span> <span class="op">&lt;&lt;</span> result <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="explanation-of-the-code-1">Explanation of the Code</h3>
<p>We start by making a 3D vector called <code>dp</code>. It has size
<code>(len1 + 1) x (len2 + 1) x (len3 + 1)</code>. This will hold our
results.</p>
<p>Then we loop through each character of the three strings. If the
characters at the current position are the same, we add one to the LCS
length from the previous positions. If they are not the same, we choose
the biggest value from the three cases where we leave out one string at
a time.</p>
<p>At the end, the value in <code>dp[len1][len2][len3]</code> gives us
the length of the longest common subsequence.</p>
<h3 id="complexity">Complexity</h3>
<ul>
<li><strong>Time Complexity:</strong> O(n * m * p). Here, n, m, and p
are the lengths of the three strings.</li>
<li><strong>Space Complexity:</strong> O(n * m * p) for the DP
table.</li>
</ul>
<p>This C++ code shows how to find the longest common subsequence of
three strings using dynamic programming. For more details about dynamic
programming, you can check articles like <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-fibonacci-number-easy.html">Dynamic
Programming Fibonacci Number</a> or <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-edit-distance-hard.html">Dynamic
Programming Edit Distance</a>.</p>
<h2
id="optimizing-space-complexity-for-longest-common-subsequence">Optimizing
Space Complexity for Longest Common Subsequence</h2>
<p>When we implement the Longest Common Subsequence (LCS) algorithm for
three strings, space complexity can be a big issue. This is true,
especially when input sizes are large. The simple dynamic programming
method uses a 3D array to store results for each substring combination.
This can use a lot of memory. To make space usage better, we can
remember that we only need to keep track of the current and previous
rows in our DP table.</p>
<h3 id="space-optimization-technique">Space Optimization Technique</h3>
<ol type="1">
<li><p><strong>Reduced DP Table</strong>: Instead of keeping a full 3D
array, we can use two 2D arrays or even better, one 2D array and one 1D
array to store the results. This really helps to lower memory
use.</p></li>
<li><p><strong>Iterative Calculation</strong>: By going through the
strings and updating our tables as we go, we can make our algorithm
better while still getting the right results.</p></li>
</ol>
<h3 id="implementation-example">Implementation Example</h3>
<p>Here is how we can write the optimized LCS algorithm for three
strings in Python:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lcs_three_strings(s1, s2, s3):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    l1, l2, l3 <span class="op">=</span> <span class="bu">len</span>(s1), <span class="bu">len</span>(s2), <span class="bu">len</span>(s3)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    dp <span class="op">=</span> [[[<span class="dv">0</span>] <span class="op">*</span> (l3 <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(l2 <span class="op">+</span> <span class="dv">1</span>)] <span class="cf">for</span> __ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>)]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, l1 <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, l2 <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, l3 <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> s1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">==</span> s2[j <span class="op">-</span> <span class="dv">1</span>] <span class="op">==</span> s3[k <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                    dp[i <span class="op">%</span> <span class="dv">2</span>][j][k] <span class="op">=</span> dp[(i <span class="op">-</span> <span class="dv">1</span>) <span class="op">%</span> <span class="dv">2</span>][j <span class="op">-</span> <span class="dv">1</span>][k <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                    dp[i <span class="op">%</span> <span class="dv">2</span>][j][k] <span class="op">=</span> <span class="bu">max</span>(dp[(i <span class="op">-</span> <span class="dv">1</span>) <span class="op">%</span> <span class="dv">2</span>][j][k], </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                                          dp[i <span class="op">%</span> <span class="dv">2</span>][j <span class="op">-</span> <span class="dv">1</span>][k], </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>                                          dp[i <span class="op">%</span> <span class="dv">2</span>][j][k <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp[l1 <span class="op">%</span> <span class="dv">2</span>][l2][l3]</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>s1 <span class="op">=</span> <span class="st">&quot;abcde&quot;</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>s2 <span class="op">=</span> <span class="st">&quot;ace&quot;</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>s3 <span class="op">=</span> <span class="st">&quot;abc&quot;</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lcs_three_strings(s1, s2, s3))  <span class="co"># Output: 2</span></span></code></pre></div>
<h3 id="key-points">Key Points</h3>
<ul>
<li><strong>Memory Efficiency</strong>: We reduce space complexity from
O(n * m * p) to O(min(n, m, p) * m * p) by only keeping the rows we
need.</li>
<li><strong>Time Complexity</strong>: The time complexity stays O(n * m
* p). Here, n, m, and p are the lengths of the three strings.</li>
<li><strong>Practical Usage</strong>: This way is very helpful in
competitive programming and cases where memory use is very
important.</li>
</ul>
<p>For more reading on similar dynamic programming methods, we can check
out <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-edit-distance-hard.html">Dynamic
Programming: Edit Distance</a> and <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-longest-common-subsequence-medium.html">Dynamic
Programming: Longest Common Subsequence</a>.</p>
<h2
id="common-pitfalls-in-implementing-longest-common-subsequence">Common
Pitfalls in Implementing Longest Common Subsequence</h2>
<p>When we implement the Longest Common Subsequence (LCS) algorithm for
three strings, we can face some common mistakes. These mistakes can
cause wrong results or slow performance. Here are some important things
to be careful about:</p>
<ol type="1">
<li><strong>Incorrect Base Case Handling</strong>:
<ul>
<li>We need to handle the base cases correctly. For example, if one of
the strings is empty, the length of the LCS should be zero.</li>
</ul>
<div class="sourceCode" id="cb10"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>i <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> j <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> k <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span> <span class="co">// LCS length is 0</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><strong>State Definition Errors</strong>:
<ul>
<li>We must define the states in our dynamic programming table properly.
For three strings <code>X</code>, <code>Y</code>, and <code>Z</code>, we
should use <code>dp[i][j][k]</code>. This shows the LCS length for the
first <code>i</code> characters of <code>X</code>, <code>j</code>
characters of <code>Y</code>, and <code>k</code> characters of
<code>Z</code>.</li>
</ul></li>
<li><strong>Overlooking Character Comparison</strong>:
<ul>
<li>We should compare characters correctly. Itâ€™s easy to forget to
compare the characters at indices <code>i-1</code>, <code>j-1</code>,
and <code>k-1</code> right.</li>
</ul>
<div class="sourceCode" id="cb11"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>X<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">==</span> Y<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">&amp;&amp;</span> Y<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">==</span> Z<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span>dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j<span class="op">][</span>k<span class="op">],</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span>dp<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k<span class="op">],</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">]));</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><strong>Memory Management Issues</strong>:
<ul>
<li>When we work with big strings, memory use can grow a lot. We should
be careful about how much space our solution uses. We can use better
methods to save memory, like keeping only the last two rows of the DP
table if the strings are not changed.</li>
</ul></li>
<li><strong>Not Accounting for All Characters</strong>:
<ul>
<li>We need to check that we consider all characters from all strings in
our comparison. It is easy to miss some characters or think we know what
the strings contain.</li>
</ul></li>
<li><strong>Edge Case Oversights</strong>:
<ul>
<li>We should pay attention to edge cases. This includes strings with
special characters, numbers, or spaces. We must make sure our code
handles these cases well.</li>
</ul></li>
<li><strong>Inefficient Backtracking</strong>:
<ul>
<li>When we rebuild the LCS, we should make the backtracking process
fast. We should avoid unnecessary checks that can slow down our
code.</li>
</ul></li>
<li><strong>Testing with Diverse Inputs</strong>:
<ul>
<li>We should test our code with different inputs. This includes small,
large, and edge cases. This helps make sure our code works well. If we
do not test enough, we can have hidden bugs that show up only in certain
cases.</li>
</ul></li>
</ol>
<p>By knowing these common mistakes in implementing the Longest Common
Subsequence algorithm for three strings, we can improve the accuracy and
speed of our solution. If we want to read more about dynamic
programming, we can check out <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-longest-common-subsequence-medium.html">Dynamic
Programming: Longest Common Subsequence</a>.</p>
<h2
id="comparative-analysis-of-different-approaches-to-longest-common-subsequence">Comparative
Analysis of Different Approaches to Longest Common Subsequence</h2>
<p>The Longest Common Subsequence (LCS) problem has different ways to
solve it. Each way has its own features for time complexity, space
complexity, and how easy it is to use. Here, we look at three main
methods: Recursive, Dynamic Programming (DP), and Optimized Space
Dynamic Programming.</p>
<h3 id="recursive-approach">1. Recursive Approach</h3>
<ul>
<li><strong>Time Complexity</strong>: O(2^n) where n is the length of
the shortest string.</li>
<li><strong>Space Complexity</strong>: O(n) because of the call
stack.</li>
<li><strong>Description</strong>: We define the problem using recursion.
If the last characters of the three strings match, we find the LCS of
the remaining parts. If they do not match, we find the maximum LCS by
skipping one string at a time.</li>
</ul>
<div class="sourceCode" id="cb12"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">int</span> <span class="fu">LCSRecursive</span><span class="op">(</span><span class="bu">String</span> a<span class="op">,</span> <span class="bu">String</span> b<span class="op">,</span> <span class="bu">String</span> c<span class="op">,</span> <span class="dt">int</span> i<span class="op">,</span> <span class="dt">int</span> j<span class="op">,</span> <span class="dt">int</span> k<span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>i <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> j <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> k <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>a<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">==</span> b<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">&amp;&amp;</span> b<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">==</span> c<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span> <span class="op">+</span> <span class="fu">LCSRecursive</span><span class="op">(</span>a<span class="op">,</span> b<span class="op">,</span> c<span class="op">,</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> j <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> k <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span><span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span><span class="fu">LCSRecursive</span><span class="op">(</span>a<span class="op">,</span> b<span class="op">,</span> c<span class="op">,</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> j<span class="op">,</span> k<span class="op">),</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">LCSRecursive</span><span class="op">(</span>a<span class="op">,</span> b<span class="op">,</span> c<span class="op">,</span> i<span class="op">,</span> j <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> k<span class="op">)),</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">LCSRecursive</span><span class="op">(</span>a<span class="op">,</span> b<span class="op">,</span> c<span class="op">,</span> i<span class="op">,</span> j<span class="op">,</span> k <span class="op">-</span> <span class="dv">1</span><span class="op">));</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="dynamic-programming-approach">2. Dynamic Programming
Approach</h3>
<ul>
<li><strong>Time Complexity</strong>: O(n * m * p), where n, m, and p
are the lengths of the three strings.</li>
<li><strong>Space Complexity</strong>: O(n * m * p) for the DP
table.</li>
<li><strong>Description</strong>: We use a 3D array to save the length
of LCS for smaller problems. We build the solution step by step,
checking for matching characters and updating the table.</li>
</ul>
<div class="sourceCode" id="cb13"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">int</span> <span class="fu">LCSDynamicProgramming</span><span class="op">(</span><span class="bu">String</span> a<span class="op">,</span> <span class="bu">String</span> b<span class="op">,</span> <span class="bu">String</span> c<span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> a<span class="op">.</span><span class="fu">length</span><span class="op">(),</span> m <span class="op">=</span> b<span class="op">.</span><span class="fu">length</span><span class="op">(),</span> p <span class="op">=</span> c<span class="op">.</span><span class="fu">length</span><span class="op">();</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span><span class="op">[][][]</span> dp <span class="op">=</span> <span class="kw">new</span> <span class="dt">int</span><span class="op">[</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">][</span>m <span class="op">+</span> <span class="dv">1</span><span class="op">][</span>p <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> m<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> k <span class="op">&lt;=</span> p<span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>a<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">==</span> b<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">&amp;&amp;</span> b<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">==</span> c<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                    dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                    dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span><span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span>dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j<span class="op">][</span>k<span class="op">],</span> dp<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k<span class="op">]),</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">]);</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span>n<span class="op">][</span>m<span class="op">][</span>p<span class="op">];</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="optimized-space-dynamic-programming-approach">3. Optimized Space
Dynamic Programming Approach</h3>
<ul>
<li><strong>Time Complexity</strong>: O(n * m * p).</li>
<li><strong>Space Complexity</strong>: O(m * p) using two 2D arrays for
current and previous results.</li>
<li><strong>Description</strong>: We use two 2D arrays instead of a 3D
array. This way, we keep track of the last row we computed. This helps
us save space a lot.</li>
</ul>
<div class="sourceCode" id="cb14"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">int</span> <span class="fu">LCSOptimized</span><span class="op">(</span><span class="bu">String</span> a<span class="op">,</span> <span class="bu">String</span> b<span class="op">,</span> <span class="bu">String</span> c<span class="op">)</span> <span class="op">{</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> a<span class="op">.</span><span class="fu">length</span><span class="op">(),</span> m <span class="op">=</span> b<span class="op">.</span><span class="fu">length</span><span class="op">(),</span> p <span class="op">=</span> c<span class="op">.</span><span class="fu">length</span><span class="op">();</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span><span class="op">[][]</span> dp <span class="op">=</span> <span class="kw">new</span> <span class="dt">int</span><span class="op">[</span>m <span class="op">+</span> <span class="dv">1</span><span class="op">][</span>p <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span><span class="op">[][]</span> current <span class="op">=</span> <span class="kw">new</span> <span class="dt">int</span><span class="op">[</span>m <span class="op">+</span> <span class="dv">1</span><span class="op">][</span>p <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> m<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> k <span class="op">&lt;=</span> p<span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>a<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">==</span> b<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">&amp;&amp;</span> b<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">==</span> c<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                    current<span class="op">[</span>j<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> dp<span class="op">[</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>                    current<span class="op">[</span>j<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span><span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span>dp<span class="op">[</span>j<span class="op">][</span>k<span class="op">],</span> current<span class="op">[</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k<span class="op">]),</span> current<span class="op">[</span>j<span class="op">][</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">]);</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Swap arrays</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span><span class="op">[][]</span> temp <span class="op">=</span> dp<span class="op">;</span> </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>        dp <span class="op">=</span> current<span class="op">;</span> </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>        current <span class="op">=</span> temp<span class="op">;</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span>m<span class="op">][</span>p<span class="op">];</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="summary-of-comparisons">Summary of Comparisons</h3>
<ul>
<li><strong>Recursive Approach</strong>: It is easy to understand. But
it is not good for big strings because of the high time complexity.</li>
<li><strong>Dynamic Programming</strong>: It is better than recursion
and works well for medium-sized strings.</li>
<li><strong>Optimized Space DP</strong>: It keeps the same speed as DP
but uses less memory. This makes it good for bigger input sizes.</li>
</ul>
<p>For more information on dynamic programming methods, we can check out
<a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-fibonacci-number-easy.html">Dynamic
Programming - Fibonacci Number</a> and <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-longest-common-subsequence-medium.html">Dynamic
Programming - Longest Common Subsequence</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3 id="what-is-the-longest-common-subsequence-lcs-of-three-strings">1.
What is the Longest Common Subsequence (LCS) of three strings?</h3>
<p>The Longest Common Subsequence (LCS) of three strings is a well-known
problem in dynamic programming. We try to find the longest sequence that
shows up in all three strings in the same order. The sequence does not
have to be next to each other. This problem is harder than finding the
LCS of two strings. It needs a three-dimensional table to solve it
well.</p>
<h3
id="how-can-i-optimize-the-space-complexity-for-the-lcs-of-three-strings">2.
How can I optimize the space complexity for the LCS of three
strings?</h3>
<p>To make the space usage better for the LCS of three strings, we can
use a rolling array method. Instead of using a big 3D array, we can use
two 2D arrays. We switch between these arrays while we calculate the
LCS. This way, we save memory and still find the LCS in a good way.</p>
<h3
id="what-are-common-pitfalls-when-implementing-lcs-for-three-strings">3.
What are common pitfalls when implementing LCS for three strings?</h3>
<p>Some common mistakes when we implement the LCS for three strings are
wrong index handling and not setting up the dynamic programming table
right. We also may forget edge cases like empty strings. It is very
important to take care of the transitions in the DP table and check that
we cover all parts to avoid mistakes.</p>
<h3
id="can-i-use-memoization-for-solving-the-lcs-problem-of-three-strings">4.
Can I use memoization for solving the LCS problem of three strings?</h3>
<p>Yes, we can use memoization to solve the LCS problem for three
strings. By saving the results of smaller problems, we can avoid doing
the same work again. This makes our solution faster. This way works well
when the strings are long and have some similar parts.</p>
<h3
id="how-does-the-lcs-of-three-strings-compare-to-two-strings-in-terms-of-complexity">5.
How does the LCS of three strings compare to two strings in terms of
complexity?</h3>
<p>Finding the LCS of three strings is more complex than doing it for
two strings. The time it takes usually goes up from O(m<em>n) for two
strings to O(m</em>n*p) for three strings. Here, m, n, and p are the
lengths of the three strings. This increase in complexity means we need
better methods to handle larger inputs.</p>
<p>For more information on dynamic programming techniques, we can read
articles about Fibonacci numbers, climbing stairs problem, and more. You
can find them in <a
href="https://bestonlinetutorial.com/dynamic_programming/">Best Online
Tutorialâ€™s dynamic programming section</a>.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            