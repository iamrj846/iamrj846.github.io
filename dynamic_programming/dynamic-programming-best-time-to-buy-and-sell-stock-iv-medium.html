
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
            <!-- Google tag (gtag.js) -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
            <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-TFCQEJR7TD');
            </script>
            
            <title>[Dynamic Programming] Best Time to Buy and Sell Stock IV - Medium</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "BestOnlineTutorial",
      "url": "https://www.bestonlinetutorial.com/"
    }
    </script>

<!-- Common CSS & Icons -->
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
<link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
<link rel="stylesheet" href="/assets/css/post.css">
            <meta name="description" content="Discover optimal strategies for buying and selling stocks using dynamic programming in our guide on Best Time to Buy and Sell Stock IV.">
            <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	        <script src="/assets/js/blog.js"></script>
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">[Dynamic Programming] Best Time to Buy and Sell Stock IV - Medium</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>The problem of “Best Time to Buy and Sell Stock IV” is about finding
the most profit we can make from buying and selling stocks. We have a
limit on the number of transactions we can do. This limits our choices
and affects our plans. To solve this problem, we usually make a table.
This table shows the maximum profit we can get for each day and each
number of transactions. This way, we can quickly find the best
profit.</p>
<p>In this article, we will give a simple guide to the “Best Time to Buy
and Sell Stock IV” problem. We will look at important ideas like the
problem statement, optimal substructure, and overlapping subproblems. We
will also talk about the dynamic programming method. We will show
examples in Java, Python, and C++. We will mention ways to save space
and compare different methods. We will also check how well these
solutions perform and answer common questions about this topic.</p>
<ul>
<li>[Dynamic Programming] Best Time to Buy and Sell Stock IV Solution
Guide</li>
<li>Understanding the Problem Statement for Best Time to Buy and Sell
Stock IV</li>
<li>Optimal Substructure and Overlapping Subproblems in Stock IV</li>
<li>Dynamic Programming Approach for Best Time to Buy and Sell Stock IV
in Java</li>
<li>Dynamic Programming Approach for Best Time to Buy and Sell Stock IV
in Python</li>
<li>Dynamic Programming Approach for Best Time to Buy and Sell Stock IV
in C++</li>
<li>Space Optimization Techniques for Best Time to Buy and Sell Stock
IV</li>
<li>Comparative Analysis of Different Approaches for Stock IV</li>
<li>Performance Complexity of Solutions for Best Time to Buy and Sell
Stock IV</li>
<li>Frequently Asked Questions</li>
</ul>
<p>For more reading on similar dynamic programming ideas, we can check
resources like the <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-fibonacci-number-easy.html">Dynamic
Programming Fibonacci Number</a> and <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-coin-change-medium.html">Dynamic
Programming Coin Change</a>.</p>
<h2
id="understanding-the-problem-statement-for-best-time-to-buy-and-sell-stock-iv">Understanding
the Problem Statement for Best Time to Buy and Sell Stock IV</h2>
<p>The “Best Time to Buy and Sell Stock IV” problem is about making the
most money from stock trades with a limited number of transactions. We
want to find out how much profit we can make by doing at most
<code>k</code> transactions. A transaction is when we buy and then sell
a stock.</p>
<h3 id="problem-definition">Problem Definition</h3>
<ul>
<li>We are given:
<ul>
<li>An array of integers called <code>prices</code>. Here,
<code>prices[i]</code> shows the price of a stock on the
<code>i-th</code> day.</li>
<li>An integer <code>k</code>, which is the maximum number of
transactions we can do.</li>
</ul></li>
<li>Our task is to find the highest profit we can make with at most
<code>k</code> transactions.</li>
</ul>
<h3 id="constraints">Constraints</h3>
<ul>
<li>If <code>k</code> is greater than or equal to <code>n/2</code>
(where <code>n</code> is the number of prices), we can do as many
transactions as we want. In this case, the problem becomes easy. We just
add up all the profitable trades.</li>
<li>If <code>k</code> is less than <code>n/2</code>, we need a smarter
way to solve the problem. We usually use dynamic programming to keep
track of the transaction limits better.</li>
</ul>
<h3 id="example">Example</h3>
<p>Let’s say we have <code>prices = [2, 4, 1, 7, 3, 5]</code> and
<code>k = 2</code>: - The best transactions would be: 1. Buy at price 2
and sell at price 4 (profit = 2). 2. Buy at price 1 and sell at price 7
(profit = 6).</p>
<p>So, the maximum profit we can get here is <code>2 + 6 = 8</code>.</p>
<h3 id="edge-cases">Edge Cases</h3>
<ul>
<li>If <code>prices</code> is empty, then the maximum profit is
<code>0</code>.</li>
<li>If <code>k</code> is <code>0</code>, the maximum profit is also
<code>0</code>.</li>
<li>If there are no profitable trades (like when prices go down all the
time), the profit will still be <code>0</code>.</li>
</ul>
<p>Understanding these points and limits is very important for making a
good solution using dynamic programming.</p>
<h2
id="optimal-substructure-and-overlapping-subproblems-in-stock-iv">Optimal
Substructure and Overlapping Subproblems in Stock IV</h2>
<p>We have the problem of buying and selling stock many times. There is
a limit on how many transactions we can make. This problem shows optimal
substructure and overlapping subproblems. These are important traits
that make it good for dynamic programming.</p>
<h3 id="optimal-substructure">Optimal Substructure</h3>
<p>The optimal substructure means we can build the best solution from
the best solutions of smaller problems. For the Best Time to Buy and
Sell Stock IV problem, we can get the maximum profit by looking at:</p>
<ul>
<li>Our choice to buy or sell each day.</li>
<li>The profits from earlier transactions.</li>
</ul>
<p>We can use <code>dp[k][d]</code> to show the maximum profit we can
get with at most <code>k</code> transactions by the end of day
<code>d</code>. The relation looks like this:</p>
<pre><code>dp[k][d] = max(dp[k][d-1], prices[d] + max(prices[j] - dp[k-1][j]) for all j &lt; d)</code></pre>
<p>Here: - <code>prices[d]</code> is the stock price on day
<code>d</code>. - <code>dp[k][d-1]</code> shows what happens when we do
not make any transaction on day <code>d</code>. - The second part finds
the profit by selling on day <code>d</code> after buying on any earlier
day <code>j</code>.</p>
<h3 id="overlapping-subproblems">Overlapping Subproblems</h3>
<p>Overlapping subproblems happen when we solve the same small problems
many times. In Stock IV, many states <code>dp[k][d]</code> depend on
states we calculated before, like <code>dp[k-1][j]</code> for all
<code>j &lt; d</code>. So, we store the results in a table. This way, we
avoid recalculating them and this makes the process faster.</p>
<h3 id="recurrence-relation">Recurrence Relation</h3>
<p>We can summarize the recurrence relation like this:</p>
<ol type="1">
<li><p>If we do not make a transaction on day <code>d</code>:</p>
<pre><code>dp[k][d] = dp[k][d-1]</code></pre></li>
<li><p>If we do make a transaction on day <code>d</code>:</p>
<pre><code>dp[k][d] = max(dp[k][d-1], prices[d] + max(prices[j] - dp[k-1][j]) for all j &lt; d)</code></pre></li>
</ol>
<h3 id="time-complexity">Time Complexity</h3>
<p>The time complexity for the simple approach is O(K * D^2). Here,
<code>K</code> is the number of transactions and <code>D</code> is the
number of days. We can make it better by using a temporary variable to
track the maximum profit from earlier transactions. This gives us a time
complexity of O(K * D).</p>
<p>This dynamic programming method helps us handle the overlapping
subproblems well and uses the optimal substructure. This makes it a good
way to solve the Best Time to Buy and Sell Stock IV problem. If you want
to read more about similar dynamic programming problems, check out the
<a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-coin-change-medium.html">Dynamic
Programming Coin Change</a> and <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-house-robber-i-easy.html">Dynamic
Programming House Robber</a> articles.</p>
<h2
id="dynamic-programming-approach-for-best-time-to-buy-and-sell-stock-iv-in-java">Dynamic
Programming Approach for Best Time to Buy and Sell Stock IV in Java</h2>
<p>To solve the “Best Time to Buy and Sell Stock IV” problem using
dynamic programming in Java, we track the maximum profit possible with a
certain number of transactions. We use a 3D DP array. Here is how it
works:</p>
<ul>
<li><code>dp[k][i]</code> shows the maximum profit we can get using at
most <code>k</code> transactions up to the <code>i-th</code> day.</li>
</ul>
<h3 id="java-implementation">Java Implementation</h3>
<div class="sourceCode" id="cb4"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> StockProfit <span class="op">{</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">int</span> <span class="fu">maxProfit</span><span class="op">(</span><span class="dt">int</span> k<span class="op">,</span> <span class="dt">int</span><span class="op">[]</span> prices<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>prices<span class="op">.</span><span class="fu">length</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> k <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>k <span class="op">&gt;=</span> prices<span class="op">.</span><span class="fu">length</span> <span class="op">/</span> <span class="dv">2</span><span class="op">)</span> <span class="cf">return</span> <span class="fu">quickProfit</span><span class="op">(</span>prices<span class="op">);</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span><span class="op">[][]</span> dp <span class="op">=</span> <span class="kw">new</span> <span class="dt">int</span><span class="op">[</span>k <span class="op">+</span> <span class="dv">1</span><span class="op">][</span>prices<span class="op">.</span><span class="fu">length</span><span class="op">];</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> k<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> maxDiff <span class="op">=</span> <span class="op">-</span>prices<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;</span> prices<span class="op">.</span><span class="fu">length</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span>dp<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">],</span> prices<span class="op">[</span>j<span class="op">]</span> <span class="op">+</span> maxDiff<span class="op">);</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                maxDiff <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span>maxDiff<span class="op">,</span> dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j<span class="op">]</span> <span class="op">-</span> prices<span class="op">[</span>j<span class="op">]);</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> dp<span class="op">[</span>k<span class="op">][</span>prices<span class="op">.</span><span class="fu">length</span> <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="dt">int</span> <span class="fu">quickProfit</span><span class="op">(</span><span class="dt">int</span><span class="op">[]</span> prices<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> profit <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> prices<span class="op">.</span><span class="fu">length</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>prices<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;</span> prices<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>                profit <span class="op">+=</span> prices<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> prices<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> profit<span class="op">;</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="explanation-of-the-code">Explanation of the Code:</h3>
<ul>
<li><strong>Function <code>maxProfit</code></strong>: This function
takes the maximum number of transactions <code>k</code> and an array of
stock prices.</li>
<li><strong>Base Cases</strong>: If the prices array is empty or
<code>k</code> is zero, we return 0. If <code>k</code> is greater than
half the number of days, we calculate profit using the
<code>quickProfit</code> method.</li>
<li><strong>Dynamic Programming Table</strong>: We create a 2D array
<code>dp</code>. In this array, <code>dp[i][j]</code> saves the maximum
profit with <code>i</code> transactions until the <code>j-th</code>
day.</li>
<li><strong>Max Difference Calculation</strong>: For each day, we keep a
<code>maxDiff</code>. This helps us find the maximum profit for that day
by looking at previous transactions.</li>
<li><strong>Return Value</strong>: Finally,
<code>dp[k][prices.length - 1]</code> gives the maximum profit we can
make with <code>k</code> transactions until the last day.</li>
</ul>
<p>This dynamic programming way helps us calculate the maximum profit
for buying and selling stocks. It follows the rules of the problem,
especially the limit on the number of transactions allowed. For similar
problems, you can check <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-best-time-to-buy-and-sell-stock-with-cooldown-medium.html">Dynamic
Programming: Best Time to Buy and Sell Stock with Cooldown</a>.</p>
<h2
id="dynamic-programming-approach-for-best-time-to-buy-and-sell-stock-iv-in-python">Dynamic
Programming Approach for Best Time to Buy and Sell Stock IV in
Python</h2>
<p>We want to solve the problem of finding the highest profit from at
most <code>k</code> transactions in the “Best Time to Buy and Sell Stock
IV” using dynamic programming in Python. We can use a 2D DP table for
this. The main idea is to track the maximum profit we can make with a
certain number of transactions up to each day.</p>
<h3 id="problem-definition-1">Problem Definition</h3>
<p>We have: - <code>k</code>: the maximum number of transactions we can
make. - <code>prices</code>: a list of stock prices where
<code>prices[i]</code> is the price of the stock on the
<code>i-th</code> day.</p>
<h3 id="dynamic-programming-table">Dynamic Programming Table</h3>
<p>Let <code>dp[t][d]</code> be the maximum profit we can get with at
most <code>t</code> transactions up to day <code>d</code>.</p>
<h4 id="transition-formula">Transition Formula</h4>
<ol type="1">
<li><p>If we don’t sell on day <code>d</code>:<br />
<code>dp[t][d] = dp[t][d-1]</code></p></li>
<li><p>If we sell on day <code>d</code>, we have to find the best day to
buy before day <code>d</code>:<br />
<code>dp[t][d] = max(dp[t][d-1], prices[d] + max(prices[m] - dp[t-1][m] for m in range(d)))</code></p></li>
</ol>
<h3 id="implementation">Implementation</h3>
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> maxProfit(k, prices):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> prices <span class="kw">or</span> k <span class="op">&lt;=</span> <span class="dv">0</span>:</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(prices)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> k <span class="op">&gt;=</span> n <span class="op">//</span> <span class="dv">2</span>:  <span class="co"># More transactions than days</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">sum</span>(<span class="bu">max</span>(prices[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> prices[i], <span class="dv">0</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    dp <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> n <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(k <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, k <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        max_diff <span class="op">=</span> <span class="op">-</span>prices[<span class="dv">0</span>]</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> d <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>            dp[t][d] <span class="op">=</span> <span class="bu">max</span>(dp[t][d<span class="op">-</span><span class="dv">1</span>], prices[d] <span class="op">+</span> max_diff)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>            max_diff <span class="op">=</span> <span class="bu">max</span>(max_diff, dp[t<span class="op">-</span><span class="dv">1</span>][d] <span class="op">-</span> prices[d])</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp[k][n<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Example Usage</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>prices <span class="op">=</span> [<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">3</span>]</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(maxProfit(k, prices))  <span class="co"># Output: 7</span></span></code></pre></div>
<h3 id="explanation-of-the-code-1">Explanation of the Code</h3>
<p>First, we check if there are no prices or if <code>k</code> is zero.
In that case, we return 0. If <code>k</code> is greater than half the
number of days, we can make as many transactions as we want. So we add
all positive differences.</p>
<p>We set up a DP table where <code>dp[t][d]</code> keeps the maximum
profit for <code>t</code> transactions by day <code>d</code>. We go
through the number of transactions and days. We update the DP table
based on if we sell or not that day.</p>
<p>In the end, we return the value at <code>dp[k][n-1]</code>, which is
the maximum profit we can have with <code>k</code> transactions by the
last day.</p>
<p>This method has a time complexity of (O(k n)) and a space complexity
of (O(k n)). This makes it good for moderate values of <code>k</code>
and <code>n</code>.</p>
<p>For more reading, we can look at other dynamic programming topics
like <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-best-time-to-buy-and-sell-stock-with-cooldown-medium.html">Dynamic
Programming - Best Time to Buy and Sell Stock with Cooldown</a>.</p>
<h2
id="dynamic-programming-approach-for-best-time-to-buy-and-sell-stock-iv-in-c">Dynamic
Programming Approach for Best Time to Buy and Sell Stock IV in C++</h2>
<p>In this section, we will show how to use dynamic programming to solve
the “Best Time to Buy and Sell Stock IV” problem in C++. This problem is
about finding the best profit we can get with at most <code>k</code>
transactions. We look at stock prices over several days.</p>
<h3 id="problem-definition-2">Problem Definition</h3>
<p>You have an integer array <code>prices</code>. Here,
<code>prices[i]</code> is the price of a stock on the <code>i-th</code>
day. Also, you have an integer <code>k</code>, which is the most
transactions you can make. The goal is to make the most profit from
buying and selling stocks.</p>
<h3 id="dynamic-programming-approach">Dynamic Programming Approach</h3>
<p>We will create a 3D DP array called <code>dp[i][j][k]</code> where: -
<code>i</code> is the day index (from 0 to n-1). - <code>j</code> is the
number of transactions (from 1 to k). - <code>k</code> is the state (0
means we do not hold stock and 1 means we hold stock).</p>
<p>The transitions are: - If we do not hold stock on day <code>i</code>
after <code>j</code> transactions: -
<code>dp[i][j][0] = max(dp[i-1][j][0], dp[i-1][j][1] + prices[i])</code>
- If we hold stock on day <code>i</code> after <code>j</code>
transactions: -
<code>dp[i][j][1] = max(dp[i-1][j][1], dp[i-1][j-1][0] - prices[i])</code></p>
<h3 id="c-implementation">C++ Implementation</h3>
<div class="sourceCode" id="cb6"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Solution <span class="op">{</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> maxProfit<span class="op">(</span><span class="dt">int</span> k<span class="op">,</span> vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&amp;</span> prices<span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> n <span class="op">=</span> prices<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> k <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>k <span class="op">&gt;=</span> n <span class="op">/</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> maxProfit <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                maxProfit <span class="op">+=</span> max<span class="op">(</span>prices<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> prices<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">],</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> maxProfit<span class="op">;</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        vector<span class="op">&lt;</span>vector<span class="op">&lt;</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;&gt;</span> dp<span class="op">(</span>n<span class="op">,</span> vector<span class="op">&lt;</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;(</span>k <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="dv">2</span><span class="op">,</span> <span class="dv">0</span><span class="op">)));</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> k<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>            dp<span class="op">[</span><span class="dv">0</span><span class="op">][</span>j<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">-</span>prices<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> k<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>                dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j<span class="op">][</span><span class="dv">0</span><span class="op">],</span> dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">+</span> prices<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>                dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j<span class="op">][</span><span class="dv">1</span><span class="op">],</span> dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">-</span> prices<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> dp<span class="op">[</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k<span class="op">][</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<h3 id="explanation-of-the-code-2">Explanation of the Code</h3>
<ul>
<li>The code starts by creating a 3D dynamic programming array
<code>dp</code>.</li>
<li>It checks the special case where <code>k</code> is greater than half
of the number of days. In this case, we can do unlimited
transactions.</li>
<li>The main loop goes through each day and updates the DP array to find
the maximum profit based on the rules we set.</li>
<li>At the end, it gives back the maximum profit we can get after the
last day.</li>
</ul>
<p>This C++ code smartly finds the maximum profit for the “Best Time to
Buy and Sell Stock IV” problem using a dynamic programming method. It
works well even with larger inputs.</p>
<h2
id="space-optimization-techniques-for-best-time-to-buy-and-sell-stock-iv">Space
Optimization Techniques for Best Time to Buy and Sell Stock IV</h2>
<p>To make space better for solving the “Best Time to Buy and Sell Stock
IV” problem, we can use a simple idea. We only need to keep a few states
at any time. Instead of a big 2D array for dynamic programming, we can
lower our space use from O(K * N) to O(K) or even O(1) based on how we
do it.</p>
<h3 id="space-reduction-by-using-1d-arrays">1. Space Reduction by Using
1D Arrays</h3>
<p>Instead of keeping a 2D DP array, we can use two 1D arrays. These
arrays show the current and past states. This works well when we change
from one day to the next.</p>
<p><strong>Java Implementation:</strong></p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">int</span> <span class="fu">maxProfit</span><span class="op">(</span><span class="dt">int</span> k<span class="op">,</span> <span class="dt">int</span><span class="op">[]</span> prices<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>prices<span class="op">.</span><span class="fu">length</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>k <span class="op">&gt;=</span> prices<span class="op">.</span><span class="fu">length</span> <span class="op">/</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> maxProfit <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> prices<span class="op">.</span><span class="fu">length</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>prices<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;</span> prices<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                maxProfit <span class="op">+=</span> prices<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> prices<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> maxProfit<span class="op">;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span><span class="op">[]</span> buy <span class="op">=</span> <span class="kw">new</span> <span class="dt">int</span><span class="op">[</span>k <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span><span class="op">[]</span> sell <span class="op">=</span> <span class="kw">new</span> <span class="dt">int</span><span class="op">[</span>k <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> price <span class="op">:</span> prices<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> k<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>            buy<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span>buy<span class="op">[</span>i<span class="op">],</span> sell<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">-</span> price<span class="op">);</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>            sell<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span>sell<span class="op">[</span>i<span class="op">],</span> buy<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span> price<span class="op">);</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sell<span class="op">[</span>k<span class="op">];</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="utilizing-variables-instead-of-arrays">2. Utilizing Variables
Instead of Arrays</h3>
<p>For more space saving, if we look closely at the changes, we can use
fewer variables. We can keep just the past values we need for
calculations.</p>
<p><strong>Python Implementation:</strong></p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> maxProfit(k, prices):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> prices:</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> k <span class="op">&gt;=</span> <span class="bu">len</span>(prices) <span class="op">//</span> <span class="dv">2</span>:</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">sum</span>(<span class="bu">max</span>(prices[i] <span class="op">-</span> prices[i <span class="op">-</span> <span class="dv">1</span>], <span class="dv">0</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(prices)))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    buy <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (k <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    sell <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (k <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> price <span class="kw">in</span> prices:</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, k <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>            prev_buy <span class="op">=</span> buy[i]</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>            buy[i] <span class="op">=</span> <span class="bu">max</span>(buy[i], sell[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> price)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>            sell[i] <span class="op">=</span> <span class="bu">max</span>(sell[i], prev_buy <span class="op">+</span> price)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sell[k]</span></code></pre></div>
<h3 id="constant-space-approach">3. Constant Space Approach</h3>
<p>Sometimes, we can cut down space use to O(1). We only use a few
variables to track the values we need through the steps.</p>
<p><strong>C++ Implementation:</strong></p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> maxProfit<span class="op">(</span><span class="dt">int</span> k<span class="op">,</span> vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&amp;</span> prices<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>prices<span class="op">.</span>empty<span class="op">())</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>k <span class="op">&gt;=</span> prices<span class="op">.</span>size<span class="op">()</span> <span class="op">/</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> maxProfit <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> prices<span class="op">.</span>size<span class="op">();</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>prices<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;</span> prices<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                maxProfit <span class="op">+=</span> prices<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> prices<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> maxProfit<span class="op">;</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> buy<span class="op">(</span>k <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> INT_MIN<span class="op">),</span> sell<span class="op">(</span>k <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> price <span class="op">:</span> prices<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> k<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>            buy<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>buy<span class="op">[</span>i<span class="op">],</span> sell<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">-</span> price<span class="op">);</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>            sell<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>sell<span class="op">[</span>i<span class="op">],</span> buy<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span> price<span class="op">);</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sell<span class="op">[</span>k<span class="op">];</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>These space optimization techniques help us use less memory while
keeping the solution correct for the “Best Time to Buy and Sell Stock
IV” problem. By using 1D arrays and cutting down the number of
variables, we can get good solutions that save time and space. For more
learning about dynamic programming, check out articles on <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-fibonacci-number-easy.html">Dynamic
Programming Fibonacci Number</a> and <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-coin-change-medium.html">Dynamic
Programming Coin Change</a>.</p>
<h2
id="comparative-analysis-of-different-approaches-for-stock-iv">Comparative
Analysis of Different Approaches for Stock IV</h2>
<p>We can look at different ways to solve the “Best Time to Buy and Sell
Stock IV” problem. We will check how well each method works. Here are
the main methods:</p>
<ol type="1">
<li><strong>Brute Force Approach</strong>:
<ul>
<li>We try all possible combinations of buying and selling. Then we
calculate the profits.<br />
</li>
<li>Time Complexity: O(n^k). Here, n is the number of days and k is the
maximum number of transactions.<br />
</li>
<li>Space Complexity: O(1).</li>
</ul></li>
<li><strong>Dynamic Programming Approach</strong>:
<ul>
<li>We use a 3D table called <code>dp[t][d][k]</code> where:
<ul>
<li><code>t</code> is the number of transactions.<br />
</li>
<li><code>d</code> is the current day.<br />
</li>
<li><code>k</code> is 0 for no stock and 1 for holding stock.<br />
</li>
</ul></li>
<li>The formulas we use are:
<ul>
<li><code>dp[t][d][0] = max(dp[t][d-1][0], dp[t-1][d-1][1] + prices[d])</code><br />
</li>
<li><code>dp[t][d][1] = max(dp[t][d-1][1], dp[t][d-1][0] - prices[d])</code><br />
</li>
</ul></li>
<li>Time Complexity: O(k * n).<br />
</li>
<li>Space Complexity: O(k * n).</li>
</ul></li>
<li><strong>Optimized Dynamic Programming</strong>:
<ul>
<li>We can use just two arrays to save results from the last and current
transactions. This helps reduce space.<br />
</li>
<li>Time Complexity: O(k * n).<br />
</li>
<li>Space Complexity: O(n) or O(1), depending on how we set up the
arrays.</li>
</ul></li>
</ol>
<h3 id="code-examples">Code Examples</h3>
<p><strong>Java Implementation</strong>:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">int</span> <span class="fu">maxProfit</span><span class="op">(</span><span class="dt">int</span> k<span class="op">,</span> <span class="dt">int</span><span class="op">[]</span> prices<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>prices<span class="op">.</span><span class="fu">length</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>k <span class="op">&gt;=</span> prices<span class="op">.</span><span class="fu">length</span> <span class="op">/</span> <span class="dv">2</span><span class="op">)</span> <span class="cf">return</span> <span class="fu">quickSolve</span><span class="op">(</span>prices<span class="op">);</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span><span class="op">[][]</span> dp <span class="op">=</span> <span class="kw">new</span> <span class="dt">int</span><span class="op">[</span>k <span class="op">+</span> <span class="dv">1</span><span class="op">][</span>prices<span class="op">.</span><span class="fu">length</span><span class="op">];</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> t <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> t <span class="op">&lt;=</span> k<span class="op">;</span> t<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> maxDiff <span class="op">=</span> <span class="op">-</span>prices<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> d <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> d <span class="op">&lt;</span> prices<span class="op">.</span><span class="fu">length</span><span class="op">;</span> d<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>            dp<span class="op">[</span>t<span class="op">][</span>d<span class="op">]</span> <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span>dp<span class="op">[</span>t<span class="op">][</span>d <span class="op">-</span> <span class="dv">1</span><span class="op">],</span> prices<span class="op">[</span>d<span class="op">]</span> <span class="op">+</span> maxDiff<span class="op">);</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>            maxDiff <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span>maxDiff<span class="op">,</span> dp<span class="op">[</span>t <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>d<span class="op">]</span> <span class="op">-</span> prices<span class="op">[</span>d<span class="op">]);</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span>k<span class="op">][</span>prices<span class="op">.</span><span class="fu">length</span> <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> <span class="dt">int</span> <span class="fu">quickSolve</span><span class="op">(</span><span class="dt">int</span><span class="op">[]</span> prices<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> maxProfit <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> prices<span class="op">.</span><span class="fu">length</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>prices<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;</span> prices<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>            maxProfit <span class="op">+=</span> prices<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> prices<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> maxProfit<span class="op">;</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Python Implementation</strong>:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> maxProfit(k, prices):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> prices:</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> k <span class="op">&gt;=</span> <span class="bu">len</span>(prices) <span class="op">//</span> <span class="dv">2</span>:</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">sum</span>(<span class="bu">max</span>(prices[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> prices[i], <span class="dv">0</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(prices)<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    dp <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> <span class="bu">len</span>(prices) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(k <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, k <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        maxDiff <span class="op">=</span> <span class="op">-</span>prices[<span class="dv">0</span>]</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> d <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(prices)):</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>            dp[t][d] <span class="op">=</span> <span class="bu">max</span>(dp[t][d <span class="op">-</span> <span class="dv">1</span>], prices[d] <span class="op">+</span> maxDiff)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>            maxDiff <span class="op">=</span> <span class="bu">max</span>(maxDiff, dp[t <span class="op">-</span> <span class="dv">1</span>][d] <span class="op">-</span> prices[d])</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp[k][<span class="op">-</span><span class="dv">1</span>]</span></code></pre></div>
<p><strong>C++ Implementation</strong>:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> maxProfit<span class="op">(</span><span class="dt">int</span> k<span class="op">,</span> vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&amp;</span> prices<span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>prices<span class="op">.</span>empty<span class="op">())</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>k <span class="op">&gt;=</span> prices<span class="op">.</span>size<span class="op">()</span> <span class="op">/</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> maxProfit <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> prices<span class="op">.</span>size<span class="op">();</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>prices<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;</span> prices<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                maxProfit <span class="op">+=</span> prices<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> prices<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> maxProfit<span class="op">;</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;</span> dp<span class="op">(</span>k <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span>prices<span class="op">.</span>size<span class="op">(),</span> <span class="dv">0</span><span class="op">));</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> t <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> t <span class="op">&lt;=</span> k<span class="op">;</span> t<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> maxDiff <span class="op">=</span> <span class="op">-</span>prices<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> d <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> d <span class="op">&lt;</span> prices<span class="op">.</span>size<span class="op">();</span> d<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>            dp<span class="op">[</span>t<span class="op">][</span>d<span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>dp<span class="op">[</span>t<span class="op">][</span>d <span class="op">-</span> <span class="dv">1</span><span class="op">],</span> prices<span class="op">[</span>d<span class="op">]</span> <span class="op">+</span> maxDiff<span class="op">);</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>            maxDiff <span class="op">=</span> max<span class="op">(</span>maxDiff<span class="op">,</span> dp<span class="op">[</span>t <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>d<span class="op">]</span> <span class="op">-</span> prices<span class="op">[</span>d<span class="op">]);</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span>k<span class="op">].</span>back<span class="op">();</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>These methods help us understand how to solve the “Best Time to Buy
and Sell Stock IV” problem well. We can balance time and space use. If
you want to learn more about dynamic programming, you can check articles
on <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-fibonacci-number-easy.html">Dynamic
Programming: Fibonacci Number</a> and <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-coin-change-medium.html">Dynamic
Programming: Coin Change</a>.</p>
<h2
id="performance-complexity-of-solutions-for-best-time-to-buy-and-sell-stock-iv">Performance
Complexity of Solutions for Best Time to Buy and Sell Stock IV</h2>
<p>We can look at the performance complexity of solutions for the “Best
Time to Buy and Sell Stock IV” problem by checking both time and space
complexity. The problem allows for <code>k</code> transactions. If
<code>k</code> is big, we can find different complexities based on the
algorithm we choose.</p>
<h3 id="dynamic-programming-approach-1">Dynamic Programming
Approach</h3>
<ol type="1">
<li><strong>Time Complexity</strong>:
<ul>
<li>The dynamic programming solution goes through the prices and
transactions. The time complexity is usually O(n * k). Here,
<code>n</code> is the number of days (or prices) and <code>k</code> is
the highest number of transactions we can have.</li>
<li>For each transaction, we might need to look at all previous days to
find the maximum profit.</li>
</ul></li>
<li><strong>Space Complexity</strong>:
<ul>
<li>The space complexity can be O(k) if we use a rolling array to keep
profits for the last transaction. If we use a simple method, the space
complexity is O(n * k) because we need a 2D array to store profits for
each transaction and day.</li>
</ul></li>
</ol>
<h3 id="code-example-in-python">Code Example in Python</h3>
<p>Here is a simple dynamic programming example for better
understanding:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> maxProfit(k, prices):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> prices <span class="kw">or</span> k <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(prices)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> k <span class="op">&gt;=</span> n <span class="op">//</span> <span class="dv">2</span>:</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">sum</span>(<span class="bu">max</span>(prices[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">-</span> prices[i], <span class="dv">0</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    dp <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> (k <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n)]</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, k <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        max_diff <span class="op">=</span> <span class="op">-</span>prices[<span class="dv">0</span>]</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>            dp[i][j] <span class="op">=</span> <span class="bu">max</span>(dp[i <span class="op">-</span> <span class="dv">1</span>][j], prices[i] <span class="op">+</span> max_diff)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>            max_diff <span class="op">=</span> <span class="bu">max</span>(max_diff, dp[i][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> prices[i])</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp[<span class="op">-</span><span class="dv">1</span>][<span class="op">-</span><span class="dv">1</span>]</span></code></pre></div>
<h3 id="alternative-approaches">Alternative Approaches</h3>
<ul>
<li><strong>Greedy Approach</strong>: This is not good for this problem
because it does not work well with many transactions.</li>
<li><strong>Memoization</strong>: This can help lower time complexity in
cases with overlapping subproblems. It can make performance better in
some situations.</li>
</ul>
<h3 id="comparative-analysis">Comparative Analysis</h3>
<ul>
<li>For small <code>k</code> values, the dynamic programming method is
good and easy to use.</li>
<li>For big <code>k</code> values, we should think about saving space by
only keeping the last two states of the DP array.</li>
</ul>
<h3 id="practical-considerations">Practical Considerations</h3>
<p>When we implement solutions for “Best Time to Buy and Sell Stock IV”,
we need to think about: - The number of transactions <code>k</code>
compared to the number of prices <code>n</code>. - The balance between
time and space complexity based on what the specific problem needs.</p>
<p>For more optimization and other dynamic programming methods, we can
look at articles on <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-coin-change-medium.html">Coin
Change Problem</a> and <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-best-time-to-buy-and-sell-stock-with-cooldown-medium.html">Best
Time to Buy and Sell Stock with Cooldown</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3
id="what-is-the-problem-statement-for-best-time-to-buy-and-sell-stock-iv">1.
What is the problem statement for Best Time to Buy and Sell Stock
IV?</h3>
<p>The problem statement for <em>Best Time to Buy and Sell Stock IV</em>
is to find the maximum profit we can get from at most <code>k</code>
transactions. We do this with an array of stock prices. This is a
dynamic programming challenge. We need to understand how to break the
problem into smaller parts and solve them. For more details on dynamic
programming, look at our article on <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-fibonacci-number-easy.html">Dynamic
Programming: Fibonacci Number</a>.</p>
<h3 id="how-does-dynamic-programming-apply-to-stock-iv">2. How does
dynamic programming apply to Stock IV?</h3>
<p>We use dynamic programming in <em>Best Time to Buy and Sell Stock
IV</em> by dividing the problem into easier parts. The algorithm keeps a
table to save results we already found for different transaction counts
and days. This helps us calculate the maximum profit faster. Knowing
this method is important to learn dynamic programming well. You can find
more examples in our guide on <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-climbing-stairs-easy.html">Dynamic
Programming: Climbing Stairs</a>.</p>
<h3
id="what-is-the-time-complexity-of-the-best-time-to-buy-and-sell-stock-iv-solution">3.
What is the time complexity of the Best Time to Buy and Sell Stock IV
solution?</h3>
<p>The time complexity of the <em>Best Time to Buy and Sell Stock
IV</em> solution is O(n*k). Here, <code>n</code> is the number of days
and <code>k</code> is the maximum number of transactions we can do. This
complexity comes from checking the price array for each transaction. If
you want to know more about performance analysis, read about the <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-coin-change-medium.html">Dynamic
Programming: Coin Change</a>.</p>
<h3
id="can-the-best-time-to-buy-and-sell-stock-iv-be-solved-using-recursion">4.
Can the Best Time to Buy and Sell Stock IV be solved using
recursion?</h3>
<p>Yes, we can solve the <em>Best Time to Buy and Sell Stock IV</em>
problem with recursion. But this way may cause exponential time
complexity because we calculate the same parts many times. If we use
memoization, we can make it faster. For more on recursive methods in
dynamic programming, see our article on <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-decode-ways-medium.html">Dynamic
Programming: Decode Ways</a>.</p>
<h3 id="how-can-i-optimize-space-complexity-in-stock-iv">5. How can I
optimize space complexity in Stock IV?</h3>
<p>To make space complexity better in <em>Best Time to Buy and Sell
Stock IV</em>, we can save space by only remembering the last two
states. This means we do not need a full DP table. This change cuts
space usage from O(n*k) to O(k). This makes it much more efficient. For
more ways to optimize space, check our guide on <a
href="https://bestonlinetutorial.com/dynamic_programming/dynamic-programming-minimum-path-sum-in-a-grid-medium.html">Dynamic
Programming: Minimum Path Sum</a>.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            