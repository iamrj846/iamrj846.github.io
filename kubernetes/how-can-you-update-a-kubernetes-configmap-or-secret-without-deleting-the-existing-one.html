
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
            <!-- Google tag (gtag.js) -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
            <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-TFCQEJR7TD');
            </script>
            <meta charset="utf-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            
            <meta property="og:title" content="How Can You Update a Kubernetes ConfigMap or Secret Without Deleting the Existing One?" />
            <meta property="og:description" content="Learn how to update a Kubernetes ConfigMap or Secret seamlessly without deleting the existing one. Enhance your Kubernetes skills!" />
            <meta property="og:url" content="https://www.bestonlinetutorial.com/kubernetes/how-can-you-update-a-kubernetes-configmap-or-secret-without-deleting-the-existing-one.html" />
            <link rel="canonical" href="https://www.bestonlinetutorial.com/kubernetes/how-can-you-update-a-kubernetes-configmap-or-secret-without-deleting-the-existing-one.html">
            <meta property="og:type" content="article" />
            <meta property="og:site_name" content=“BestOnlineTutorial” />
            <meta name="twitter:title" content="How Can You Update a Kubernetes ConfigMap or Secret Without Deleting the Existing One?" />
            <meta name="twitter:description" content="Learn how to update a Kubernetes ConfigMap or Secret seamlessly without deleting the existing one. Enhance your Kubernetes skills!" />
            <meta name="pinterest-rich-pin" content="true" />

            <script type="application/ld+json">
                {
                "@context": "https://schema.org",
                "@type": "WebSite",
                "name": "BestOnlineTutorial",
                "url": "https://www.bestonlinetutorial.com/"
                }
            </script>
            <!-- Common CSS & Icons -->
            <link rel="icon" href="/favicon.ico" type="image/x-icon">
            <link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
            <link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
            <link rel="stylesheet" href="/assets/css/post.css">
            <title>How Can You Update a Kubernetes ConfigMap or Secret Without Deleting the Existing One?</title>
            <meta name="description" content="Learn how to update a Kubernetes ConfigMap or Secret seamlessly without deleting the existing one. Enhance your Kubernetes skills!">
            <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	        <script src="/assets/js/blog.js"></script>
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">How Can You Update a Kubernetes ConfigMap or Secret Without Deleting the Existing One?</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>Updating a Kubernetes ConfigMap or Secret without removing the old
one is very important for keeping our applications stable. We can do
this easily using a few ways. We can use <code>kubectl apply</code>,
<code>kubectl patch</code>, Helm, or Kustomize. These methods help us
change the current settings without messing up our apps or losing
important data.</p>
<p>In this article, we will look at different ways to update Kubernetes
ConfigMaps and Secrets safely. We will talk about how to use
<code>kubectl apply</code> for updates. We will also see how to use the
<code>kubectl patch</code> command. Next, we will explore how to use
Helm for safe deployments. Finally, we will check out Kustomize for
managing configurations. We will also share some best tips to make sure
updates go smoothly. Plus, we will answer some common questions about
this process.</p>
<ul>
<li>How to Update a Kubernetes ConfigMap or Secret Without Deleting the
Existing One</li>
<li>Using kubectl apply to Update ConfigMaps and Secrets</li>
<li>How to Use the kubectl patch Command for Updating ConfigMaps and
Secrets</li>
<li>Leveraging Helm to Update ConfigMaps and Secrets Safely</li>
<li>Utilizing Kustomize for Updating ConfigMaps and Secrets in
Kubernetes</li>
<li>Best Practices for Updating Kubernetes ConfigMaps and Secrets
Without Deletion</li>
<li>Frequently Asked Questions</li>
</ul>
<p>For more information about working with Kubernetes, you can read
about <a
href="https://bestonlinetutorial.com/kubernetes/what-is-kubernetes-and-how-does-it-simplify-container-management.html">what
Kubernetes is and how it helps container management</a> or find out <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-manage-secrets-in-kubernetes-securely.html">how
to manage secrets safely in Kubernetes</a>.</p>
<h2 id="using-kubectl-apply-to-update-configmaps-and-secrets">Using
kubectl apply to Update ConfigMaps and Secrets</h2>
<p>We can update a Kubernetes ConfigMap or Secret without deleting the
old one. We do this by using the <code>kubectl apply</code> command.
This command helps us to make changes to our existing resources
easily.</p>
<h3 id="updating-a-configmap">Updating a ConfigMap</h3>
<ol type="1">
<li><p><strong>Edit the ConfigMap YAML file</strong> to show the new
settings. For example, if our ConfigMap is named
<code>my-config</code>:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-config</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">key1</span><span class="kw">:</span><span class="at"> new-value</span></span></code></pre></div></li>
<li><p><strong>Apply the changes</strong> by using this command:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> my-config.yaml</span></code></pre></div></li>
</ol>
<p>This command will update the ConfigMap with the new values from the
YAML file.</p>
<h3 id="updating-a-secret">Updating a Secret</h3>
<ol type="1">
<li><p><strong>Edit the Secret YAML file</strong>. If we have a Secret
called <code>my-secret</code>, it might look like this:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Secret</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-secret</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">type</span><span class="kw">:</span><span class="at"> Opaque</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">password</span><span class="kw">:</span><span class="at"> bXlwYXNzd29yZA==</span><span class="co">  # base64 encoded value</span></span></code></pre></div>
<p>Change the value as needed.</p></li>
<li><p><strong>Apply the changes</strong>:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> my-secret.yaml</span></code></pre></div></li>
</ol>
<p>The <code>kubectl apply</code> command will update the Secret without
needing us to delete it first.</p>
<h3 id="note-on-base64-encoding">Note on Base64 Encoding</h3>
<p>When we update Secrets, we must make sure the values are base64
encoded. We can encode a string using this command:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-n</span> <span class="st">&#39;my-password&#39;</span> <span class="kw">|</span> <span class="fu">base64</span></span></code></pre></div>
<p>This will give us the base64 encoded string for our Secret YAML.</p>
<h3 id="automatic-rollout-of-pods">Automatic Rollout of Pods</h3>
<p>When we update ConfigMaps or Secrets, the pods that use them might
need to restart to get the new changes. We should set up our deployments
to manage this. We can use annotations or other ways to restart pods
when the ConfigMap or Secret changes.</p>
<p>For example, we can add an annotation in our Deployment YAML:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">annotations</span><span class="kw">:</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">kubernetes.io/change-cause</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Updated config at $(date)&quot;</span></span></code></pre></div>
<p>This will start a redeployment every time we update the ConfigMap or
Secret using <code>kubectl apply</code>.</p>
<h2
id="how-to-use-the-kubectl-patch-command-for-updating-configmaps-and-secrets">How
to Use the kubectl patch Command for Updating ConfigMaps and
Secrets</h2>
<p>The <code>kubectl patch</code> command helps us to update existing
Kubernetes ConfigMaps and Secrets. We do not need to delete them. This
command is very useful for making small changes to our configuration
data. We can do this without stopping the current deployments.</p>
<h3 id="updating-a-configmap-1">Updating a ConfigMap</h3>
<p>To update a ConfigMap with <code>kubectl patch</code>, we need to say
which field we want to change. For example, if we have a ConfigMap
called <code>my-config</code> and we want to change a key named
<code>my-key</code>, we can use this command:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> patch configmap my-config <span class="at">-p</span> <span class="st">&#39;{&quot;data&quot;: {&quot;my-key&quot;: &quot;new-value&quot;}}&#39;</span></span></code></pre></div>
<h3 id="updating-a-secret-1">Updating a Secret</h3>
<p>We can also update a Secret using the <code>kubectl patch</code>
command. To change a key in a Secret named <code>my-secret</code>, we
write:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> patch secret my-secret <span class="at">-p</span> <span class="st">&#39;{&quot;data&quot;: {&quot;my-key&quot;: &quot;bmV3LXZhbHVl&quot;}}&#39;</span></span></code></pre></div>
<p>Remember, the value must be base64 encoded. We can encode a value
using this command in Linux or macOS:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-n</span> <span class="st">&#39;new-value&#39;</span> <span class="kw">|</span> <span class="fu">base64</span></span></code></pre></div>
<h3 id="use-case-example">Use Case Example</h3>
<p>For an example, suppose we have a ConfigMap that keeps application
settings. If we want to change the setting without affecting running
pods, we can run:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> patch configmap app-config <span class="at">-p</span> <span class="st">&#39;{&quot;data&quot;: {&quot;configKey&quot;: &quot;updatedValue&quot;}}&#39;</span></span></code></pre></div>
<h3 id="verifying-the-update">Verifying the Update</h3>
<p>After we run the patch command, we can check the changes by
describing the ConfigMap or Secret:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> describe configmap my-config</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> describe secret my-secret</span></code></pre></div>
<p>Using <code>kubectl patch</code> well helps us keep our applications
available while we make updates to configuration and secret management
in Kubernetes. For more details about ConfigMaps, we can check <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-configmaps-and-how-do-i-use-them.html">what
are Kubernetes ConfigMaps and how do I use them</a>.</p>
<h2
id="leveraging-helm-to-update-configmaps-and-secrets-safely">Leveraging
Helm to Update ConfigMaps and Secrets Safely</h2>
<p>Helm gives us a strong way to manage Kubernetes apps. This includes
ConfigMaps and Secrets. With Helm, we can update these resources safely
without deleting them. We just need to change our Helm chart and then do
a release upgrade.</p>
<h3 id="updating-configmaps-with-helm">Updating ConfigMaps with
Helm</h3>
<p>To update a ConfigMap using Helm, we need to do these steps:</p>
<ol type="1">
<li><p>Change your Helm chart’s <code>values.yaml</code> file to add new
ConfigMap data:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">configMap</span><span class="kw">:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">myConfig</span><span class="kw">:</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">key1</span><span class="kw">:</span><span class="at"> newValue1</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">key2</span><span class="kw">:</span><span class="at"> newValue2</span></span></code></pre></div></li>
<li><p>Update your ConfigMap template in the <code>templates</code>
folder:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}-my-config</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">key1</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.configMap.myConfig.key1 </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">key2</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.configMap.myConfig.key2 </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div></li>
<li><p>Upgrade your release to make the changes:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> upgrade my-release my-chart/</span></code></pre></div></li>
</ol>
<h3 id="updating-secrets-with-helm">Updating Secrets with Helm</h3>
<p>Updating Secrets is almost the same as updating ConfigMaps. Here is
how we do it:</p>
<ol type="1">
<li><p>Change your <code>values.yaml</code> file for the Secret:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">secret</span><span class="kw">:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">mySecret</span><span class="kw">:</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">password</span><span class="kw">:</span><span class="at"> newPassword</span></span></code></pre></div></li>
<li><p>Update your Secret template:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Secret</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}-my-secret</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">type</span><span class="kw">:</span><span class="at"> Opaque</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">password</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.secret.mySecret.password | b64enc | quote </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div></li>
<li><p>Upgrade your Helm release:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> upgrade my-release my-chart/</span></code></pre></div></li>
</ol>
<h3 id="best-practices">Best Practices</h3>
<ul>
<li>We should use <code>helm diff</code> plugin to see changes before we
upgrade.</li>
<li>Always back up existing Secrets and ConfigMaps. This helps to avoid
losing data.</li>
<li>Test updates in a staging environment first. Then we can apply
changes in production.</li>
</ul>
<p>By following these steps, we can use Helm to update Kubernetes
ConfigMaps and Secrets safely. This helps to keep our applications
running smoothly. For more details on managing app configuration in
Kubernetes, check out <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-manage-application-configuration-in-kubernetes.html">how
do I manage application configuration in Kubernetes</a>.</p>
<h2
id="utilizing-kustomize-for-updating-configmaps-and-secrets-in-kubernetes">Utilizing
Kustomize for Updating ConfigMaps and Secrets in Kubernetes</h2>
<p>Kustomize is a helpful tool that works with <code>kubectl</code>. It
lets us change Kubernetes objects without changing the original YAML
files. It allows us to layer configurations. So, we can update
Kubernetes ConfigMaps and Secrets without removing the old ones.</p>
<p>To update a ConfigMap or Secret using Kustomize, we can follow these
steps:</p>
<ol type="1">
<li><strong>Create a Base Configuration</strong>: First, we define the
base ConfigMap or Secret in a YAML file.</li>
</ol>
<div class="sourceCode" id="cb18"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># base/configmap.yaml</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-config</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">key1</span><span class="kw">:</span><span class="at"> value1</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">key2</span><span class="kw">:</span><span class="at"> value2</span></span></code></pre></div>
<ol start="2" type="1">
<li><strong>Create a Kustomization File</strong>: Next, in the same
folder, we make a file called <code>kustomization.yaml</code> that
points to the base configuration.</li>
</ol>
<div class="sourceCode" id="cb19"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># base/kustomization.yaml</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> configmap.yaml</span></span></code></pre></div>
<ol start="3" type="1">
<li><strong>Create an Overlay</strong>: For updates, we create a new
directory called overlay that extends the base configuration.</li>
</ol>
<div class="sourceCode" id="cb20"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># overlay/kustomization.yaml</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bases</span><span class="kw">:</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> ../base</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">patchesStrategicMerge</span><span class="kw">:</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> configmap-patch.yaml</span></span></code></pre></div>
<ol start="4" type="1">
<li><strong>Define the Patch</strong>: Now, we make a patch file in the
overlay directory. This file will change specific keys in the ConfigMap
or Secret.</li>
</ol>
<div class="sourceCode" id="cb21"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># overlay/configmap-patch.yaml</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-config</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">key1</span><span class="kw">:</span><span class="at"> updatedValue1</span></span></code></pre></div>
<ol start="5" type="1">
<li><strong>Apply the Overlay</strong>: Finally, we use Kustomize to
apply the overlay. This updates the existing ConfigMap without removing
it.</li>
</ol>
<div class="sourceCode" id="cb22"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-k</span> overlay/</span></code></pre></div>
<p>This command updates the ConfigMap <code>my-config</code> with the
new values we set in the patch. It keeps the existing configurations
safe.</p>
<p>Using Kustomize makes it easier to handle changes in configurations
in Kubernetes. It helps us to do organized and version-controlled
updates to ConfigMaps and Secrets. For more details about managing
application configurations in Kubernetes, check <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-manage-application-configuration-in-kubernetes.html">this
guide</a>.</p>
<h2
id="best-practices-for-updating-kubernetes-configmaps-and-secrets-without-deletion">Best
Practices for Updating Kubernetes ConfigMaps and Secrets Without
Deletion</h2>
<p>When we manage Kubernetes ConfigMaps and Secrets, it is important to
follow some best practices. This helps us update things smoothly without
deleting what we already have. Here are some easy strategies to
remember:</p>
<ol type="1">
<li><p><strong>Use <code>kubectl apply</code>:</strong> This command
lets us make changes to our ConfigMaps or Secrets without removing them.
We need to make sure our YAML files have the latest changes we want.</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> configmap.yaml</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> secret.yaml</span></code></pre></div></li>
<li><p><strong>Version Control:</strong> We should keep versioned YAML
files for ConfigMaps and Secrets. This helps us track changes and makes
it easy to go back if we need to.</p></li>
<li><p><strong>Use <code>kubectl patch</code>:</strong> If we need to
change a specific field in a ConfigMap or Secret, we can use the
<code>patch</code> command. This helps us avoid problems.</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> patch configmap my-config <span class="at">--patch</span> <span class="st">&#39;{&quot;data&quot;:{&quot;key&quot;:&quot;new-value&quot;}}&#39;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> patch secret my-secret <span class="at">--patch</span> <span class="st">&#39;{&quot;data&quot;:{&quot;password&quot;:&quot;new-password&quot;}}&#39;</span></span></code></pre></div></li>
<li><p><strong>Avoid Overwriting Secrets:</strong> When we update
Secrets, we must be careful not to overwrite sensitive data. We can use
the <code>--dry-run</code> option first to see what changes will
happen.</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> secret.yaml <span class="at">--dry-run</span><span class="op">=</span>client</span></code></pre></div></li>
<li><p><strong>Leverage Helm:</strong> We can use Helm to manage our
Kubernetes configurations. Helm templates help us make safe updates
without doing everything by hand.</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> upgrade my-release my-chart <span class="at">--set</span> config.key=new-value</span></code></pre></div></li>
<li><p><strong>Utilize Kustomize:</strong> Kustomize helps us create
overlays for different environments. This is good for managing updates
to ConfigMaps and Secrets without changing the main configurations.</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># kustomization.yaml</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> configmap.yaml</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> secret.yaml</span></span></code></pre></div></li>
<li><p><strong>Monitor Rollouts:</strong> We can use Kubernetes rollout
commands to check the status of deployments that depend on updated
ConfigMaps or Secrets.</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> rollout status deployment/my-deployment</span></code></pre></div></li>
<li><p><strong>Automate with CI/CD:</strong> We should add updates to
our CI/CD pipeline. This helps us automate changes to ConfigMaps and
Secrets in a controlled way.</p></li>
<li><p><strong>Regular Backups:</strong> We need to back up our
ConfigMaps and Secrets regularly. This way, we can quickly restore them
if something goes wrong during an update.</p></li>
<li><p><strong>Limit Permissions:</strong> We must use the least
privilege principle for access to ConfigMaps and Secrets. This means
only the necessary services and users can update them.</p></li>
</ol>
<p>By following these best practices, we can manage updates to
Kubernetes ConfigMaps and Secrets better. This helps us reduce risks of
deletion and data loss. For more details about managing configurations
in Kubernetes, we can check the article on <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-manage-application-configuration-in-kubernetes.html">how
to manage application configuration in Kubernetes</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3
id="how-do-we-update-a-configmap-or-secret-in-kubernetes-without-deleting-it">1.
How do we update a ConfigMap or Secret in Kubernetes without deleting
it?</h3>
<p>We can update a Kubernetes ConfigMap or Secret without deleting it by
using the <code>kubectl apply</code> command. This command helps us
change the existing resource by applying updates directly from a YAML
file. For example, we can run
<code>kubectl apply -f configmap.yaml</code> to update the ConfigMap
with our new values. This way, the existing resource stays the same
while we change its content.</p>
<h3
id="what-is-the-difference-between-kubectl-apply-and-kubectl-replace">2.
What is the difference between <code>kubectl apply</code> and
<code>kubectl replace</code>?</h3>
<p><code>kubectl apply</code> is for making updates in a smart way. We
can change some fields in a resource without removing the whole thing.
This makes it great for updating ConfigMaps and Secrets. But
<code>kubectl replace</code> will fully replace the existing resource
with a new one. This can cause data loss if we forget to add all fields.
So, for safe updates, we should use <code>kubectl apply</code>.</p>
<h3
id="can-we-use-helm-to-update-a-configmap-or-secret-in-kubernetes">3.
Can we use Helm to update a ConfigMap or Secret in Kubernetes?</h3>
<p>Yes, we can use Helm to update ConfigMaps and Secrets in Kubernetes
safely. Helm helps us manage our Kubernetes apps using charts. These
charts let us define and keep track of our resources. When we run
<code>helm upgrade</code>, Helm checks what we have now and compares it
with the new setup. Then, it applies the needed changes without deleting
the current resources. This is a good way to manage app settings.</p>
<h3 id="how-can-we-use-kubectl-patch-to-update-a-configmap-or-secret">4.
How can we use <code>kubectl patch</code> to update a ConfigMap or
Secret?</h3>
<p>We can use the <code>kubectl patch</code> command to update a
Kubernetes ConfigMap or Secret easily. This command lets us change
specific parts of the resource without needing to reapply everything.
For example, we can run:</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> patch configmap my-config <span class="at">--type</span><span class="op">=</span><span class="st">&#39;json&#39;</span> <span class="at">-p</span><span class="op">=</span><span class="st">&#39;[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/data/my-key&quot;, &quot;value&quot;: &quot;new-value&quot;}]&#39;</span></span></code></pre></div>
<p>This will change the specific key in the ConfigMap to a new value
while keeping the rest of the resource the same.</p>
<h3
id="what-are-the-best-practices-for-updating-kubernetes-configmaps-and-secrets">5.
What are the best practices for updating Kubernetes ConfigMaps and
Secrets?</h3>
<p>Some best practices for updating Kubernetes ConfigMaps and Secrets
are using <code>kubectl apply</code> for updates, using
<code>kubectl patch</code> for small changes, and using Helm for
version-controlled updates. Also, we should not hardcode sensitive info
in our manifests. Instead, we should use Kubernetes Secrets to manage
sensitive data securely. If we want to learn more about handling
sensitive data, we can check out <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-manage-secrets-in-kubernetes-securely.html">how
do we manage secrets in Kubernetes securely</a>.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            