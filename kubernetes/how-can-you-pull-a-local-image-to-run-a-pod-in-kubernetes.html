
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
            <!-- Google tag (gtag.js) -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
            <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-TFCQEJR7TD');
            </script>
            <meta charset="utf-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <!-- Common CSS & Icons -->
            <link rel="icon" href="/favicon.ico" type="image/x-icon">
            <link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
            <link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
            <link rel="stylesheet" href="/assets/css/post.css">
            <title>How Can You Pull a Local Image to Run a Pod in Kubernetes?</title>
            <meta name="description" content="Learn how to pull local images to run pods in Kubernetes efficiently. Master Kubernetes image management with our expert tips!">
            <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	        <script src="/assets/js/blog.js"></script>
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">How Can You Pull a Local Image to Run a Pod in Kubernetes?</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>To pull a local image to run a pod in Kubernetes, we can use the
Docker daemon. It helps us load local images straight into our
Kubernetes setup. This way, we do not need a remote container registry.
We can use images that are saved on our computer. This makes the
deployment process easier in a Kubernetes cluster.</p>
<p>In this article, we will look at different ways to use local images
in Kubernetes. We will talk about how to use the Docker daemon. We will
also see how to set up a local registry and use HostPath for image
links. We will learn how to make Kubernetes recognize local images.
Finally, we will run local images with Minikube. Each method will give
us useful tips and examples to improve our Kubernetes experience.</p>
<ul>
<li>How to Pull a Local Image to Run a Pod in Kubernetes?</li>
<li>How Can We Use Docker Daemon to Load Local Images in
Kubernetes?</li>
<li>How Can We Use a Local Registry to Access Images in Kubernetes?</li>
<li>How Can We Use HostPath to Reference Local Images in
Kubernetes?</li>
<li>How Can We Configure Kubernetes to Use a Local Image?</li>
<li>How Can We Use Minikube to Run Local Images in Kubernetes?</li>
<li>Frequently Asked Questions</li>
</ul>
<h2
id="how-can-we-use-docker-daemon-to-load-local-images-in-kubernetes">How
Can We Use Docker Daemon to Load Local Images in Kubernetes?</h2>
<p>To use local images in Kubernetes, we can use the Docker daemon to
load images directly into the container runtime that Kubernetes uses.
This is very helpful when we work with Minikube or Docker Desktop, where
Kubernetes runs on our local machine.</p>
<h3 id="loading-a-local-docker-image">Loading a Local Docker Image</h3>
<ol type="1">
<li><p><strong>Build your Docker image</strong>: First, we need to
create our Docker image using the Docker CLI:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> build <span class="at">-t</span> my-local-image:latest .</span></code></pre></div></li>
<li><p><strong>Load the image into the Docker daemon</strong>: If our
image is in a tar file, we can load it into the Docker daemon with this
command:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> load <span class="at">-i</span> my-local-image.tar</span></code></pre></div></li>
<li><p><strong>Verify the image is loaded</strong>: Next, we check if
the image is in the local Docker registry:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> images</span></code></pre></div></li>
<li><p><strong>Use the image in your Kubernetes Pod</strong>: Now, we
create a Kubernetes deployment or pod YAML file that uses our local
image. Here is an example of a deployment YAML:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-local-deployment</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-local-app</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-local-app</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-local-container</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-local-image:latest</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span></span></code></pre></div></li>
<li><p><strong>Apply the deployment</strong>: We use
<code>kubectl</code> to create the deployment in our Kubernetes
cluster:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> my-local-deployment.yaml</span></code></pre></div></li>
</ol>
<p>By following these steps, we can easily use Docker daemon to load
local images in our Kubernetes environment. This way helps us test and
develop without needing to push images to a remote container registry.
For more tips on local Kubernetes setups, we can check this article on
<a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-install-minikube-for-local-kubernetes-development.html">how
to set up Minikube for local Kubernetes development</a>.</p>
<h2
id="how-can-we-use-a-local-registry-to-access-images-in-kubernetes">How
Can We Use a Local Registry to Access Images in Kubernetes?</h2>
<p>To use a local registry for images in Kubernetes, we need to set up a
Docker Registry. Then we configure our Kubernetes cluster to get images
from it. Here is how we can do this:</p>
<ol type="1">
<li><p><strong>Install Docker Registry</strong>: We can run a local
Docker registry with this command:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-d</span> <span class="at">-p</span> 5000:5000 <span class="at">--restart</span><span class="op">=</span>always <span class="at">--name</span> registry registry:2</span></code></pre></div></li>
<li><p><strong>Tag and Push an Image to the Local Registry</strong>:
Let’s say we have a Docker image called <code>my-image</code>. We tag it
and push it to our local registry:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> tag my-image localhost:5000/my-image</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> push localhost:5000/my-image</span></code></pre></div></li>
<li><p><strong>Configure Kubernetes to Use the Local Registry</strong>:
We need to set up our Kubernetes pods to get images from our local
registry. We do this by defining the image in our pod specification:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Pod</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-pod</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-container</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">image</span><span class="kw">:</span><span class="at"> localhost:5000/my-image</span></span></code></pre></div></li>
<li><p><strong>Allow Insecure Registries (if needed)</strong>: If our
local registry is not using HTTPS, we might need to allow insecure
registries. We can do this by changing the Docker daemon settings. We
edit the <code>/etc/docker/daemon.json</code> file and add this:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;insecure-registries&quot;</span> <span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;localhost:5000&quot;</span><span class="ot">]</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>After that, we restart the Docker service:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl restart docker</span></code></pre></div></li>
<li><p><strong>Deploy the Pod</strong>: We use the
<code>kubectl apply</code> command to create the pod:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> pod.yaml</span></code></pre></div></li>
<li><p><strong>Verify Pod Status</strong>: We check if our pod is
running and pulling the image from the local registry:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get pods</span></code></pre></div></li>
</ol>
<p>Using a local registry helps us pull images faster and manage images
better in a development environment. For more details on Kubernetes and
local images, we can look at <a
href="https://bestonlinetutorial.com/kubernetes/how-can-i-use-local-docker-images-with-minikube-kubernetes.html">this
article</a>.</p>
<h2
id="how-can-you-use-hostpath-to-reference-local-images-in-kubernetes">How
Can You Use HostPath to Reference Local Images in Kubernetes?</h2>
<p>We can use the <code>HostPath</code> volume type in Kubernetes. This
helps to mount a directory or file from the host node’s filesystem into
our pod. With this, we can use local images that are stored on the
node.</p>
<p>Here is how we can set up a pod to use <code>HostPath</code> for
local images:</p>
<ol type="1">
<li><strong>Define the Pod Specification</strong>: First, we need to
create a YAML file for the pod. This file will say we want to use a
<code>HostPath</code> volume.</li>
</ol>
<div class="sourceCode" id="cb13"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Pod</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> hostpath-pod</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-container</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-local-image:latest</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">volumeMounts</span><span class="kw">:</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">mountPath</span><span class="kw">:</span><span class="at"> /usr/local/bin/my-local-image</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span><span class="at"> local-image</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> local-image</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">hostPath</span><span class="kw">:</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /path/on/host/to/image</span></span></code></pre></div>
<ol start="2" type="1">
<li><strong>Deploy the Pod</strong>: Next, we use <code>kubectl</code>
to create the pod with the configuration above.</li>
</ol>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> hostpath-pod.yaml</span></code></pre></div>
<ol start="3" type="1">
<li><strong>Access the Local Image</strong>: The local image will be
inside the pod at the <code>mountPath</code> we defined.</li>
</ol>
<h3 id="important-considerations">Important Considerations:</h3>
<ul>
<li>Make sure the path on the host node exists. It should have the files
or images we need.</li>
<li>The <code>HostPath</code> volume type does not work well for
multi-node clusters. The images are linked to the specific node’s
filesystem.</li>
<li>We should use <code>HostPath</code> carefully in production. It can
have security risks since it shows the host’s filesystem to the
pod.</li>
</ul>
<p>By using the <code>HostPath</code> volume, we can easily reference
and use local images stored on the node. This makes it easier to access
and manage local resources.</p>
<h2 id="how-can-we-configure-kubernetes-to-use-a-local-image">How Can We
Configure Kubernetes to Use a Local Image?</h2>
<p>To configure Kubernetes to use a local image, we need to make sure
that the Kubernetes nodes can access the local images on our Docker
daemon. Here are some ways to do this:</p>
<ol type="1">
<li><strong>Using the Docker Daemon:</strong>
<ul>
<li>If we build a local Docker image, we can reference it directly in
our pod or deployment YAML files. For example, if our image is named
<code>my-local-image:latest</code>, we can write it like this:</li>
</ul>
<div class="sourceCode" id="cb15"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Pod</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-local-pod</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-container</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-local-image:latest</span></span></code></pre></div>
<ul>
<li>We need to make sure the image is available on the node where the
pod runs.</li>
</ul></li>
<li><strong>Using Minikube:</strong>
<ul>
<li>If we use Minikube, we can build the image right in the Minikube
environment. We can use this command:</li>
</ul>
<div class="sourceCode" id="cb16"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="bu">eval</span> <span class="va">$(</span><span class="ex">minikube</span> docker-env<span class="va">)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> build <span class="at">-t</span> my-local-image:latest .</span></code></pre></div>
<ul>
<li>After we build the image, we can use it in our Kubernetes configs
like above.</li>
</ul></li>
<li><strong>Using a Local Registry:</strong>
<ul>
<li>We can set up a local Docker registry to push our images. We run
this command to create a local registry:</li>
</ul>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-d</span> <span class="at">-p</span> 5000:5000 <span class="at">--restart</span><span class="op">=</span>always <span class="at">--name</span> registry registry:2</span></code></pre></div>
<ul>
<li>Then we tag and push our image to this registry:</li>
</ul>
<div class="sourceCode" id="cb18"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> tag my-local-image:latest localhost:5000/my-local-image:latest</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> push localhost:5000/my-local-image:latest</span></code></pre></div>
<ul>
<li>We can reference the image in our Kubernetes configs with the full
registry path:</li>
</ul>
<div class="sourceCode" id="cb19"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span><span class="kw">:</span><span class="at"> localhost:5000/my-local-image:latest</span></span></code></pre></div></li>
<li><strong>Using HostPath Volume:</strong>
<ul>
<li>We can mount a local directory into our pod using a
<code>hostPath</code> volume. Here is an example:</li>
</ul>
<div class="sourceCode" id="cb20"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Pod</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-local-pod</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-container</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-local-image:latest</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">volumeMounts</span><span class="kw">:</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">mountPath</span><span class="kw">:</span><span class="at"> /path/in/container</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span><span class="at"> local-volume</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> local-volume</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">hostPath</span><span class="kw">:</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /path/on/host</span></span></code></pre></div>
<ul>
<li>We should replace <code>/path/on/host</code> with the real path on
the host where our images or files are.</li>
</ul></li>
<li><strong>Kubernetes ImagePullPolicy:</strong>
<ul>
<li>If we want Kubernetes to always use the latest image available
locally, we set the <code>imagePullPolicy</code> to <code>Never</code>
or <code>IfNotPresent</code> in our pod spec:</li>
</ul>
<div class="sourceCode" id="cb21"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-container</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-local-image:latest</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">imagePullPolicy</span><span class="kw">:</span><span class="at"> IfNotPresent</span></span></code></pre></div></li>
</ol>
<p>These ways will help us configure Kubernetes to use local images
well. This is very useful for development and testing environments. For
more details on managing images and deployments, we can check <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-use-kubernetes-for-machine-learning.html">how
to use Kubernetes for machine learning</a>.</p>
<h2 id="how-can-we-use-minikube-to-run-local-images-in-kubernetes">How
Can We Use Minikube to Run Local Images in Kubernetes?</h2>
<p>Minikube is a simple way to run Kubernetes clusters on our local
machine. It is great for testing and development. To use a local image
in Minikube, we can follow these steps:</p>
<ol type="1">
<li><p><strong>Start Minikube</strong>: First, we need to start
Minikube. If we have not done this yet, we can run the command
below:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="ex">minikube</span> start</span></code></pre></div></li>
<li><p><strong>Build the Docker Image</strong>: Next, we need to build
our Docker image. We must use the Docker daemon inside Minikube for
this. We can set our shell to use the Minikube Docker environment like
this:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="bu">eval</span> <span class="va">$(</span><span class="ex">minikube</span> docker-env<span class="va">)</span></span></code></pre></div>
<p>After that, we can build our Docker image:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> build <span class="at">-t</span> my-local-image:latest .</span></code></pre></div></li>
<li><p><strong>Create a Kubernetes Deployment</strong>: Once we build
the image, we can create a Kubernetes deployment with this local image.
We can use the YAML configuration below:</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-local-image:latest</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span></span></code></pre></div>
<p>We should save this configuration in a file called
<code>deployment.yaml</code>.</p></li>
<li><p><strong>Apply the Deployment</strong>: Now we can deploy the
application to our Minikube cluster. We can do this with the command
below:</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> deployment.yaml</span></code></pre></div></li>
<li><p><strong>Accessing the Application</strong>: To access the
application, we need to expose the deployment with this command:</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> expose deployment my-app <span class="at">--type</span><span class="op">=</span>NodePort <span class="at">--port</span><span class="op">=</span>8080</span></code></pre></div>
<p>Then we can get the URL to access our application by running:</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="ex">minikube</span> service my-app <span class="at">--url</span></span></code></pre></div></li>
</ol>
<p>Using Minikube to run local images in Kubernetes is a strong feature.
It helps us work fast during development. For more details on how to set
up Minikube, check out <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-install-minikube-for-local-kubernetes-development.html">how
do I install Minikube for local Kubernetes development</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3 id="how-can-we-pull-a-local-image-to-run-a-pod-in-kubernetes">1. How
can we pull a local image to run a pod in Kubernetes?</h3>
<p>To pull a local image for a pod in Kubernetes, we can use Docker
daemon. First, we load the image into the local Docker registry. After
that, Kubernetes can use this image when it creates pods. We must make
sure that our Kubernetes nodes can access the local image. This needs
the right settings in our YAML deployment files.</p>
<h3 id="can-we-use-minikube-to-run-local-images-in-kubernetes">2. Can we
use Minikube to run local images in Kubernetes?</h3>
<p>Yes, we can use Minikube for running local images in Kubernetes. We
can run the <code>minikube docker-env</code> command. This command helps
us set up our shell to use Minikube’s Docker daemon. Then we can build
and run local Docker images right in our Minikube. We do not need to
push them to a remote registry.</p>
<h3 id="what-is-the-best-way-to-reference-local-images-in-kubernetes">3.
What is the best way to reference local images in Kubernetes?</h3>
<p>The best way to reference local images in Kubernetes is by using a
local registry or the Docker daemon. When we load our images into the
local Docker daemon or push them to a local registry, we can easily pull
these images in our pod specifications. We need to make sure that our
image names in the deployment YAML match the ones in our local
environment.</p>
<h3 id="how-can-we-configure-kubernetes-to-use-a-local-image-1">4. How
can we configure Kubernetes to use a local image?</h3>
<p>To configure Kubernetes for a local image, we can specify the image
in our pod definition YAML file. We need to use the right name and tag.
If we use a local registry, we must check that the Kubernetes nodes can
access that registry. For local images on the Docker daemon, we simply
reference the image like any other image in Kubernetes.</p>
<h3
id="what-are-the-differences-between-using-a-local-registry-and-docker-daemon-for-local-images-in-kubernetes">5.
What are the differences between using a local registry and Docker
daemon for local images in Kubernetes?</h3>
<p>Using a local registry helps many Kubernetes nodes access the same
images. This means we do not have to duplicate images on each node. On
the other hand, using the Docker daemon needs us to load images directly
into the Docker environment on each node. Local registries can give us
better scalability and make it easier to manage images across a
cluster.</p>
<p>For more information on Kubernetes, we can check these articles: <a
href="https://bestonlinetutorial.com/kubernetes/what-is-kubernetes-and-how-does-it-simplify-container-management.html">What
is Kubernetes and How Does it Simplify Container Management?</a> and <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-install-minikube-for-local-kubernetes-development.html">How
Do I Install Minikube for Local Kubernetes Development?</a>.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            