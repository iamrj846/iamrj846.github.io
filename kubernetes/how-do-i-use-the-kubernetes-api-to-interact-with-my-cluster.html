
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TFCQEJR7TD');
</script>
            <title>How Do I Use the Kubernetes API to Interact with My Cluster?</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Common CSS & Icons -->
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
<link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
<link rel="stylesheet" href="/assets/css/post.css">
            <meta name="description" content="Learn how to effectively use the Kubernetes API to manage and interact with your cluster in this comprehensive guide.">

            <div id="head-placeholder"></div>
            <script src="/assets/js/blog.js" defer></script>
            <link rel="stylesheet" href="/assets/css/post.css">
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">How Do I Use the Kubernetes API to Interact with My Cluster?</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>The Kubernetes API is the main way we interact with Kubernetes
clusters. It lets us do things like create, update, and manage resources
in the cluster using code. With the Kubernetes API, we can automate
tasks, connect with other systems, and improve how we manage our
applications. This makes it a key tool for people working with
Kubernetes.</p>
<p>In this article, we will learn how to use the Kubernetes API to work
with our cluster. We will talk about important topics like why the
Kubernetes API matters, how to authenticate, common endpoints, listing
resources, and creating and updating resources. We will also look at
real-life examples, debugging tips, and tools that can help us with the
Kubernetes API. Here is a list of the headers we will discuss:</p>
<ul>
<li>How Can We Use the Kubernetes API to Interact with Our Cluster?</li>
<li>What is the Kubernetes API and Why is it Important?</li>
<li>How Do We Authenticate with the Kubernetes API?</li>
<li>What are the Common Endpoints in the Kubernetes API?</li>
<li>How Can We List Resources in Our Kubernetes Cluster?</li>
<li>How Do We Create and Update Resources using the Kubernetes API?</li>
<li>What are Some Real Life Use Cases for the Kubernetes API?</li>
<li>How Do We Debug and Troubleshoot API Interactions with
Kubernetes?</li>
<li>What Tools Can Help Us Work with the Kubernetes API?</li>
<li>Frequently Asked Questions</li>
</ul>
<p>For more information on Kubernetes and its features, we can check out
related articles like <a
href="https://bestonlinetutorial.com/kubernetes/what-is-kubernetes-and-how-does-it-simplify-container-management.html">What
is Kubernetes and How Does it Simplify Container Management?</a> and <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-use-kubernetes-labels-and-selectors.html">How
Do We Use Kubernetes Labels and Selectors?</a>.</p>
<h2 id="what-is-the-kubernetes-api-and-why-is-it-important">What is the
Kubernetes API and Why is it Important?</h2>
<p>The Kubernetes API is the main way that we and automated systems talk
to a Kubernetes cluster. It has a set of RESTful points that lets us
create, change, delete, and get resources in the cluster.</p>
<h3 id="importance-of-the-kubernetes-api">Importance of the Kubernetes
API:</h3>
<ol type="1">
<li><p><strong>Resource Management</strong>: The API helps us manage
different Kubernetes resources. These include Pods, Deployments,
Services, ConfigMaps, and more.</p></li>
<li><p><strong>Dynamic Control</strong>: It gives us dynamic control
over the cluster’s resources. We can do things like scale applications
or update them easily.</p></li>
<li><p><strong>Declarative Configuration</strong>: We can say what we
want the resources to look like. The Kubernetes control plane makes sure
that the actual state matches what we want. This helps keep the system
working as we want over time.</p></li>
<li><p><strong>Extensibility</strong>: The API can be extended. This
means we can build custom resources and controllers. This makes the
cluster more capable.</p></li>
<li><p><strong>Integration</strong>: It works well with many tools and
libraries. This includes kubectl, client libraries in different
programming languages, and CI/CD pipelines.</p></li>
</ol>
<h3 id="example-of-api-usage">Example of API Usage:</h3>
<p>To use the API, we usually use <code>kubectl</code> or a client
library. Here is an example of using <code>kubectl</code> to get info
about Pods in a namespace:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get pods <span class="at">-n</span> my-namespace</span></code></pre></div>
<p>We can also use curl to access the API directly:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-X</span> GET https://<span class="op">&lt;</span>KUBE_API_SERVER<span class="op">&gt;</span>/api/v1/pods <span class="at">-H</span> <span class="st">&quot;Authorization: Bearer &lt;YOUR_TOKEN&gt;&quot;</span></span></code></pre></div>
<p>In this example, we should replace
<code>&lt;KUBE_API_SERVER&gt;</code> with our API server’s address and
<code>&lt;YOUR_TOKEN&gt;</code> with a valid token for authentication.
This shows how the Kubernetes API is a strong tool to manage cluster
resources well.</p>
<h2 id="how-do-we-authenticate-with-the-kubernetes-api">How Do We
Authenticate with the Kubernetes API?</h2>
<p>Authentication with the Kubernetes API is very important for secure
connection with our cluster. Kubernetes has many ways to
authenticate:</p>
<ol type="1">
<li><p><strong>Bearer Token</strong>: This is a token we use to
authenticate our requests. The Kubernetes API server often creates this
token. You can find it in the service account tokens.</p>
<p>Here is an example of using a bearer token with
<code>curl</code>:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-k</span> <span class="at">-H</span> <span class="st">&quot;Authorization: Bearer &lt;your_token&gt;&quot;</span> https://<span class="op">&lt;</span>kubernetes_api_server<span class="op">&gt;</span>/api/v1/namespaces/default/pods</span></code></pre></div></li>
<li><p><strong>Client Certificates</strong>: We can set up Kubernetes to
accept client certificates for authentication. First, we need to create
a key and certificate. Then we put them in our kubeconfig file.</p>
<p>Here is an example of configuration in <code>kubeconfig</code>:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Config</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">clusters</span><span class="kw">:</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">cluster</span><span class="kw">:</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">server</span><span class="kw">:</span><span class="at"> https://&lt;kubernetes_api_server&gt;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">certificate-authority</span><span class="kw">:</span><span class="at"> /path/to/ca.crt</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-cluster</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">contexts</span><span class="kw">:</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">context</span><span class="kw">:</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">cluster</span><span class="kw">:</span><span class="at"> my-cluster</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">user</span><span class="kw">:</span><span class="at"> my-user</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-context</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">users</span><span class="kw">:</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-user</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">user</span><span class="kw">:</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">client-certificate</span><span class="kw">:</span><span class="at"> /path/to/client.crt</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">client-key</span><span class="kw">:</span><span class="at"> /path/to/client.key</span></span></code></pre></div></li>
<li><p><strong>Service Account</strong>: For apps running inside the
cluster, Kubernetes gives us service accounts. These have a bearer token
that is made automatically.</p>
<p>Here is how to use a service account token in a pod:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Pod</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-pod</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">namespace</span><span class="kw">:</span><span class="at"> default</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">serviceAccountName</span><span class="kw">:</span><span class="at"> my-service-account</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-container</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-image</span></span></code></pre></div></li>
<li><p><strong>OpenID Connect (OIDC)</strong>: Kubernetes can work with
external identity providers like Google or Azure using OIDC. We need to
set up the API server with the right flags.</p>
<p>Here is an example of API server flags:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--oidc-issuer-url=https://accounts.google.com</span> <span class="dt">\</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>--oidc-client-id=<span class="op">&lt;</span>client_id<span class="op">&gt;</span> <span class="dt">\</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>--oidc-username-claim=email <span class="dt">\</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>--oidc-groups-claim=groups</span></code></pre></div></li>
<li><p><strong>Basic Authentication</strong>: We do not recommend this
for production but it can be good for testing. We can set up basic auth
by giving a username and password in our kubeconfig.</p>
<p>Here is an example:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">users</span><span class="kw">:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-user</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">user</span><span class="kw">:</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">username</span><span class="kw">:</span><span class="at"> my_user</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">password</span><span class="kw">:</span><span class="at"> my_password</span></span></code></pre></div></li>
</ol>
<p>To always authenticate, we must make sure our kubeconfig file is set
up right with the correct credentials and context that fit our access
needs. We can check the current context with:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> config current-context</span></code></pre></div>
<p>For more information on how to work with the Kubernetes API, we can
check this resource: <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-interact-with-the-kubernetes-api.html">How
Do I Interact with the Kubernetes API?</a>.</p>
<h2 id="what-are-the-common-endpoints-in-the-kubernetes-api">What are
the Common Endpoints in the Kubernetes API?</h2>
<p>The Kubernetes API has many endpoints. These endpoints help us to
work with different resources in our cluster. We can reach these
endpoints using HTTP methods like GET, POST, PUT, and DELETE. Here we
will see some common endpoints we might use when working with the
Kubernetes API:</p>
<ol type="1">
<li><strong>Cluster Information</strong>
<ul>
<li><code>GET /api/v1</code>: This gives us information about the API
server and what resources are available.</li>
</ul></li>
<li><strong>Pods</strong>
<ul>
<li><code>GET /api/v1/pods</code>: This lists all the pods in the
cluster.</li>
<li><code>POST /api/v1/namespaces/{namespace}/pods</code>: This creates
a new pod in the namespace we choose.</li>
<li><code>GET /api/v1/namespaces/{namespace}/pods/{name}</code>: This
gets details about a specific pod.</li>
<li><code>DELETE /api/v1/namespaces/{namespace}/pods/{name}</code>: This
deletes a specific pod.</li>
</ul></li>
<li><strong>Services</strong>
<ul>
<li><code>GET /api/v1/services</code>: This lists all services in the
cluster.</li>
<li><code>POST /api/v1/namespaces/{namespace}/services</code>: This
makes a new service in the namespace we choose.</li>
<li><code>GET /api/v1/namespaces/{namespace}/services/{name}</code>:
This gets details about a specific service.</li>
<li><code>DELETE /api/v1/namespaces/{namespace}/services/{name}</code>:
This deletes a specific service.</li>
</ul></li>
<li><strong>Namespaces</strong>
<ul>
<li><code>GET /api/v1/namespaces</code>: This lists all namespaces in
the cluster.</li>
<li><code>POST /api/v1/namespaces</code>: This creates a new
namespace.</li>
<li><code>GET /api/v1/namespaces/{name}</code>: This gets details about
a specific namespace.</li>
<li><code>DELETE /api/v1/namespaces/{name}</code>: This deletes a
specific namespace.</li>
</ul></li>
<li><strong>Deployments</strong>
<ul>
<li><code>GET /apis/apps/v1/deployments</code>: This lists all
deployments.</li>
<li><code>POST /apis/apps/v1/namespaces/{namespace}/deployments</code>:
This creates a new deployment in the namespace we want.</li>
<li><code>GET /apis/apps/v1/namespaces/{namespace}/deployments/{name}</code>:
This gets a specific deployment.</li>
<li><code>DELETE /apis/apps/v1/namespaces/{namespace}/deployments/{name}</code>:
This deletes a specific deployment.</li>
</ul></li>
<li><strong>ConfigMaps</strong>
<ul>
<li><code>GET /api/v1/namespaces/{namespace}/configmaps</code>: This
lists all ConfigMaps in the namespace we want.</li>
<li><code>POST /api/v1/namespaces/{namespace}/configmaps</code>: This
creates a new ConfigMap in the namespace we choose.</li>
<li><code>GET /api/v1/namespaces/{namespace}/configmaps/{name}</code>:
This gets a specific ConfigMap.</li>
<li><code>DELETE /api/v1/namespaces/{namespace}/configmaps/{name}</code>:
This deletes a specific ConfigMap.</li>
</ul></li>
<li><strong>Secrets</strong>
<ul>
<li><code>GET /api/v1/namespaces/{namespace}/secrets</code>: This lists
all secrets in the namespace we choose.</li>
<li><code>POST /api/v1/namespaces/{namespace}/secrets</code>: This
creates a new secret in the namespace we want.</li>
<li><code>GET /api/v1/namespaces/{namespace}/secrets/{name}</code>: This
gets a specific secret.</li>
<li><code>DELETE /api/v1/namespaces/{namespace}/secrets/{name}</code>:
This deletes a specific secret.</li>
</ul></li>
</ol>
<p>To work with these endpoints, we can use tools like <code>curl</code>
or client libraries for languages like Go, Python, and JavaScript. For
example, to list pods in a namespace using <code>curl</code>, we can do
it like this:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-X</span> GET https://<span class="op">&lt;</span>k8s-api-server<span class="op">&gt;</span>/api/v1/namespaces/<span class="op">&lt;</span>namespace<span class="op">&gt;</span>/pods <span class="dt">\</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">-H</span> <span class="st">&quot;Authorization: Bearer &lt;your-token&gt;&quot;</span> <span class="dt">\</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">-H</span> <span class="st">&quot;Accept: application/json&quot;</span></span></code></pre></div>
<p>We need to change <code>&lt;k8s-api-server&gt;</code>,
<code>&lt;namespace&gt;</code>, and <code>&lt;your-token&gt;</code> to
our real Kubernetes API server address, the namespace we want, and our
authentication token. Knowing these common endpoints helps us to use the
Kubernetes API better and manage our cluster well. For more details on
how to work with the Kubernetes API, we can check <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-interact-with-the-kubernetes-api.html">this
guide on how to interact with the Kubernetes API</a>.</p>
<h2 id="how-can-we-list-resources-in-our-kubernetes-cluster">How Can We
List Resources in Our Kubernetes Cluster?</h2>
<p>We can list resources in our Kubernetes cluster by using the
<code>kubectl</code> command-line tool. This tool helps us to interact
with our cluster. Below, we share some common commands to list different
types of resources.</p>
<h3 id="list-pods">List Pods</h3>
<p>To list all pods in the default namespace, we use:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get pods</span></code></pre></div>
<p>If we want to list pods in a specific namespace, we write:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get pods <span class="at">-n</span> <span class="op">&lt;</span>namespace<span class="op">&gt;</span></span></code></pre></div>
<h3 id="list-deployments">List Deployments</h3>
<p>To see all deployments in the default namespace, we type:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get deployments</span></code></pre></div>
<p>For deployments in a specific namespace, we can do:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get deployments <span class="at">-n</span> <span class="op">&lt;</span>namespace<span class="op">&gt;</span></span></code></pre></div>
<h3 id="list-services">List Services</h3>
<p>To find all services in the default namespace, we run:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get services</span></code></pre></div>
<p>If we want services in a specific namespace, we use:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get services <span class="at">-n</span> <span class="op">&lt;</span>namespace<span class="op">&gt;</span></span></code></pre></div>
<h3 id="list-nodes">List Nodes</h3>
<p>To see all nodes in our cluster, we can type:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get nodes</span></code></pre></div>
<h3 id="list-namespaces">List Namespaces</h3>
<p>To list all namespaces, we use:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get namespaces</span></code></pre></div>
<h3 id="list-configmaps">List ConfigMaps</h3>
<p>To check all ConfigMaps in the default namespace, we run:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get configmaps</span></code></pre></div>
<p>For ConfigMaps in a specific namespace, we can write:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get configmaps <span class="at">-n</span> <span class="op">&lt;</span>namespace<span class="op">&gt;</span></span></code></pre></div>
<h3 id="list-secrets">List Secrets</h3>
<p>To view all secrets in the default namespace, we type:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get secrets</span></code></pre></div>
<p>If we need secrets in a specific namespace, we can do:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get secrets <span class="at">-n</span> <span class="op">&lt;</span>namespace<span class="op">&gt;</span></span></code></pre></div>
<h3 id="list-resource-types-with-labels">List Resource Types with
Labels</h3>
<p>We can also filter resources by labels. For example:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get pods <span class="at">-l</span> <span class="op">&lt;</span>label-key<span class="op">&gt;</span>=<span class="op">&lt;</span>label-value<span class="op">&gt;</span></span></code></pre></div>
<h3 id="describe-resources">Describe Resources</h3>
<p>To get detailed info about a specific resource, we use:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> describe <span class="op">&lt;</span>resource-type<span class="op">&gt;</span> <span class="op">&lt;</span>resource-name<span class="op">&gt;</span></span></code></pre></div>
<h3 id="get-all-resources">Get All Resources</h3>
<p>To see a summary of all resources in the current namespace, we can
type:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get all</span></code></pre></div>
<p>With these commands, we can list and manage the resources in our
Kubernetes cluster. This way, we have a clear view of the different
parts that make up our environment. For more advanced things and custom
queries, we can explore the Kubernetes API or use tools like
<code>kubectl</code> with JSONPath or custom columns for output.</p>
<h2
id="how-do-we-create-and-update-resources-using-the-kubernetes-api">How
Do We Create and Update Resources using the Kubernetes API?</h2>
<p>To create and update resources in Kubernetes using the API, we send
HTTP requests to the Kubernetes API server. We often work with resources
like Pods, Deployments, Services, and ConfigMaps. Here are the steps and
examples for creating and updating these resources.</p>
<h3 id="creating-resources">Creating Resources</h3>
<ol type="1">
<li><p><strong>Create a Pod</strong></p>
<p>To create a Pod, we send a POST request to the
<code>/api/v1/namespaces/{namespace}/pods</code> endpoint. We need to
include the Pod manifest in the request body.</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-X</span> POST <span class="dt">\</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>-H <span class="st">&quot;Content-Type: application/json&quot;</span> <span class="dt">\</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>--data <span class="st">&#39;{</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;apiVersion&quot;: &quot;v1&quot;,</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;kind&quot;: &quot;Pod&quot;,</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;metadata&quot;: {</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;name&quot;: &quot;my-pod&quot;,</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;namespace&quot;: &quot;default&quot;</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="st">  },</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;spec&quot;: {</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;containers&quot;: [{</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;name&quot;: &quot;nginx&quot;,</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;image&quot;: &quot;nginx&quot;</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="st">    }]</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span> <span class="dt">\</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>http://<span class="op">&lt;</span>kubernetes-api-server<span class="op">&gt;</span>:<span class="op">&lt;</span>port<span class="op">&gt;</span>/api/v1/namespaces/default/pods</span></code></pre></div></li>
<li><p><strong>Create a Deployment</strong></p>
<p>To create a Deployment, we use the
<code>/apis/apps/v1/namespaces/{namespace}/deployments</code>
endpoint.</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-X</span> POST <span class="dt">\</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>-H <span class="st">&quot;Content-Type: application/json&quot;</span> <span class="dt">\</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>--data <span class="st">&#39;{</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;apiVersion&quot;: &quot;apps/v1&quot;,</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;kind&quot;: &quot;Deployment&quot;,</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;metadata&quot;: {</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;name&quot;: &quot;my-deployment&quot;,</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;namespace&quot;: &quot;default&quot;</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="st">  },</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;spec&quot;: {</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;replicas&quot;: 1,</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;selector&quot;: {</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;matchLabels&quot;: {</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;app&quot;: &quot;nginx&quot;</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="st">    },</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;template&quot;: {</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;metadata&quot;: {</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;labels&quot;: {</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="st">          &quot;app&quot;: &quot;nginx&quot;</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="st">      },</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;spec&quot;: {</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;containers&quot;: [{</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="st">          &quot;name&quot;: &quot;nginx&quot;,</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="st">          &quot;image&quot;: &quot;nginx&quot;</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="st">        }]</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span> <span class="dt">\</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>http://<span class="op">&lt;</span>kubernetes-api-server<span class="op">&gt;</span>:<span class="op">&lt;</span>port<span class="op">&gt;</span>/apis/apps/v1/namespaces/default/deployments</span></code></pre></div></li>
</ol>
<h3 id="updating-resources">Updating Resources</h3>
<ol type="1">
<li><p><strong>Update a Pod</strong></p>
<p>To update a Pod, we send a PATCH request to the
<code>/api/v1/namespaces/{namespace}/pods/{name}</code> endpoint. For
example, to change the image of a container in a Pod:</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-X</span> PATCH <span class="dt">\</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>-H <span class="st">&quot;Content-Type: application/json-patch+json&quot;</span> <span class="dt">\</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>--data <span class="st">&#39;[{</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;op&quot;: &quot;replace&quot;,</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;path&quot;: &quot;/spec/containers/0/image&quot;,</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;value&quot;: &quot;nginx:latest&quot;</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="st">}]&#39;</span> <span class="dt">\</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>http://<span class="op">&lt;</span>kubernetes-api-server<span class="op">&gt;</span>:<span class="op">&lt;</span>port<span class="op">&gt;</span>/api/v1/namespaces/default/pods/my-pod</span></code></pre></div></li>
<li><p><strong>Update a Deployment</strong></p>
<p>To update a Deployment, we use the PATCH method with the
<code>/apis/apps/v1/namespaces/{namespace}/deployments/{name}</code>
endpoint. For example, to update the number of replicas:</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-X</span> PATCH <span class="dt">\</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>-H <span class="st">&quot;Content-Type: application/json-patch+json&quot;</span> <span class="dt">\</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>--data <span class="st">&#39;[{</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;op&quot;: &quot;replace&quot;,</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;path&quot;: &quot;/spec/replicas&quot;,</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;value&quot;: 3</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="st">}]&#39;</span> <span class="dt">\</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>http://<span class="op">&lt;</span>kubernetes-api-server<span class="op">&gt;</span>:<span class="op">&lt;</span>port<span class="op">&gt;</span>/apis/apps/v1/namespaces/default/deployments/my-deployment</span></code></pre></div></li>
</ol>
<h3 id="notes">Notes</h3>
<ul>
<li>We must make sure we have the right permissions to create and update
resources in our Kubernetes cluster.</li>
<li>We can use tools like <code>kubectl</code> for easier work with the
Kubernetes API. For example,
<code>kubectl apply -f &lt;file&gt;.yaml</code> lets us create or update
resources that are defined in a YAML file.</li>
<li>For more information on working with the Kubernetes API, see <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-interact-with-the-kubernetes-api.html">How
Do I Interact with the Kubernetes API</a>.</li>
</ul>
<h2 id="what-are-some-real-life-use-cases-for-the-kubernetes-api">What
are Some Real Life Use Cases for the Kubernetes API?</h2>
<p>We can use the Kubernetes API to help developers and operators work
with their Kubernetes clusters. Here are some simple use cases for the
Kubernetes API:</p>
<ol type="1">
<li><p><strong>Automated Deployment</strong>: Many companies use
Continuous Integration/Continuous Deployment (CI/CD) pipelines to make
app deployments easier. With the Kubernetes API, tools like Jenkins or
GitHub Actions can connect to the cluster to deploy new app versions.
For example, our CI/CD script can use the Kubernetes client like
this:</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> deployment.yaml</span></code></pre></div></li>
<li><p><strong>Monitoring and Logging</strong>: We can use monitoring
tools like Prometheus with the Kubernetes API to gather metrics from
pods and nodes. This gives us real-time information about how our
applications perform.</p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> monitoring.coreos.com/v1</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ServiceMonitor</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-service-monitor</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">endpoints</span><span class="kw">:</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> metrics</span></span></code></pre></div></li>
<li><p><strong>Scaling Applications</strong>: Applications can grow or
shrink automatically based on demand. We use the Horizontal Pod
Autoscaler (HPA) which works with the Kubernetes API to change the
number of replicas.</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> autoscaling/v2beta2</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> HorizontalPodAutoscaler</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app-hpa</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">scaleTargetRef</span><span class="kw">:</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">minReplicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">maxReplicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">10</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">metrics</span><span class="kw">:</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Resource</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">resource</span><span class="kw">:</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span><span class="at"> cpu</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">target</span><span class="kw">:</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Utilization</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">averageUtilization</span><span class="kw">:</span><span class="at"> </span><span class="dv">50</span></span></code></pre></div></li>
<li><p><strong>Custom Resource Management</strong>: We can create custom
resources and controllers to add more features to Kubernetes. The
Kubernetes API lets us manage these resources just like normal
Kubernetes objects. For example, we can define a Custom Resource
Definition (CRD):</p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apiextensions.k8s.io/v1</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> CustomResourceDefinition</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> myresources.mycompany.com</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">group</span><span class="kw">:</span><span class="at"> mycompany.com</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">versions</span><span class="kw">:</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">served</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">storage</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">scope</span><span class="kw">:</span><span class="at"> Namespaced</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">names</span><span class="kw">:</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">plural</span><span class="kw">:</span><span class="at"> myresources</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">singular</span><span class="kw">:</span><span class="at"> myresource</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">kind</span><span class="kw">:</span><span class="at"> MyResource</span></span></code></pre></div></li>
<li><p><strong>Service Discovery and Load Balancing</strong>: The
Kubernetes API helps us create services that other applications in the
cluster can find. For example, we can define a service to show an
application:</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app-service</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TCP</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span></span></code></pre></div></li>
<li><p><strong>Configuration Management</strong>: With ConfigMaps and
Secrets, applications can get configuration data when they need it. The
Kubernetes API helps us create and manage these resources. This keeps
our applications flexible and easy to maintain.</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> app-config</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">  config.json</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>      &quot;key&quot;: &quot;value&quot;</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div></li>
<li><p><strong>Integration with Other Services</strong>: We can use the
Kubernetes API to connect with outside services like databases or
third-party APIs. For example, we can create a Kubernetes job to make
backups by using an outside API.</p></li>
<li><p><strong>Interactive Management</strong>: Tools like kubectl and
the Kubernetes Dashboard use the Kubernetes API to give us interactive
management options. This lets us see resources, logs, and events right
away.</p></li>
</ol>
<p>For more details on using the Kubernetes API, we can check articles
like <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-interact-with-the-kubernetes-api.html">How
Do I Interact with the Kubernetes API</a>. This will help us understand
the API’s features and how we can use them in different situations.</p>
<h2
id="how-do-we-debug-and-troubleshoot-api-interactions-with-kubernetes">How
Do We Debug and Troubleshoot API Interactions with Kubernetes?</h2>
<p>Debugging and troubleshooting API interactions with Kubernetes is
important for keeping our cluster healthy and running well. Here are
some simple steps and tools we can use to debug API interactions:</p>
<ol type="1">
<li><p><strong>Check API Server Logs</strong>: The API server logs give
us information about requests and any errors that happen. We can check
the logs like this:</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> logs <span class="at">-n</span> kube-system kube-apiserver-<span class="op">&lt;</span>node-name<span class="op">&gt;</span></span></code></pre></div></li>
<li><p><strong>Use <code>kubectl</code> with Verbose Output</strong>:
The <code>kubectl</code> command helps us see more details about the API
requests. We can increase verbosity with this command:</p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get pods <span class="at">--v</span><span class="op">=</span>8</span></code></pre></div></li>
<li><p><strong>Inspect Resource Status</strong>: We can use this command
to get detailed info about any Kubernetes resource. This helps us find
issues with resources.</p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> describe <span class="op">&lt;</span>resource_type<span class="op">&gt;</span> <span class="op">&lt;</span>resource_name<span class="op">&gt;</span></span></code></pre></div></li>
<li><p><strong>Check Events</strong>: Kubernetes saves events for
resources. These can help us troubleshoot problems.</p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get events <span class="at">--sort-by</span><span class="op">=</span>.metadata.creationTimestamp</span></code></pre></div></li>
<li><p><strong>API Resource Validation</strong>: We should check our API
resource definitions against the Kubernetes rules. We can use
<code>kubectl explain</code> for this. It helps us make sure our YAML
files are correct.</p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> explain <span class="op">&lt;</span>resource_type<span class="op">&gt;</span></span></code></pre></div></li>
<li><p><strong>Use <code>curl</code> for Direct API Calls</strong>: We
can make direct API calls to the Kubernetes API server. This lets us see
the raw responses:</p>
<div class="sourceCode" id="cb40"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-k</span> https://<span class="op">&lt;</span>kubernetes-api-server<span class="op">&gt;</span>/api/v1/pods <span class="at">--header</span> <span class="st">&quot;Authorization: Bearer &lt;your-token&gt;&quot;</span></span></code></pre></div></li>
<li><p><strong>Network Policies and Access Restrictions</strong>: We
need to check if there are any network policies or RBAC problems
stopping access to the API. We can look at our RBAC settings with:</p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get clusterrolebindings</span></code></pre></div></li>
<li><p><strong>Check Cluster Health</strong>: We can use the
<code>kubectl cluster-info</code> command to make sure the cluster is
healthy and all parts are working.</p></li>
<li><p><strong>Monitor Resource Usage</strong>: We should keep an eye on
resource usage. This helps us see if resource limits cause problems.
Tools like Prometheus and Grafana help us see resource use.</p></li>
<li><p><strong>Use Debug Containers</strong>: We can create a debug pod
with a shell. This lets us check the environment and network
settings.</p>
<div class="sourceCode" id="cb42"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> run debug <span class="at">--image</span><span class="op">=</span>busybox <span class="at">-it</span> <span class="at">--</span> sh</span></code></pre></div></li>
<li><p><strong>Check API Versions</strong>: We must make sure we are
using the right API version for the resources we are working with. We
can list available API versions like this:</p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> api-versions</span></code></pre></div></li>
</ol>
<p>By using these steps, we can debug and troubleshoot our interactions
with the Kubernetes API. This helps keep things running smoothly in our
cluster. For more help on Kubernetes API interactions, we can read <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-interact-with-the-kubernetes-api.html">how
to interact with the Kubernetes API</a>.</p>
<h2 id="what-tools-can-help-us-work-with-the-kubernetes-api">What Tools
Can Help Us Work with the Kubernetes API?</h2>
<p>To work well with the Kubernetes API, we can use many tools. These
tools help us manage resources, debug issues, and automate tasks. Here
are some important tools we can use:</p>
<ol type="1">
<li><strong>kubectl</strong>: This is the command-line tool we use to
talk to the Kubernetes API.
<ul>
<li><p>We can install kubectl from the Kubernetes website.</p></li>
<li><p>To get info about the cluster, we can run this command:</p>
<div class="sourceCode" id="cb44"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> cluster-info</span></code></pre></div></li>
<li><p>We can also check the pods by using:</p>
<div class="sourceCode" id="cb45"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get pods</span></code></pre></div></li>
</ul></li>
<li><strong>Postman</strong>: This is a strong tool for testing APIs. We
can set it up to send requests to the Kubernetes API endpoints.
<ul>
<li>To start a new request, we can use the API endpoint, like
<code>https://&lt;your-cluster-ip&gt;:6443/api/v1/pods</code>.</li>
<li>We have to add the right authentication headers, for example, the
Bearer token.</li>
</ul></li>
<li><strong>Kubernetes Dashboard</strong>: This is a web-based UI that
helps us manage Kubernetes applications.
<ul>
<li><p>We can access it with:</p>
<div class="sourceCode" id="cb46"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> proxy</span></code></pre></div></li>
<li><p>Then we go to
<code>http://localhost:8001/api/v1/namespaces/kube-system/services/https:kubernetes-dashboard:/proxy/</code>.</p></li>
</ul></li>
<li><strong>Helm</strong>: This is a package manager for Kubernetes. It
makes it easier to deploy applications.
<ul>
<li><p>We install Helm and run commands like:</p>
<div class="sourceCode" id="cb47"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> repo add stable https://charts.helm.sh/stable</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install my-release stable/nginx</span></code></pre></div></li>
</ul></li>
<li><strong>K9s</strong>: This is a terminal-based UI for managing
Kubernetes clusters.
<ul>
<li><p>We just install it and run:</p>
<div class="sourceCode" id="cb48"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="ex">k9s</span></span></code></pre></div></li>
</ul></li>
<li><strong>Lens</strong>: This is an integrated development environment
(IDE) for Kubernetes. It gives us a graphical interface to manage
clusters.
<ul>
<li>We can download and install Lens, then connect it to our
cluster.</li>
</ul></li>
<li><strong>kube-ops-view</strong>: This is a web app to monitor
Kubernetes clusters. It helps us see the status of different resources.
<ul>
<li><p>We can deploy it using:</p>
<div class="sourceCode" id="cb49"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> https://raw.githubusercontent.com/louislam/uptime-kuma/master/docker/docker-compose.yml</span></code></pre></div></li>
</ul></li>
<li><strong>Terraform</strong>: This is an infrastructure as code tool.
We can use it to manage Kubernetes resources.
<ul>
<li><p>Here is an example configuration:</p>
<pre class="hcl"><code>provider &quot;kubernetes&quot; {
  config_path = &quot;~/.kube/config&quot;
}
resource &quot;kubernetes_deployment&quot; &quot;example&quot; {
  metadata {
    name = &quot;nginx&quot;
    labels = {
      App = &quot;nginx&quot;
    }
  }
  spec {
    replicas = 2
    selector {
      match_labels = {
        App = &quot;nginx&quot;
      }
    }
    template {
      metadata {
        labels = {
          App = &quot;nginx&quot;
        }
      }
      spec {
        container {
          name  = &quot;nginx&quot;
          image = &quot;nginx:1.14.2&quot;
        }
      }
    }
  }
}</code></pre></li>
</ul></li>
<li><strong>Kustomize</strong>: This tool helps us customize Kubernetes
YAML files. It makes it easier to manage different environments.
<ul>
<li><p>We can create a <code>kustomization.yaml</code> file like
this:</p>
<div class="sourceCode" id="cb51"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> deployment.yaml</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> service.yaml</span></span></code></pre></div></li>
</ul></li>
<li><strong>OpenAPI/Swagger</strong>: We can use Swagger UI to see and
interact with the Kubernetes API. This makes it easier to test and
explore endpoints.</li>
</ol>
<p>These tools help us work better with the Kubernetes API. They make it
simpler to deploy, manage, and fix applications in our cluster. For more
insight into the Kubernetes API, we can check <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-interact-with-the-kubernetes-api.html">this
resource</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3 id="what-is-the-kubernetes-api-used-for">What is the Kubernetes API
used for?</h3>
<p>We use the Kubernetes API to connect with our Kubernetes cluster. It
helps us manage resources like pods, services, and deployments. We can
create, update, and control these resources easily. Knowing how to use
the Kubernetes API well is important for automating tasks and working
with CI/CD pipelines.</p>
<h3 id="how-do-i-authenticate-with-the-kubernetes-api">How do I
authenticate with the Kubernetes API?</h3>
<p>We can authenticate with the Kubernetes API in different ways. We can
use certificates, bearer tokens, or connect with external providers like
OpenID Connect. It is important to set up authentication correctly. This
will make sure our access to Kubernetes resources is safe. For more
details about setting up authentication, check our article on <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-authenticate-with-the-kubernetes-api.html">how
to authenticate with the Kubernetes API</a>.</p>
<h3 id="what-are-some-common-kubernetes-api-endpoints">What are some
common Kubernetes API endpoints?</h3>
<p>Some common Kubernetes API endpoints are <code>/api/v1/pods</code>,
<code>/api/v1/services</code>, and
<code>/apis/apps/v1/deployments</code>. These endpoints let us work with
different resources in the cluster. The Kubernetes API uses REST, so
understanding these endpoints is important for managing resources and
automating tasks.</p>
<h3
id="how-can-i-list-resources-in-my-kubernetes-cluster-using-the-api">How
can I list resources in my Kubernetes cluster using the API?</h3>
<p>To list resources in our Kubernetes cluster, we can make a GET
request to the right endpoint. For example, we use
<code>/api/v1/pods</code> for pods and <code>/api/v1/services</code> for
services. We can use tools like <code>curl</code> or HTTP clients in
languages like Python or Go. For more info on listing resources, check
our guide on <a
href="https://bestonlinetutorial.com/kubernetes/how-can-i-list-resources-in-my-kubernetes-cluster.html">how
to list resources in a Kubernetes cluster</a>.</p>
<h3 id="what-tools-can-i-use-to-interact-with-the-kubernetes-api">What
tools can I use to interact with the Kubernetes API?</h3>
<p>We can use many tools to interact with the Kubernetes API. Some of
them are <code>kubectl</code>, Postman, and custom scripts in languages
like Python or Go. These tools help us work better and automate tasks in
our Kubernetes cluster. For more info on important tools, please visit
our article on <a
href="https://bestonlinetutorial.com/kubernetes/what-tools-are-essential-for-kubernetes-development.html">what
tools are essential for Kubernetes development</a>.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            