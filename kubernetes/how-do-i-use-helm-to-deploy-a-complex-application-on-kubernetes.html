
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TFCQEJR7TD');
</script>
            <title>How Do I Use Helm to Deploy a Complex Application on Kubernetes?</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "BestOnlineTutorial",
      "url": "https://www.bestonlinetutorial.com/"
    }
    </script>

<!-- Common CSS & Icons -->
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
<link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
<link rel="stylesheet" href="/assets/css/post.css">
            <meta name="description" content="Learn how to use Helm for deploying complex applications on Kubernetes. Step-by-step guide for seamless deployment and management!">

            <div id="head-placeholder"></div>
            <script src="/assets/js/blog.js" defer></script>
            <link rel="stylesheet" href="/assets/css/post.css">
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">How Do I Use Helm to Deploy a Complex Application on Kubernetes?</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>Helm is a strong package manager for Kubernetes. It helps us deploy
complex applications easily. With Helm, we can define, install, and
manage applications using Helm Charts. Helm makes it simple to deploy
and manage Kubernetes applications. It helps us handle dependencies,
configurations, and updates. These tasks can be hard in a Kubernetes
environment.</p>
<p>In this article, we will look at how to use Helm to deploy complex
applications on Kubernetes. We will talk about what Helm is and why it
is good for Kubernetes deployments. We will also guide you on how to
install Helm on your local machine. We will explain Helm Charts and how
they work. We will show you how to create custom Helm Charts. We will
share best practices for structuring these charts. We will discuss how
to manage configurations and secrets. We will explore real-world uses
for Helm. Finally, we will explain how to upgrade and rollback
applications easily.</p>
<ul>
<li>How Can We Use Helm for Deploying Complex Applications on
Kubernetes?</li>
<li>What is Helm and Why Should We Use It for Kubernetes
Deployments?</li>
<li>How Can We Install Helm on Our Local Machine?</li>
<li>What Are Helm Charts and How Do They Work?</li>
<li>How Can We Create a Custom Helm Chart for Our Application?</li>
<li>What Are the Best Practices for Structuring Helm Charts?</li>
<li>How Can We Manage Configurations and Secrets with Helm?</li>
<li>What Are Real-World Use Cases for Using Helm in Kubernetes?</li>
<li>How Can We Upgrade and Rollback Applications with Helm?</li>
<li>Frequently Asked Questions</li>
</ul>
<p>For more details on Kubernetes and its parts, check this article on
<a
href="https://bestonlinetutorial.com/kubernetes/what-is-kubernetes-and-how-does-it-simplify-container-management.html">what
is Kubernetes and how it simplifies container management</a>.</p>
<h2 id="what-is-helm-and-why-use-it-for-kubernetes-deployments">What is
Helm and Why Use It for Kubernetes Deployments?</h2>
<p>Helm is a helpful tool for managing packages in Kubernetes. It makes
it easier to deploy and manage applications on Kubernetes clusters. With
Helm, we can define, install, and upgrade even complex Kubernetes
applications using simple commands.</p>
<h3 id="key-features-of-helm">Key Features of Helm:</h3>
<ul>
<li><p><strong>Charts</strong>: Helm uses something called charts.
Charts are groups of pre-set Kubernetes resources. They let us deploy
applications with just one command.</p></li>
<li><p><strong>Versioning</strong>: Helm supports versioning for charts.
This means we can go back to earlier versions of our application easily
if we need to.</p></li>
<li><p><strong>Templating</strong>: Helm has a templating engine. This
helps us to change the configuration of Kubernetes resources. It makes
managing different environments like development, staging, and
production easier.</p></li>
<li><p><strong>Dependency Management</strong>: Helm can manage
dependencies between different charts. It makes sure that all parts are
deployed in the right order.</p></li>
</ul>
<h3 id="why-use-helm-for-kubernetes-deployments">Why Use Helm for
Kubernetes Deployments?</h3>
<ol type="1">
<li><p><strong>Simplicity</strong>: Helm hides the complicated parts of
Kubernetes resource definitions. This allows us to deploy applications
with less effort.</p></li>
<li><p><strong>Reusability</strong>: We can reuse Helm charts in
different projects or share them with our team. This helps us follow
best practices and saves time.</p></li>
<li><p><strong>Configuration Management</strong>: We can manage changes
to application settings using values files. This makes it easy to
control how applications behave in different environments.</p></li>
<li><p><strong>Community Support</strong>: Helm has a big and active
community. This means we can find many ready-to-use charts in public
places like <a href="https://artifacthub.io/">Artifact Hub</a>.</p></li>
<li><p><strong>Integrated Workflows</strong>: We can easily add Helm to
CI/CD pipelines. This helps us automate deployments and
updates.</p></li>
</ol>
<p>Using Helm for Kubernetes deployments makes everything simpler. It is
a great choice for managing complex applications in cloud environments.
For more information on how Helm works and to get started, check out <a
href="https://bestonlinetutorial.com/kubernetes/what-is-helm-and-how-does-it-help-with-kubernetes-deployments.html">this
article on Helm and Kubernetes deployments</a>.</p>
<h2 id="how-do-i-install-helm-on-my-local-machine">How Do I Install Helm
on My Local Machine?</h2>
<p>To install Helm on our local machine, we can follow these steps based
on our operating system.</p>
<h3 id="for-macos">For macOS</h3>
<ol type="1">
<li><p><strong>Using Homebrew:</strong></p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">brew</span> install helm</span></code></pre></div></li>
<li><p><strong>Verify Installation:</strong></p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> version</span></code></pre></div></li>
</ol>
<h3 id="for-windows">For Windows</h3>
<ol type="1">
<li><p><strong>Using Chocolatey:</strong></p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">choco</span> install kubernetes-helm</span></code></pre></div></li>
<li><p><strong>Verify Installation:</strong></p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> version</span></code></pre></div></li>
</ol>
<h3 id="for-linux">For Linux</h3>
<ol type="1">
<li><p><strong>Using Snap (for distributions with Snap
support):</strong></p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> snap install helm <span class="at">--classic</span></span></code></pre></div></li>
<li><p><strong>Using Script (for any Linux distribution):</strong></p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3 <span class="kw">|</span> <span class="fu">bash</span></span></code></pre></div></li>
<li><p><strong>Verify Installation:</strong></p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> version</span></code></pre></div></li>
</ol>
<h3 id="installation-from-binary">Installation from Binary</h3>
<ol type="1">
<li><p><strong>Download the latest release:</strong></p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://get.helm.sh/helm-v3.x.x-linux-amd64.tar.gz</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span> <span class="at">-zxvf</span> helm-v3.x.x-linux-amd64.tar.gz</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> mv linux-amd64/helm /usr/local/bin/helm</span></code></pre></div></li>
<li><p><strong>Verify Installation:</strong></p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> version</span></code></pre></div></li>
</ol>
<p>After we install, we check if Helm is set up good by running
<code>helm version</code>. This will show us that the Helm client is
ready to use for deploying applications on Kubernetes.</p>
<h2 id="what-are-helm-charts-and-how-do-they-work">What Are Helm Charts
and How Do They Work?</h2>
<p>Helm charts are packages of ready-made Kubernetes resources. They
help us to deploy and manage applications on Kubernetes easily. Helm
charts include all the needed YAML files to run an application. This
includes deployments, services, and configurations. We package these
files together as one unit.</p>
<h3 id="structure-of-a-helm-chart">Structure of a Helm Chart</h3>
<p>A normal Helm chart has this directory structure:</p>
<pre><code>mychart/
  Chart.yaml          # Information about the chart
  values.yaml         # Default settings
  charts/             # Any charts it depends on
  templates/          # Templates for Kubernetes resources</code></pre>
<h3 id="key-components">Key Components</h3>
<ul>
<li><p><strong>Chart.yaml</strong>: This file has information about the
chart. It includes the name, version, and dependencies.</p></li>
<li><p><strong>values.yaml</strong>: This file defines default settings.
Users can change these settings when they install the chart.</p></li>
<li><p><strong>templates/</strong>: This folder holds the resource
templates. These are regular Kubernetes manifests. They have
placeholders that we fill with values from the
<code>values.yaml</code>.</p></li>
</ul>
<h3 id="how-helm-charts-work">How Helm Charts Work</h3>
<ol type="1">
<li><p><strong>Installation</strong>: We install charts into a
Kubernetes cluster. This creates all the Kubernetes resources from the
chart’s templates.</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install my-release mychart/</span></code></pre></div></li>
<li><p><strong>Configuration</strong>: We can change deployments by
overriding values in the <code>values.yaml</code>. We can do this with
the <code>--set</code> flag or by making a custom values file.</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install my-release mychart/ <span class="at">--set</span> image.tag=2.0</span></code></pre></div></li>
<li><p><strong>Upgrades</strong>: We can change our application settings
or resources by updating the chart and using the upgrade command.</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> upgrade my-release mychart/</span></code></pre></div></li>
<li><p><strong>Rollback</strong>: If an upgrade causes problems, we can
easily go back to a previous version.</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> rollback my-release 1</span></code></pre></div></li>
</ol>
<h3 id="example">Example</h3>
<p>Here is a simple deployment template in a Helm chart:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}-app</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.replicaCount </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}-container</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;{{ .Values.image.repository }}:{{ .Values.image.tag }}&quot;</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.service.port </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<p>In this example, placeholders like <code>{{ .Release.Name }}</code>
and <code>{{ .Values.image.tag }}</code> will be filled with real values
when we install the chart. This gives us a complete Kubernetes
deployment manifest.</p>
<p>Helm charts make the deployment process much easier. They help us
manage complex applications in Kubernetes by hiding the difficult
configurations and encouraging us to reuse templates.</p>
<h2 id="how-can-we-create-a-custom-helm-chart-for-our-application">How
Can We Create a Custom Helm Chart for Our Application?</h2>
<p>Creating a custom Helm chart for our application involves some steps.
This helps us package our Kubernetes resources and manage their
deployment easily. Here is a simple guide to creating a custom Helm
chart.</p>
<h3 id="step-1-install-helm">Step 1: Install Helm</h3>
<p>First, we need to make sure that Helm is installed on our local
machine. We can check this by running:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> version</span></code></pre></div>
<p>If Helm is not installed, we can follow the instructions from the
official <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-install-helm-on-my-local-machine.html">Helm
installation guide</a>.</p>
<h3 id="step-2-create-a-new-helm-chart">Step 2: Create a New Helm
Chart</h3>
<p>Next, we use the Helm CLI to create a new chart. We will change
<code>my-application</code> to our chosen chart name:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> create my-application</span></code></pre></div>
<p>This command makes a directory structure like this:</p>
<pre><code>my-application/
  ├── Chart.yaml
  ├── values.yaml
  ├── charts/
  ├── templates/
  │   ├── deployment.yaml
  │   ├── service.yaml
  │   ├── ingress.yaml
  │   └── ...</code></pre>
<h3 id="step-3-customize-chart.yaml">Step 3: Customize Chart.yaml</h3>
<p>Now, we will edit the <code>Chart.yaml</code> file. This file helps
us define information about our chart:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v2</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> my-application</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">description</span><span class="kw">:</span><span class="at"> A Helm chart for Kubernetes deployment</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.1.0</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">appVersion</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;1.0&quot;</span></span></code></pre></div>
<h3 id="step-4-configure-values.yaml">Step 4: Configure values.yaml</h3>
<p>The <code>values.yaml</code> file has default values for our chart.
We can define variables that will be used in our templates:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">replicaCount</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span><span class="kw">:</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">repository</span><span class="kw">:</span><span class="at"> my-app-image</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">tag</span><span class="kw">:</span><span class="at"> latest</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pullPolicy</span><span class="kw">:</span><span class="at"> IfNotPresent</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClusterIP</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">resources</span><span class="kw">:</span><span class="at"> </span><span class="kw">{}</span></span></code></pre></div>
<h3 id="step-5-define-kubernetes-resources-in-templates">Step 5: Define
Kubernetes Resources in Templates</h3>
<p>In the <code>templates/</code> directory, we edit or create YAML
files to define Kubernetes resources. For example, we can change
<code>deployment.yaml</code>:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}-deployment</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.replicaCount </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;{{ .Values.image.repository }}:{{ .Values.image.tag }}&quot;</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="kw">{</span><span class="at">{- toYaml .Values.resources | nindent 12 </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<h3 id="step-6-install-the-chart">Step 6: Install the Chart</h3>
<p>To deploy our custom chart to a Kubernetes cluster, we use:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install my-release ./my-application</span></code></pre></div>
<p>We will change <code>my-release</code> to our desired release
name.</p>
<h3 id="step-7-upgrade-and-manage-the-chart">Step 7: Upgrade and Manage
the Chart</h3>
<p>When we want to update our application, we can change the chart files
and run:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> upgrade my-release ./my-application</span></code></pre></div>
<h3 id="step-8-package-the-chart-optional">Step 8: Package the Chart
(Optional)</h3>
<p>If we want to share our chart, we can package it:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> package my-application</span></code></pre></div>
<p>This will create a <code>.tgz</code> file that we can share or upload
to a chart repository.</p>
<p>By following these steps, we can create a custom Helm chart for our
application. This helps us manage deployments easily on Kubernetes. For
more details on Helm, we can check the <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-create-and-manage-helm-charts.html">Helm
charts documentation</a>.</p>
<h2 id="what-are-the-best-practices-for-structuring-helm-charts">What
Are the Best Practices for Structuring Helm Charts?</h2>
<p>When we structure Helm charts for deploying complex apps on
Kubernetes, following best practices is very important. This helps with
maintainability, scalability, and ease of use. Here are some good
practices we can follow:</p>
<ol type="1">
<li><p><strong>Directory Structure</strong>: We should follow a standard
directory structure in our Helm chart. This keeps everything organized.
A typical structure looks like this:</p>
<pre><code>mychart/
├── .helmignore
├── Chart.yaml
├── values.yaml
├── charts/
├── templates/
│   ├── deployment.yaml
│   ├── service.yaml
│   └── _helpers.tpl</code></pre></li>
<li><p><strong>Chart.yaml</strong>: We need to define the metadata of
our Helm chart. This includes the name, version, and dependencies. For
example:</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v2</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> mychart</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">description</span><span class="kw">:</span><span class="at"> A Helm chart for Kubernetes</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.1.0</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dependencies</span><span class="kw">:</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> redis</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="fl">14.0.0</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">repository</span><span class="kw">:</span><span class="at"> https://charts.bitnami.com/bitnami</span></span></code></pre></div></li>
<li><p><strong>values.yaml</strong>: We can use a values file to set
default configurations for our templates. This helps with easy
customization during installation. For example:</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">replicaCount</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span><span class="kw">:</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">repository</span><span class="kw">:</span><span class="at"> myapp</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">tag</span><span class="kw">:</span><span class="at"> latest</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClusterIP</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span></span></code></pre></div></li>
<li><p><strong>Templates Directory</strong>: We should keep our
Kubernetes manifests in the <code>templates/</code> directory. Use Go
templating syntax to make our templates dynamic. For example, in
<code>deployment.yaml</code>:</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}-deployment</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.replicaCount </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">image</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;{{ .Values.image.repository }}:{{ .Values.image.tag }}&quot;</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span></span></code></pre></div></li>
<li><p>**Use _helpers.tpl**: We can store reusable templates in
<code>_helpers.tpl</code> to avoid repeating ourselves. For example, we
can define a common label:</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{/*</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="at">Common label template</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="ot">*/}}</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="at">{{- define </span><span class="st">&quot;mychart.labels&quot;</span><span class="at"> -</span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">app</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- end -</span><span class="kw">}</span><span class="at">}</span></span></code></pre></div></li>
<li><p><strong>Versioning</strong>: We should use semantic versioning
for our Helm charts. This helps us keep compatibility and track changes.
We need to update the <code>version</code> and <code>appVersion</code>
fields in <code>Chart.yaml</code> as needed.</p></li>
<li><p><strong>Testing</strong>: We can add tests in our charts using
the <code>tests</code> directory. This makes sure our app works as
expected when deployed. For example:</p>
<pre><code>mychart/
├── tests/
│   └── test-connection.yaml</code></pre></li>
<li><p><strong>Documentation</strong>: It is good to provide clear
documentation in our charts. This includes usage instructions,
configuration options, and examples. We can put this in a
<code>README.md</code> file.</p></li>
<li><p><strong>Linting</strong>: We can use <code>helm lint</code> to
check our chart for common problems. This helps ensure it follows best
practices.</p></li>
<li><p><strong>Resource Management</strong>: We should define resource
requests and limits in our templates. This helps manage resource
allocation well:</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">requests</span><span class="kw">:</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">memory</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;64Mi&quot;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">cpu</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;250m&quot;</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">limits</span><span class="kw">:</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">memory</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;128Mi&quot;</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">cpu</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;500m&quot;</span></span></code></pre></div></li>
</ol>
<p>By following these best practices for structuring Helm charts, we can
make sure our deployments are organized, efficient, and easy to manage
in a Kubernetes environment. This structured approach helps our team
understand things better. It also makes future updates and maintenance
simpler. For more detailed info on creating and managing Helm charts,
you can check <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-create-and-manage-helm-charts.html">this
guide</a>.</p>
<h2 id="how-do-we-manage-configurations-and-secrets-with-helm">How Do We
Manage Configurations and Secrets with Helm?</h2>
<p>We can manage configurations and secrets in Helm using
<code>values.yaml</code>, ConfigMaps, and Kubernetes Secrets. Let’s see
how we can handle both configurations and secrets in our Helm
charts.</p>
<h3 id="using-values.yaml">Using <code>values.yaml</code></h3>
<p>The <code>values.yaml</code> file in a Helm chart lets us set default
configuration values for our application. We can change these values
when we deploy the app. We do this by giving our own
<code>values.yaml</code> file or using the <code>--set</code> flag.</p>
<p>Here is an example of a <code>values.yaml</code> file:</p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">replicaCount</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span><span class="kw">:</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">repository</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">tag</span><span class="kw">:</span><span class="at"> latest</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClusterIP</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span></span></code></pre></div>
<p>If we want to change values during installation, we can do it like
this:</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install my-release my-chart <span class="at">-f</span> custom-values.yaml</span></code></pre></div>
<p>Or we can use the <code>--set</code> flag like this:</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install my-release my-chart <span class="at">--set</span> image.tag=v1.0.0</span></code></pre></div>
<h3 id="managing-secrets">Managing Secrets</h3>
<p>For sensitive data like passwords or API keys, we should use
Kubernetes Secrets. Helm can create and manage these secrets for us.</p>
<ol type="1">
<li><strong>Create a Secret in the Chart</strong>: We need to define a
secret in our Helm chart templates.</li>
</ol>
<div class="sourceCode" id="cb35"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Secret</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-secret</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">type</span><span class="kw">:</span><span class="at"> Opaque</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">password</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.secret.password | b64enc | quote </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<ol start="2" type="1">
<li><strong>Reference the Secret in Our Deployment</strong>:</li>
</ol>
<p>In our deployment template, we can reference the secret as an
environment variable:</p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.replicaCount </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.image.repository </span><span class="kw">}</span><span class="at">}:{{ .Values.image.tag }}</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> APP_PASSWORD</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">valueFrom</span><span class="kw">:</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">secretKeyRef</span><span class="kw">:</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-secret</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">key</span><span class="kw">:</span><span class="at"> password</span></span></code></pre></div>
<h3 id="using-configmaps">Using ConfigMaps</h3>
<p>For non-sensitive configuration data, we can use ConfigMaps. We
define a ConfigMap in our Helm chart and reference it in our
application.</p>
<ol type="1">
<li><strong>Create a ConfigMap</strong>:</li>
</ol>
<div class="sourceCode" id="cb37"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-config</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="fu">  config.json</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>      &quot;key&quot;: &quot;{{ .Values.config.key }}&quot;</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
<ol start="2" type="1">
<li><strong>Mount the ConfigMap in Our Deployment</strong>:</li>
</ol>
<div class="sourceCode" id="cb38"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.replicaCount </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.image.repository </span><span class="kw">}</span><span class="at">}:{{ .Values.image.tag }}</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">volumeMounts</span><span class="kw">:</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> config-volume</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">mountPath</span><span class="kw">:</span><span class="at"> /app/config</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> config-volume</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">configMap</span><span class="kw">:</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-config</span></span></code></pre></div>
<h3 id="best-practices">Best Practices</h3>
<ul>
<li><strong>Use <code>helm secrets</code></strong>: For managing
secrets, we can use the <a
href="https://github.com/jkroepke/helm-secrets">helm-secrets plugin</a>.
This plugin helps to encrypt our secrets files using tools like
SOPS.</li>
<li><strong>Separate Sensitive and Non-Sensitive Data</strong>: We
should keep configurations and secrets in different files. This makes
managing them easier.</li>
<li><strong>Template Functions</strong>: We can use Helm template
functions to change values, like encoding or formatting configurations
as needed.</li>
</ul>
<p>By following these methods, we can manage configurations and secrets
in our Kubernetes applications using Helm.</p>
<h2 id="what-are-real-world-use-cases-for-using-helm-in-kubernetes">What
Are Real-World Use Cases for Using Helm in Kubernetes?</h2>
<p>Helm is a great tool. It helps us to deploy and manage applications
in Kubernetes. Here are some real-world cases where we can use Helm in
Kubernetes:</p>
<ol type="1">
<li><p><strong>Microservices Deployment</strong>: With Helm, we can
package microservices into charts. This makes it simple to manage
dependencies and versions. For example, when we deploy a microservices
setup, we can define each service as a Helm chart. This way, we can
deploy all services at once using one command:</p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install my-microservices ./my-chart</span></code></pre></div></li>
<li><p><strong>Continuous Integration/Continuous Deployment
(CI/CD)</strong>: Helm works well with CI/CD pipelines. Using Helm
charts helps us automate the deployment process. This lets developers
focus on writing code without stressing about deployment. For example, a
CI/CD pipeline can start a Helm upgrade when we merge code:</p>
<div class="sourceCode" id="cb40"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> upgrade my-app ./my-chart <span class="at">--install</span></span></code></pre></div></li>
<li><p><strong>Environment Management</strong>: Helm helps us manage
different environments like development, staging, and production using
the same Helm chart. We can use specific values files for each
environment. This way, we can customize deployments without making new
chart definitions. We can do this by:</p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install my-app ./my-chart <span class="at">-f</span> values-prod.yaml</span></code></pre></div></li>
<li><p><strong>Application Rollbacks</strong>: Helm has versioning
built-in. This makes it easy to go back to previous versions if
something goes wrong during deployment. This is very important in
production because we need to keep our services running. To rollback to
the last version, we can use:</p>
<div class="sourceCode" id="cb42"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> rollback my-app 1</span></code></pre></div></li>
<li><p><strong>Managing Configurations and Secrets</strong>: Helm can
manage configurations and secrets well with ConfigMaps and Secrets. When
we define these in our Helm charts, we make sure sensitive information
is safe while keeping flexibility in deployments. Here is an example of
defining a Secret in a Helm chart:</p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Secret</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-secret</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">type</span><span class="kw">:</span><span class="at"> Opaque</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">password</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.secret.password | b64enc | quote </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div></li>
<li><p><strong>Multi-Cloud Deployments</strong>: Helm allows us to
deploy consistently across different cloud providers. By defining our
applications and their needs in Helm charts, we can use the same
deployment scripts no matter the infrastructure, like AWS, GCP, or
Azure.</p></li>
<li><p><strong>Community Charts</strong>: Helm has a big collection of
community charts. We can use these charts to quickly deploy complex
applications. For example, we can deploy a popular app like WordPress
with just one Helm command:</p>
<div class="sourceCode" id="cb44"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> repo add bitnami https://charts.bitnami.com/bitnami</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install my-wordpress bitnami/wordpress</span></code></pre></div></li>
<li><p><strong>Custom Application Deployment</strong>: For companies
with unique applications, we can create custom Helm charts. This allows
us to have deployments that fit our special needs. We can define
resource limits, affinity rules, and more in the
<code>values.yaml</code> file to match what we need.</p></li>
</ol>
<p>By using Helm in these real situations, we can make our Kubernetes
deployments more efficient, reliable, and scalable. If you want to learn
more about using Helm for complex applications, you can check out <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-create-and-manage-helm-charts.html">how
to create and manage Helm charts</a>.</p>
<h2 id="how-do-i-upgrade-and-rollback-applications-with-helm">How Do I
Upgrade and Rollback Applications with Helm?</h2>
<p>Upgrading and rolling back applications with Helm is simple. It needs
just a few commands. Helm keeps track of release history. This means we
can go back to an earlier version if we need.</p>
<h3 id="upgrading-applications">Upgrading Applications</h3>
<p>To upgrade an application, we use the <code>helm upgrade</code>
command. The basic format is:</p>
<div class="sourceCode" id="cb45"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> upgrade <span class="pp">[</span><span class="ss">RELEASE_NAME</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">CHART</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">flags</span><span class="pp">]</span></span></code></pre></div>
<p>For example, if we want to upgrade a release called
<code>my-app</code> with a chart found at <code>./my-app-chart</code>,
we run:</p>
<div class="sourceCode" id="cb46"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> upgrade my-app ./my-app-chart</span></code></pre></div>
<p>We can also add extra settings with the <code>--set</code> flag or
use a values file:</p>
<div class="sourceCode" id="cb47"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> upgrade my-app ./my-app-chart <span class="at">--set</span> image.tag=newtag</span></code></pre></div>
<p>OR</p>
<div class="sourceCode" id="cb48"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> upgrade my-app ./my-app-chart <span class="at">-f</span> custom-values.yaml</span></code></pre></div>
<h3 id="rollback-applications">Rollback Applications</h3>
<p>If an upgrade does not work or makes problems, we can roll back to a
previous version. We use the <code>helm rollback</code> command. The
format is:</p>
<div class="sourceCode" id="cb49"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> rollback <span class="pp">[</span><span class="ss">RELEASE_NAME</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">REVISION</span><span class="pp">]</span></span></code></pre></div>
<p>To roll back the <code>my-app</code> release to revision 1, we
run:</p>
<div class="sourceCode" id="cb50"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> rollback my-app 1</span></code></pre></div>
<p>We can see the history of our releases and their revisions with:</p>
<div class="sourceCode" id="cb51"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> history my-app</span></code></pre></div>
<p>This command shows us the list of revisions, their statuses, and the
time they were deployed. This helps us choose the right version to roll
back.</p>
<h3 id="best-practices-1">Best Practices</h3>
<ul>
<li>Always test upgrades in a staging area before moving to
production.</li>
<li>Use version tags for your images and charts. This helps manage
upgrades and rollbacks better.</li>
<li>Keep notes on your Helm releases and their settings. This makes
troubleshooting easier.</li>
</ul>
<p>For more info on managing Helm charts and deployments, check <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-create-and-manage-helm-charts.html">how
to create and manage Helm charts</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3
id="what-is-helm-and-how-does-it-simplify-kubernetes-deployments">What
is Helm and how does it simplify Kubernetes deployments?</h3>
<p>Helm is a tool for managing packages in Kubernetes. It makes it
easier to deploy complex applications. Helm uses charts. Charts are like
templates for Kubernetes resources. They help us deploy applications
quickly and in a consistent way. With Helm, we can handle dependencies
and versions easily. This helps us manage our applications better on
Kubernetes. So, Helm is an important tool for working with
Kubernetes.</p>
<h3 id="how-do-i-create-a-helm-chart-for-my-application">How do I create
a Helm chart for my application?</h3>
<p>To create a Helm chart, we need to organize our Kubernetes files in a
way that Helm understands. First, we run
<code>helm create &lt;chart-name&gt;</code>. This will create a basic
setup for our chart. Next, we can change the files that Helm creates. We
should edit <code>values.yaml</code> for the default settings. We also
need to set up templates for our Kubernetes resources like Deployments
and Services. If you want to learn more about creating Helm charts,
check our guide on <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-create-and-manage-helm-charts.html">how
do I create and manage Helm charts</a>.</p>
<h3 id="what-are-the-best-practices-for-structuring-helm-charts-1">What
are the best practices for structuring Helm charts?</h3>
<p>To structure Helm charts well, we should keep them organized based on
their purpose. We should use clear names and have a good
<code>values.yaml</code> for configuration. It is also good to use
subcharts for more complex applications. We should make sure our charts
are version controlled. This helps us work together and keeps everything
easy to manage. This way, we can deploy and manage applications on
Kubernetes better.</p>
<h3 id="how-can-i-manage-configurations-and-secrets-using-helm">How can
I manage configurations and secrets using Helm?</h3>
<p>We can manage configurations and secrets in Helm by using
<code>values.yaml</code> files for settings and Kubernetes Secrets for
sensitive information. We can set placeholder values in our templates.
Then, we can change them when we deploy using the <code>--set</code>
flag or by using a custom <code>values.yaml</code>. For keeping
sensitive information safe, we should use Kubernetes Secrets. Helm works
well with these secrets during deployments.</p>
<h3 id="how-do-i-upgrade-or-rollback-applications-using-helm">How do I
upgrade or rollback applications using Helm?</h3>
<p>Upgrading or rolling back applications with Helm is simple. To
upgrade, we run
<code>helm upgrade &lt;release-name&gt; &lt;chart-path&gt;</code>, and
we can add any new settings we want. If we need to go back to a previous
version, we use
<code>helm rollback &lt;release-name&gt; &lt;revision-number&gt;</code>.
Helm keeps track of versions, so it is easy to go back to a stable
version if we need to. This helps us keep our applications running with
little downtime on Kubernetes.</p>
<p>These FAQs give us important information about using Helm for
deploying complex applications in Kubernetes. They help us improve our
development and operational tasks. For more details, look at our article
on <a
href="https://bestonlinetutorial.com/kubernetes/what-is-helm-and-how-does-it-help-with-kubernetes-deployments.html">what
is Helm and how does it help with Kubernetes deployments</a>.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            