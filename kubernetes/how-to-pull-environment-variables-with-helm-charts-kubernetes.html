
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
            <!-- Google tag (gtag.js) -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
            <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-TFCQEJR7TD');
            </script>
            
            <title>How to pull environment variables with Helm charts - kubernetes</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "BestOnlineTutorial",
      "url": "https://www.bestonlinetutorial.com/"
    }
    </script>

<!-- Common CSS & Icons -->
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
<link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
<link rel="stylesheet" href="/assets/css/post.css">
            <meta name="description" content="Learn how to pull environment variables using Helm charts in Kubernetes effectively. Boost your deployment strategies today!">
            <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	        <script src="/assets/js/blog.js"></script>
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">How to pull environment variables with Helm charts - kubernetes</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>To pull environment variables with Helm charts in Kubernetes, we can
use ConfigMaps and Secrets. ConfigMaps help us manage non-sensitive
data. Secrets are for sensitive information. This way, we can keep our
environment variables safe. By using these Kubernetes features in our
Helm charts, we can make application setup easier and improve
security.</p>
<p>In this article, we will look at different ways to pull environment
variables using Helm charts in Kubernetes. We will talk about using
ConfigMaps and Secrets for managing our environment variables. We will
also see how to define them in the <code>values.yaml</code> file and use
the <code>env</code> template function. Moreover, we will learn how to
customize environment variables with Helm chart hooks. We will answer
some common questions to help clear up any confusion.</p>
<ul>
<li>How can we pull environment variables with Helm charts in
Kubernetes?</li>
<li>How do we use ConfigMaps to manage environment variables in Helm
charts?</li>
<li>How can we use Secrets for pulling sensitive environment variables
with Helm charts?</li>
<li>How do we define environment variables in <code>values.yaml</code>
for Helm charts?</li>
<li>How do we use the <code>env</code> template function in Helm charts
to pull environment variables?</li>
<li>How can we customize environment variables using Helm chart
hooks?</li>
<li>Frequently Asked Questions</li>
</ul>
<h2
id="how-to-use-configmaps-to-manage-environment-variables-in-helm-charts">How
to use ConfigMaps to manage environment variables in Helm charts?</h2>
<p>ConfigMaps in Kubernetes help us manage environment variables and
settings apart from our application code. When we use Helm charts, we
can easily add ConfigMaps to put environment variables into our
pods.</p>
<p>To use ConfigMaps in our Helm charts, we can follow these steps:</p>
<ol type="1">
<li><strong>Create a ConfigMap Template</strong>: First, we need to
create a <code>configmap.yaml</code> file in the <code>templates</code>
folder of our Helm chart.</li>
</ol>
<div class="sourceCode" id="cb1"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ include </span><span class="st">&quot;your-chart.fullname&quot;</span><span class="at"> . </span><span class="kw">}</span><span class="at">}-config</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">MY_ENV_VAR</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.myEnvVar | quote </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<ol start="2" type="1">
<li><strong>Define Values in <code>values.yaml</code></strong>: Next, we
write the values for our environment variables in the
<code>values.yaml</code> file.</li>
</ol>
<div class="sourceCode" id="cb2"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">myEnvVar</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;some_value&quot;</span></span></code></pre></div>
<ol start="3" type="1">
<li><strong>Update Deployment to Use ConfigMap</strong>: Then, we change
our deployment template to use the ConfigMap as environment
variables.</li>
</ol>
<div class="sourceCode" id="cb3"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ include </span><span class="st">&quot;your-chart.fullname&quot;</span><span class="at"> . </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> your-container</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">image</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;your-image:latest&quot;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> MY_ENV_VAR</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">valueFrom</span><span class="kw">:</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">configMapKeyRef</span><span class="kw">:</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ include </span><span class="st">&quot;your-chart.fullname&quot;</span><span class="at"> . </span><span class="kw">}</span><span class="at">}-config</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">key</span><span class="kw">:</span><span class="at"> MY_ENV_VAR</span></span></code></pre></div>
<ol start="4" type="1">
<li><strong>Deploy the Helm Chart</strong>: Finally, we use Helm to
install or upgrade our chart.</li>
</ol>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install your-release-name ./your-chart</span></code></pre></div>
<p>This will create a ConfigMap with our chosen environment variables.
It will put them into our application container. This way, we can manage
settings separately and update them without changing our application
code. For more details on managing settings in Kubernetes, check <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-use-configmaps-to-manage-application-configuration-in-kubernetes.html">this
guide on ConfigMaps</a>.</p>
<h2
id="how-to-use-secrets-for-pulling-sensitive-environment-variables-with-helm-charts">How
to use Secrets for pulling sensitive environment variables with Helm
charts?</h2>
<p>In Kubernetes, we need to keep sensitive information like passwords,
OAuth tokens, and ssh keys safe. We can do this by storing them in
Secrets. Helm charts can get these Secrets to fill environment variables
securely.</p>
<p>To use Secrets in a Helm chart, we can follow these steps:</p>
<ol type="1">
<li><p><strong>Create a Secret</strong>:</p>
<p>We can create a Secret using a YAML file or the command line. Here is
an example to create a Secret using a YAML file:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Secret</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-secret</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">type</span><span class="kw">:</span><span class="at"> Opaque</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">my-password</span><span class="kw">:</span><span class="at"> bXlwYXNzd29yZA==</span><span class="co">  # This is the Base64 encoded value of &#39;mypassword&#39;</span></span></code></pre></div>
<p>We apply this YAML file with:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> secret.yaml</span></code></pre></div></li>
<li><p><strong>Access the Secret in Helm Chart</strong>:</p>
<p>In our Helm chartâ€™s deployment template, we can use the Secret to set
environment variables. Here is an example:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app-container</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-app-image:latest</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> MY_PASSWORD</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">valueFrom</span><span class="kw">:</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">secretKeyRef</span><span class="kw">:</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-secret</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">key</span><span class="kw">:</span><span class="at"> my-password</span></span></code></pre></div></li>
<li><p><strong>Using the Secret in values.yaml</strong>:</p>
<p>To make our Helm chart more flexible, we can define the Secret name
and key in the <code>values.yaml</code> file:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">secret</span><span class="kw">:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-secret</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">key</span><span class="kw">:</span><span class="at"> my-password</span></span></code></pre></div>
<p>Then, we update our deployment template to use these values:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> MY_PASSWORD</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">valueFrom</span><span class="kw">:</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">secretKeyRef</span><span class="kw">:</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.secret.name </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">key</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.secret.key </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div></li>
<li><p><strong>Deploy the Helm Chart</strong>:</p>
<p>We install or upgrade our Helm chart using:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install my-release ./my-chart</span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> upgrade my-release ./my-chart</span></code></pre></div></li>
</ol>
<p>Using Secrets in Helm charts helps us manage sensitive environment
variables safely. This way, our applications can access the needed
credentials without putting them directly in the source code. For more
information on using Secrets in Kubernetes, we can check this link: <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-manage-secrets-in-kubernetes-securely.html">how
do I manage secrets in Kubernetes securely</a>.</p>
<h2
id="how-to-define-environment-variables-in-values.yaml-for-helm-charts">How
to define environment variables in values.yaml for Helm charts?</h2>
<p>To define environment variables in <code>values.yaml</code> for Helm
charts, we can put them in a custom section. This section will be used
in our deployment template. This way, we can manage the settings
separately from the code. It makes it easier to change the variables
without changing the chart itself.</p>
<p>Here is an example of how to set up your <code>values.yaml</code>
file to add environment variables:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># values.yaml</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">MY_ENV_VAR</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;value1&quot;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ANOTHER_ENV_VAR</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;value2&quot;</span></span></code></pre></div>
<p>In our deployment template (like <code>deployment.yaml</code>), we
can then use these environment variables like this:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ include </span><span class="st">&quot;mychart.fullname&quot;</span><span class="at"> . </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.replicaCount </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> myapp</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">image</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;{{ .Values.image.repository }}:{{ .Values.image.tag }}&quot;</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> MY_ENV_VAR</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.env.MY_ENV_VAR | quote </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> ANOTHER_ENV_VAR</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.env.ANOTHER_ENV_VAR | quote </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<p>This example shows how we can define environment variables in
<code>values.yaml</code> and use them in our Helm chart templates. Using
this method, we can easily change the values in <code>values.yaml</code>
without changing the deployment settings directly.</p>
<p>For more information on managing application settings in Kubernetes
using ConfigMaps, you can check <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-use-configmaps-to-manage-application-configuration-in-kubernetes.html">how
to use ConfigMaps to manage application configuration in
Kubernetes</a>.</p>
<h2
id="how-to-use-the-env-template-function-in-helm-charts-to-pull-environment-variables">How
to use the env template function in Helm charts to pull environment
variables?</h2>
<p>In Helm charts, we use the <code>env</code> template function to get
environment variables from the Kubernetes environment. This helps our
application to set itself up based on the environment it runs in.</p>
<p>We can use the <code>env</code> function in our templates like
this:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Pod</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> example-pod</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> example-container</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">image</span><span class="kw">:</span><span class="at"> your-image:latest</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> EXAMPLE_ENV</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.exampleEnv | quote </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<p>In this example, we define an environment variable called
<code>EXAMPLE_ENV</code>. It gets its value from the
<code>values.yaml</code> file by using
<code>{{ .Values.exampleEnv }}</code>. The <code>quote</code> function
makes sure the value has quotes around it.</p>
<p>To set this variable in our <code>values.yaml</code>, we add:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exampleEnv</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Hello, World!&quot;</span></span></code></pre></div>
<p>When we deploy our Helm chart, this environment variable will be
ready for our application.</p>
<p>We can also use the <code>lookup</code> function with
<code>env</code> to access existing Kubernetes environment variables.
For example, if we want to get the namespace of the pod:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> POD_NAMESPACE</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Namespace | quote </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<p>This helps our application know what namespace it runs in. This can
be very important for applications that serve multiple users.</p>
<p>For more details on using environment variables in Helm, like getting
values from ConfigMaps or Secrets, we can check out other articles.
These include <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-use-configmaps-to-manage-application-configuration-in-kubernetes.html">how
to use ConfigMaps to manage application configuration in Kubernetes</a>
and <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-use-kubernetes-secrets-to-store-database-credentials.html">how
to use Kubernetes secrets to store database credentials</a>.</p>
<h2
id="how-to-customize-environment-variables-using-helm-chart-hooks">How
to customize environment variables using Helm chart hooks?</h2>
<p>Helm chart hooks help us run actions at certain times during the
release process. We can change environment variables when these events
happen using hooks. Here is how we can do it well.</p>
<h3 id="defining-hooks-in-helm-charts">Defining Hooks in Helm
Charts</h3>
<p>To change environment variables, we need to define a hook in our Helm
chart. We define hooks in the metadata part of our Kubernetes resources.
Here is an example of using a hook to set environment variables during
the pre-install or post-install phase.</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-config</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">annotations</span><span class="kw">:</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;helm.sh/hook&quot;</span><span class="kw">:</span><span class="at"> post-install</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ENV_VAR_ONE</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;value1&quot;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ENV_VAR_TWO</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;value2&quot;</span></span></code></pre></div>
<h3 id="using-hooks-to-set-environment-variables">Using Hooks to Set
Environment Variables</h3>
<ol type="1">
<li><strong>Pre-install Hook</strong>: This runs before we install our
release.</li>
<li><strong>Post-install Hook</strong>: This runs after we finish the
installation.</li>
<li><strong>Delete Hook</strong>: This runs when we delete a
release.</li>
</ol>
<h3 id="example-with-deployment">Example with Deployment</h3>
<p>To change environment variables in a deployment using a hook, we can
create a ConfigMap and use it in our Deployment manifest. Here is an
example:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-deployment</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-container</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-image:latest</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> ENV_VAR_ONE</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">valueFrom</span><span class="kw">:</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">configMapKeyRef</span><span class="kw">:</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-config</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">key</span><span class="kw">:</span><span class="at"> ENV_VAR_ONE</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> ENV_VAR_TWO</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">valueFrom</span><span class="kw">:</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">configMapKeyRef</span><span class="kw">:</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-config</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">key</span><span class="kw">:</span><span class="at"> ENV_VAR_TWO</span></span></code></pre></div>
<h3 id="deploying-with-hooks">Deploying with Hooks</h3>
<p>When we deploy our Helm chart, the hooks run in the order we set.
This sets our environment variables based on the stage of the
lifecycle:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install my-release ./my-chart</span></code></pre></div>
<p>By using Helm chart hooks, we can manage environment variables that
fit our deployment needs. This gives us flexibility and control in our
Kubernetes apps. For more information on managing application settings,
we can read <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-use-configmaps-to-manage-application-configuration-in-kubernetes.html">how
to use ConfigMaps to manage application configuration in
Kubernetes</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3
id="what-are-environment-variables-in-kubernetes-and-why-are-they-important">1.
What are environment variables in Kubernetes, and why are they
important?</h3>
<p>Environment variables in Kubernetes are key-value pairs. We use them
to set up applications that run in containers. They let us pass
important info like database connection strings or API keys when the app
is running. Using environment variables helps us manage app settings in
different environments like development, testing, and production. This
way, we do not have to hardcode values in the app code. It makes our
apps more flexible and safe.</p>
<h3 id="how-do-i-create-and-use-configmaps-in-helm-charts">2. How do I
create and use ConfigMaps in Helm charts?</h3>
<p>ConfigMaps in Helm charts help us manage environment variables and
configuration settings. We can create a ConfigMap by writing it in our
<code>values.yaml</code> file. Then we can reference it in our
deployment templates. This way, we can separate configuration from our
app code. It makes it easier to update without needing to redeploy. For
more details, check our article on <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-use-configmaps-to-manage-application-configuration-in-kubernetes.html">how
to use ConfigMaps to manage application configuration in
Kubernetes</a>.</p>
<h3
id="how-can-i-store-sensitive-information-with-kubernetes-secrets">3.
How can I store sensitive information with Kubernetes Secrets?</h3>
<p>Kubernetes Secrets help us store sensitive info like passwords and
API tokens safely. We can create Secrets in our Helm chart and reference
them in our pod specs. This keeps sensitive data away from our app code
and logs. For good practices on managing Secrets, see our guide on <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-manage-secrets-in-kubernetes-securely.html">how
do I manage secrets in Kubernetes securely</a>.</p>
<h3
id="how-can-i-pass-environment-variables-from-values.yaml-in-helm-charts">4.
How can I pass environment variables from values.yaml in Helm
charts?</h3>
<p>We can define environment variables in our <code>values.yaml</code>
file by making a special section for them. Each variable can be
referenced in our deployment templates using the Helm templating syntax.
This makes it easy for us to customize and manage configuration data.
For a step-by-step guide, see our article on <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-create-and-manage-helm-charts.html">how
do I create and manage Helm charts</a>.</p>
<h3
id="what-is-the-purpose-of-the-env-template-function-in-helm-charts">5.
What is the purpose of the env template function in Helm charts?</h3>
<p>The <code>env</code> template function in Helm charts helps us pull
environment variables into our Kubernetes manifests. This function lets
us reference values from <code>values.yaml</code> or environment
variables from our CI/CD pipeline. This way, our application can adjust
to different environments without problems. For more info on using Helm
well, read our article on <a
href="https://bestonlinetutorial.com/kubernetes/what-is-helm-and-how-does-it-help-with-kubernetes-deployments.html">what
is Helm and how does it help with Kubernetes deployments</a>.</p>
<p>These FAQs give us basic knowledge on using environment variables
with Helm charts in Kubernetes. This can help us make our deployments
more efficient and safe.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            