
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
            <!-- Google tag (gtag.js) -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
            <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-TFCQEJR7TD');
            </script>
            <meta charset="utf-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            
            <meta property="og:title" content="How Can You Use Variable Values as YAML Keys in Helm Charts for Kubernetes?" />
            <meta property="og:description" content="Learn how to leverage variable values as YAML keys in Helm charts for Kubernetes to enhance your deployment flexibility." />
            <meta property="og:url" content="https://www.bestonlinetutorial.com/kubernetes/how-can-you-use-variable-values-as-yaml-keys-in-helm-charts-for-kubernetes.html" />
            <link rel="canonical" href="https://www.bestonlinetutorial.com/kubernetes/how-can-you-use-variable-values-as-yaml-keys-in-helm-charts-for-kubernetes.html">
            <meta property="og:type" content="article" />
            <meta property="og:site_name" content=“BestOnlineTutorial” />
            <meta name="twitter:title" content="How Can You Use Variable Values as YAML Keys in Helm Charts for Kubernetes?" />
            <meta name="twitter:description" content="Learn how to leverage variable values as YAML keys in Helm charts for Kubernetes to enhance your deployment flexibility." />
            <meta name="pinterest-rich-pin" content="true" />

            <script type="application/ld+json">
                {
                "@context": "https://schema.org",
                "@type": "WebSite",
                "name": "BestOnlineTutorial",
                "url": "https://www.bestonlinetutorial.com/"
                }
            </script>
            <!-- Common CSS & Icons -->
            <link rel="icon" href="/favicon.ico" type="image/x-icon">
            <link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
            <link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
            <link rel="stylesheet" href="/assets/css/post.css">
            <title>How Can You Use Variable Values as YAML Keys in Helm Charts for Kubernetes?</title>
            <meta name="description" content="Learn how to leverage variable values as YAML keys in Helm charts for Kubernetes to enhance your deployment flexibility.">
            <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	        <script src="/assets/js/blog.js"></script>
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">How Can You Use Variable Values as YAML Keys in Helm Charts for Kubernetes?</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>To use variable values as YAML keys in Helm charts for Kubernetes, we
can use Helm’s templating features. This helps us define keys based on
input values. With this, we create flexible Helm charts. They can adapt
to different deployment needs based on the parameters we give when we
install or upgrade the chart.</p>
<p>In this article, we will look at different ways to use dynamic keys
in Helm charts. We will cover how to define dynamic keys, use templates,
apply Sprig functions for key generation, manage nested keys, and fix
issues with variable keys. Here’s what we will talk about:</p>
<ul>
<li>How to Use Variable Values as YAML Keys in Helm Charts for
Kubernetes</li>
<li>How Can You Define Dynamic Keys in Helm Charts</li>
<li>How Can You Use Templates for Variable Keys in Helm</li>
<li>How Can You Use Sprig Functions to Make Keys in Helm YAML</li>
<li>How Can You Manage Nested Keys with Variables in Helm Charts</li>
<li>How Can You Fix Issues with Variable Keys in Helm Charts</li>
<li>Frequently Asked Questions</li>
</ul>
<h2 id="how-can-we-define-dynamic-keys-in-helm-charts">How Can We Define
Dynamic Keys in Helm Charts</h2>
<p>Defining dynamic keys in Helm charts gives us more flexibility and
customization in our Kubernetes deployments. We can use Helm’s
templating functions to create keys that change based on the values in
our <code>values.yaml</code> file or through command-line arguments.</p>
<h3 id="using-template-functions-for-dynamic-keys">Using Template
Functions for Dynamic Keys</h3>
<p>Helm uses Go templates. These templates let us create dynamic YAML
keys. For example, we can use the <code>{{ .Values }}</code> object to
get values from our <code>values.yaml</code> file and use them as keys
in our config.</p>
<h4 id="example">Example</h4>
<p>Here is a simple example that shows how to create dynamic keys in a
ConfigMap:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-config</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at">{- range $key</span><span class="kw">,</span><span class="at"> $value := .Values.config </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at">{ $key </span><span class="kw">}</span><span class="fu">}</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ $value | quote </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at">{- end </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<p>In this example, each key-value pair from <code>.Values.config</code>
will become an entry in the ConfigMap’s data field.</p>
<h3 id="utilizing-conditional-logic">Utilizing Conditional Logic</h3>
<p>We can also add keys based on whether some values are set. We do this
using <code>if</code> statements in our templates:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-config</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at">{- if .Values.enableFeature </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">featureEnabled</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;true&quot;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at">{- end </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<p>In this snippet, the <code>featureEnabled</code> key will be included
only if <code>enableFeature</code> is set to <code>true</code> in our
<code>values.yaml</code>.</p>
<h3 id="nesting-dynamic-keys">Nesting Dynamic Keys</h3>
<p>We can create nested keys by using multiple levels of templates. For
example:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-config</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at">{- range $parentKey</span><span class="kw">,</span><span class="at"> $childMap := .Values.nestedConfig </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at">{ $parentKey </span><span class="kw">}</span><span class="fu">}</span><span class="kw">:</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">{</span><span class="at">{- range $childKey</span><span class="kw">,</span><span class="at"> $childValue := $childMap </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">{</span><span class="at">{ $childKey </span><span class="kw">}</span><span class="fu">}</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ $childValue | quote </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">{</span><span class="at">{- end </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at">{- end </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<p>Here, each parent key has its own nested structure based on the data
in <code>nestedConfig</code>.</p>
<h3 id="conclusion">Conclusion</h3>
<p>Using dynamic keys in Helm charts makes our Kubernetes applications
more configurable. By using templating techniques and logical
structures, we can create more flexible and easy-to-maintain Helm
charts. We should check the Helm documentation for more details on
templating and values management.</p>
<p>For more information on Helm and its features, look at this article
on <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-create-and-manage-helm-charts.html">how
to create and manage Helm charts</a>.</p>
<h2 id="how-can-we-leverage-templates-for-variable-keys-in-helm">How Can
We Leverage Templates for Variable Keys in Helm</h2>
<p>In Helm charts, templates are helpful tools. They let us create YAML
files based on variable values. To use templates for variable keys, we
can apply the Go templating syntax in our Helm charts. This lets us
define keys based on input values. Now, our charts become more flexible
and reusable.</p>
<h3 id="example-of-using-variables-as-keys">Example of Using Variables
as Keys</h3>
<p>Let’s think about a case where we want to set environment variables
for a Kubernetes deployment based on user input. We can use a template
to create dynamic keys.</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}-config</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- range $key</span><span class="kw">,</span><span class="at"> $value := .Values.env </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at">{ $key </span><span class="kw">}</span><span class="fu">}</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ $value | quote </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- end </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<p>In this example, the keys in the ConfigMap come from the
<code>env</code> map in <code>values.yaml</code>. If our values file
looks like this:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">DATABASE_URL</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;postgres://db:5432&quot;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">REDIS_URL</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;redis://cache:6379&quot;</span></span></code></pre></div>
<p>Then, the ConfigMap we get will look like this:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-release-config</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">DATABASE_URL</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;postgres://db:5432&quot;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">REDIS_URL</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;redis://cache:6379&quot;</span></span></code></pre></div>
<h3 id="using-conditional-logic-in-templates">Using Conditional Logic in
Templates</h3>
<p>We can use conditional logic in our templates too. This helps us add
or skip keys based on the values we provide. For example:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- if .Values.featureEnabled </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">featureToggle</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- end </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<p>This will add the <code>featureToggle</code> key only if the
<code>featureEnabled</code> value is set to <code>true</code> in
<code>values.yaml</code>.</p>
<h3 id="complex-structures-with-nested-keys">Complex Structures with
Nested Keys</h3>
<p>Helm templates can also manage more complex structures. If we want to
make nested keys based on a list, we can do it like this:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}-nested-config</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- range .Values.services </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at">{ .name </span><span class="kw">}</span><span class="fu">}</span><span class="kw">:</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .url | quote </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .enabled </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- end </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<p>If we have a <code>values.yaml</code> like this:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> serviceA</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;http://service-a.local&quot;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> serviceB</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;http://service-b.local&quot;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span></code></pre></div>
<p>The output we generate will be:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-release-nested-config</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">serviceA</span><span class="kw">:</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;http://service-a.local&quot;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">serviceB</span><span class="kw">:</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;http://service-b.local&quot;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span></code></pre></div>
<h3 id="utilizing-sprig-functions">Utilizing Sprig Functions</h3>
<p>Helm works with Sprig functions to change strings and create keys.
For example, we can use <code>lower</code> to make keys lowercase:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- range $key</span><span class="kw">,</span><span class="at"> $value := .Values.someMap </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at">{ $key | lower </span><span class="kw">}</span><span class="fu">}</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ $value </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- end </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<p>This way, we can keep our key formatting consistent.</p>
<h3 id="final-note">Final Note</h3>
<p>Using templates in Helm for variable keys makes our configurations
more customizable and adaptable. By using these templates, we can create
more dynamic and reusable Helm charts for our applications. To learn
more about Helm and Kubernetes, check out <a
href="https://bestonlinetutorial.com/kubernetes/what-is-helm-and-how-does-it-help-with-kubernetes-deployments.html">what
is Helm and how does it help with Kubernetes deployments</a>.</p>
<h2
id="how-can-we-use-the-sprig-functions-to-generate-keys-in-helm-yaml">How
Can We Use the Sprig Functions to Generate Keys in Helm YAML</h2>
<p>In Helm charts, we can use Sprig functions. They are helpful tools
that let us change strings and create dynamic keys in our YAML files. We
can use these functions to make keys based on variable values. This
makes our Helm templates more flexible.</p>
<p>Here is how we can use Sprig functions to create keys:</p>
<h3 id="basic-key-generation">Basic Key Generation</h3>
<p>We can use the <code>cat</code> function to join strings and create
dynamic keys. For example, if we want a key that mixes a base name with
an index, we can do it like this:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- $baseName := </span><span class="st">&quot;service&quot;</span><span class="at"> -</span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- range $index</span><span class="kw">,</span><span class="at"> $value := .Values.services -</span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{ $key := printf </span><span class="st">&quot;%s-%d&quot;</span><span class="at"> $baseName $index </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{ $key </span><span class="kw">}</span><span class="fu">}</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ $value </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- end </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<h3 id="using-join-for-complex-keys">Using <code>join</code> for Complex
Keys</h3>
<p>The <code>join</code> function is good if we need to make keys from a
list of strings. Here is an example:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- $components := list </span><span class="st">&quot;frontend&quot;</span><span class="at"> </span><span class="st">&quot;backend&quot;</span><span class="at"> </span><span class="st">&quot;database&quot;</span><span class="at"> -</span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- $key := join </span><span class="st">&quot;-&quot;</span><span class="at"> $components </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{ $key </span><span class="kw">}</span><span class="fu">}</span><span class="kw">:</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code></pre></div>
<h3 id="dynamic-keys-with-toyaml">Dynamic Keys with
<code>toYaml</code></h3>
<p>We can create keys dynamically and change them to YAML format using
<code>toYaml</code>. Here is how we can make a nested structure:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- $env := .Values.environment -</span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- $key := printf </span><span class="st">&quot;config-%s&quot;</span><span class="at"> $env </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{ $key </span><span class="kw">}</span><span class="fu">}</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{ toYaml .Values.config | indent 2 </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<h3 id="using-conditional-logic">Using Conditional Logic</h3>
<p>We can also use Sprig functions with conditional logic to make keys
based on conditions:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- if .Values.enableFeature </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{ printf </span><span class="st">&quot;feature-%s&quot;</span><span class="at"> .Values.featureName </span><span class="kw">}</span><span class="fu">}</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- end </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<h3 id="nested-keys-with-sprig-functions">Nested Keys with Sprig
Functions</h3>
<p>If we need to deal with nested keys, we can use <code>dict</code> and
<code>merge</code> functions together:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- $baseKey := </span><span class="st">&quot;app&quot;</span><span class="at"> -</span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- $env := .Values.environment -</span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- $nestedKey := printf </span><span class="st">&quot;%s-%s&quot;</span><span class="at"> $baseKey $env </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{- dict $nestedKey (dict </span><span class="st">&quot;enabled&quot;</span><span class="at"> true </span><span class="st">&quot;replicas&quot;</span><span class="at"> .Values.replicas) | toYaml | indent 2 </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<h3 id="practical-example">Practical Example</h3>
<p>Here is a full example that combines several Sprig functions:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}-config</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at">{- range $index</span><span class="kw">,</span><span class="at"> $value := .Values.services </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at">{ printf </span><span class="st">&quot;service-%d&quot;</span><span class="at"> $index </span><span class="kw">}</span><span class="fu">}</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ $value.url </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ $value.port </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at">{- end </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<p>In this example, each service gets a special key based on its index.
This shows how we can use Sprig functions in Helm YAML files for
creating dynamic content.</p>
<p>Using Sprig functions well can really improve our Helm charts. It
allows us to have more dynamic and flexible settings. For more
information on Helm and what it can do, we can check <a
href="https://bestonlinetutorial.com/kubernetes/what-is-helm-and-how-does-it-help-with-kubernetes-deployments.html">this
related article</a>.</p>
<h2 id="how-can-we-handle-nested-keys-with-variables-in-helm-charts">How
Can We Handle Nested Keys with Variables in Helm Charts</h2>
<p>In Helm charts, we can handle nested keys in a smart way using
templating. We can use the <code>tpl</code> function to work with nested
keys based on variable values. Here is how we can manage nested keys in
our Helm charts.</p>
<h3 id="example-of-nested-keys">Example of Nested Keys</h3>
<p>Let’s say we have a structure in our <code>values.yaml</code> like
this:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">app</span><span class="kw">:</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">envs</span><span class="kw">:</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">production</span><span class="kw">:</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">replicaCount</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">staging</span><span class="kw">:</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">replicaCount</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span></code></pre></div>
<p>We can define a variable in our
<code>templates/deployment.yaml</code> that points to these nested keys
based on the environment we choose.</p>
<h3 id="templating-nested-keys">Templating Nested Keys</h3>
<p>We can use this syntax in our template files to get the nested
keys:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}-{{ .Values.app.env | quote }}</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.app.envs.[.Values.app.env].replicaCount </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">image</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;myapp:{{ .Values.image.tag }}&quot;</span></span></code></pre></div>
<h3 id="using-the-tpl-function">Using the <code>tpl</code> Function</h3>
<p>If we need to resolve our nested key while the program is running, we
can use the <code>tpl</code> function like this:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ tpl .Values.app.envs.[.Values.app.env].replicaCount . </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<h3 id="example-for-dynamic-nested-keys">Example for Dynamic Nested
Keys</h3>
<p>To create dynamic keys, we can do something like this:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">myConfig</span><span class="kw">:</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at">{- range $key</span><span class="kw">,</span><span class="at"> $value := .Values.app.envs </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at">{ $key </span><span class="kw">}</span><span class="fu">}</span><span class="kw">:</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">replicaCount</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ $value.replicaCount </span><span class="kw">}</span><span class="at">}</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at">{- end </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<h3 id="accessing-nested-values">Accessing Nested Values</h3>
<p>To get nested values from a specific variable, we can use:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="at">{ .Values.app.envs | toYaml | nindent 2 </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div>
<p>This way, we handle our nested keys well. It helps us have flexible
configurations based on the values we provide. For more details and to
learn more about Helm charts, we can check the article on <a
href="https://bestonlinetutorial.com/kubernetes/how-to-use-templating-variables-in-values-yaml-for-helm-in-kubernetes.html">how
to use templating variables in values.yaml for Helm</a>.</p>
<h2 id="how-can-we-debug-variable-key-issues-in-helm-charts">How Can We
Debug Variable Key Issues in Helm Charts</h2>
<p>Debugging variable key issues in Helm charts can be hard. We can
follow some simple steps to fix these problems.</p>
<ol type="1">
<li><p><strong>Use <code>helm template</code> Command</strong>: We can
render the templates on our local machine. This helps us see the
generated YAML. It shows us where the variables do not resolve
correctly.</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> template <span class="op">&lt;</span>release-name<span class="op">&gt;</span> <span class="op">&lt;</span>chart-directory<span class="op">&gt;</span> --values <span class="op">&lt;</span>values-file<span class="op">&gt;</span></span></code></pre></div></li>
<li><p><strong>Check Variable Definitions</strong>: We need to make sure
that the variables are set up correctly in <code>values.yaml</code>. We
also check if we pass them right through the command line or other ways
like environment variables.</p>
<p>Here is an example of how to define a variable in
<code>values.yaml</code>:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">config</span><span class="kw">:</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">key</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;value&quot;</span></span></code></pre></div></li>
<li><p><strong>Inspect Template Logic</strong>: We should look at the
logic in our template files. We can use
<code>{{ .Values.&lt;key&gt; }}</code> to get the variables. We need to
make sure that the key names match exactly in
<code>values.yaml</code>.</p>
<p>Here is a small template example:</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Release.Name </span><span class="kw">}</span><span class="at">}-config</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">key</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.config.key | quote </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div></li>
<li><p><strong>Enable Debugging</strong>: We can add the
<code>--debug</code> flag when we install or upgrade the chart. This
gives us detailed logs that can show issues with variable
substitution.</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install <span class="op">&lt;</span>release-name<span class="op">&gt;</span> <span class="op">&lt;</span>chart-directory<span class="op">&gt;</span> --values <span class="op">&lt;</span>values-file<span class="op">&gt;</span> --debug</span></code></pre></div></li>
<li><p><strong>Use Sprig Functions</strong>: If our variables need
changing, we can use Sprig functions. For example, we can use
<code>default</code> to give fallback values.</p>
<p>Here is how to use <code>default</code>:</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">key</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at">{ .Values.config.key | default </span><span class="st">&quot;default_value&quot;</span><span class="at"> | quote </span><span class="kw">}</span><span class="at">}</span></span></code></pre></div></li>
<li><p><strong>Check Scope and Context</strong>: We should understand
the scope of our variables. Nested values may need proper context to
work, especially in complex templates. We can use
<code>{{ .Values.&lt;parent&gt;.&lt;child&gt; }}</code> to access nested
values correctly.</p></li>
<li><p><strong>Inspect Logs and Events</strong>: We need to check the
logs of the Helm operation if there are errors. We can also check
Kubernetes events linked to the resources created from our chart.</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get events <span class="at">--sort-by</span><span class="op">=</span>.metadata.creationTimestamp</span></code></pre></div></li>
<li><p><strong>Dry Run</strong>: We can do a dry run of the installation
or upgrade. This shows how Helm reads our charts without making any
changes.</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install <span class="op">&lt;</span>release-name<span class="op">&gt;</span> <span class="op">&lt;</span>chart-directory<span class="op">&gt;</span> --dry-run <span class="at">--debug</span></span></code></pre></div></li>
</ol>
<p>With these steps, we can find and fix variable key issues in our Helm
charts. This way, our Kubernetes deployments will set up correctly. For
more information on Helm and Kubernetes templates, we can check <a
href="https://bestonlinetutorial.com/kubernetes/how-to-use-templating-variables-in-values-yaml-for-helm-in-kubernetes.html">this
resource</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3
id="what-are-the-benefits-of-using-variable-values-as-yaml-keys-in-helm-charts">1.
What are the benefits of using variable values as YAML keys in Helm
charts?</h3>
<p>Using variable values as YAML keys in Helm charts gives us more
flexibility. It helps us manage configurations better. This is
especially useful in complex Kubernetes setups. With Helm’s templating
tools, we can change our deployments based on different conditions. This
makes it easier to handle configurations for various clusters or
applications.</p>
<h3 id="how-do-i-define-dynamic-keys-in-my-helm-chart">2. How do I
define dynamic keys in my Helm chart?</h3>
<p>To define dynamic keys in a Helm chart, we can use the
<code>{{ .Values.variableName }}</code> format in our YAML files. This
lets us change static keys with values from our <code>values.yaml</code>
file or from the command line. This way, we can make our Helm charts
more flexible. They can adjust based on user inputs or specific
environment settings.</p>
<h3 id="can-i-handle-nested-keys-with-variables-in-helm-charts">3. Can I
handle nested keys with variables in Helm charts?</h3>
<p>Yes, we can handle nested keys with variables in Helm charts by using
dot notation. For example, we can refer to nested values like
<code>{{ .Values.parent.child }}</code>. This method helps us create
organized configurations. It makes it easier to manage and change our
Kubernetes resources.</p>
<h3 id="how-do-i-debug-issues-with-variable-keys-in-helm-charts">4. How
do I debug issues with variable keys in Helm charts?</h3>
<p>To debug issues with variable keys in Helm charts, we can use the
<code>helm template</code> command. This command shows our templates
locally so we can check the output. Also, we can add debug statements in
our templates using <code>{{- printf "%+v" .Values }}</code>. This helps
us see the current values context. It can help us find problems or
unexpected values in our Helm charts.</p>
<h3
id="what-are-sprig-functions-and-how-can-they-help-with-generating-keys-in-helm-yaml">5.
What are Sprig functions, and how can they help with generating keys in
Helm YAML?</h3>
<p>Sprig functions are a group of handy template functions that improve
the templating in Helm. We can use functions like <code>cat</code>,
<code>join</code>, or <code>replace</code> to change strings and create
dynamic keys in our YAML files. By using Sprig functions, we can make
our Helm charts more complex and responsive to different deployment
situations.</p>
<p>For more information on Kubernetes and Helm, we can check articles
like <a
href="https://bestonlinetutorial.com/kubernetes/what-is-helm-and-how-does-it-help-with-kubernetes-deployments.html">What
is Helm and How Does it Help with Kubernetes Deployments?</a> and <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-create-and-manage-helm-charts.html">How
Do I Create and Manage Helm Charts?</a>.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            