
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
            <!-- Google tag (gtag.js) -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
            <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-TFCQEJR7TD');
            </script>
            <meta charset="utf-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <!-- Common CSS & Icons -->
            <link rel="icon" href="/favicon.ico" type="image/x-icon">
            <link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
            <link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
            <link rel="stylesheet" href="/assets/css/post.css">
            <title>How Can You Connect to a Local Database from Inside a Minikube Cluster in Kubernetes?</title>
            <meta name="description" content="Learn to connect to a local database from a Minikube cluster in Kubernetes with our step-by-step guide and tips.">
            <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	        <script src="/assets/js/blog.js"></script>
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">How Can You Connect to a Local Database from Inside a Minikube Cluster in Kubernetes?</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>To connect to a local database from a Minikube cluster in Kubernetes,
we can use simple ways like port forwarding, making a Kubernetes
service, or using host networking. These methods help our Minikube pods
talk to the local database. This makes it easier for us to develop and
test.</p>
<p>In this article, we will look at different ways to connect to a local
database from a Minikube cluster. We will also check what we need to set
up first. We will discuss methods like exposing our local database with
port forwarding, using Kubernetes services, connecting via host
networking, and setting up Minikube to work with Ingress. At the end, we
will answer some common questions about this topic.</p>
<ul>
<li>How to Connect to a Local Database from Inside a Minikube Cluster in
Kubernetes</li>
<li>What Are the Prerequisites for Connecting to a Local Database in
Minikube</li>
<li>How Can You Expose a Local Database to Minikube Using Port
Forwarding</li>
<li>What Is the Best Way to Use a Kubernetes Service to Access a Local
Database</li>
<li>How Can You Connect to a Local Database from a Minikube Pod Using
Host Networking</li>
<li>How to Configure Minikube to Use a Local Database with Ingress</li>
<li>Frequently Asked Questions</li>
</ul>
<p>For more information about Kubernetes and how it works, you can check
articles about <a
href="https://bestonlinetutorial.com/kubernetes/what-is-kubernetes-and-how-does-it-simplify-container-management.html">how
Kubernetes simplifies container management</a> and <a
href="https://bestonlinetutorial.com/kubernetes/what-are-the-different-types-of-kubernetes-services.html">understanding
different types of Kubernetes services</a>.</p>
<h2
id="what-are-the-prerequisites-for-connecting-to-a-local-database-in-minikube">What
Are the Prerequisites for Connecting to a Local Database in
Minikube</h2>
<p>To connect to a local database from a Minikube cluster in Kubernetes,
we need to check some things first. Here are the steps we should
follow:</p>
<ol type="1">
<li><p><strong>Minikube Installation</strong>: We should install
Minikube and make sure it is running. You can follow the steps in the <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-install-minikube-for-local-kubernetes-development.html">Minikube
Installation Guide</a> to do this.</p></li>
<li><p><strong>Kubernetes Cluster Running</strong>: We need to check if
our Minikube cluster is up and running. We can do this by typing:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">minikube</span> status</span></code></pre></div></li>
<li><p><strong>Local Database Setup</strong>: We must have a local
database like MySQL or PostgreSQL installed and running on our machine.
Let’s test a local connection to make sure it works.</p></li>
<li><p><strong>Port Mapping</strong>: We should find out which port our
local database is using. For example, MySQL usually uses port
3306.</p></li>
<li><p><strong>Network Configuration</strong>: We have to set up our
local database to accept connections from Minikube. This might mean
changing the database’s settings to allow connections from the Minikube
IP range.</p></li>
<li><p><strong>Minikube IP Address</strong>: We need to get the Minikube
IP address. This helps us connect properly:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">minikube</span> ip</span></code></pre></div></li>
<li><p><strong>Database Credentials</strong>: We should have the
database login details ready. This includes the username and password we
need to connect from the Minikube pod.</p></li>
</ol>
<p>By checking these things, we can successfully connect to a local
database from our Minikube cluster in Kubernetes.</p>
<h2
id="how-can-we-expose-a-local-database-to-minikube-using-port-forwarding">How
Can We Expose a Local Database to Minikube Using Port Forwarding</h2>
<p>To expose a local database to Minikube using port forwarding, we can
follow these steps:</p>
<ol type="1">
<li><p><strong>Start Minikube</strong>: First, we need to make sure our
Minikube cluster is running.</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">minikube</span> start</span></code></pre></div></li>
<li><p><strong>Get the Local Database IP Address</strong>: Next, we
should find the IP address of our local database. For example, if we use
MySQL, it runs on <code>localhost:3306</code>.</p></li>
<li><p><strong>Create a Kubernetes Deployment</strong>: Now, we create a
Kubernetes deployment for our application that connects to the local
database. Here is an example YAML file for a simple application:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-app-image:latest</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> DB_HOST</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;host.docker.internal&quot;</span><span class="co">  # We use this to access the host&#39;s network</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> DB_PORT</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;3306&quot;</span></span></code></pre></div></li>
<li><p><strong>Apply the Deployment</strong>: After we create the YAML
file, we apply it.</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> my-app-deployment.yaml</span></code></pre></div></li>
<li><p><strong>Use Port Forwarding</strong>: Now, we forward the port
from our local machine to the Minikube cluster. If our database runs on
port 3306 and our app’s service exposes it on port 8080, we run:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> port-forward deployment/my-app 8080:80</span></code></pre></div></li>
<li><p><strong>Access the Database</strong>: With port forwarding on, we
can access our local database through the Minikube pod using the
forwarded port. For example, we can connect using a database client with
this connection string:</p>
<pre class="plaintext"><code>mysql -h 127.0.0.1 -P 8080 -u your-username -p</code></pre></li>
</ol>
<p>This setup helps our Minikube application to work with a local
database easily using port forwarding. We should change IP addresses and
ports based on our specific setup. For more help on Kubernetes
deployments, check out <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-deploy-a-simple-web-application-on-kubernetes.html">this
article</a>.</p>
<h2
id="what-is-the-best-way-to-use-a-kubernetes-service-to-access-a-local-database">What
Is the Best Way to Use a Kubernetes Service to Access a Local
Database</h2>
<p>To get to a local database from a Minikube cluster with a Kubernetes
Service, we can follow these steps.</p>
<ol type="1">
<li><p><strong>Deploy Your Local Database</strong>: First, make sure
your local database is working and can be reached. For example, if we
use MySQL, it should be running on <code>localhost:3306</code>.</p></li>
<li><p><strong>Create a Kubernetes Service</strong>: Next, we need to
set up a Service in Kubernetes to show our local database. We can use
this YAML configuration. We might need to change <code>spec.ports</code>
and <code>spec.selector</code> if needed.</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> local-db-service</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> NodePort</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">3306</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">3306</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">nodePort</span><span class="kw">:</span><span class="at"> </span><span class="dv">30000</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-database-app</span></span></code></pre></div></li>
<li><p><strong>Apply the Service Configuration</strong>: Now, we can use
<code>kubectl</code> to create the Service in our Minikube cluster:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> local-db-service.yaml</span></code></pre></div></li>
<li><p><strong>Access the Local Database from a Pod</strong>: After
that, we need to create a Pod that can connect to the local database.
Here is an example of a Pod manifest:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Pod</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> db-client</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> client</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> mysql:5.7</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> MYSQL_HOST</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;localhost&quot;</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> MYSQL_PORT</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;3306&quot;</span></span></code></pre></div></li>
<li><p><strong>Connect Using the Service</strong>: In our app or
database client inside the Pod, we can connect to the local database
using the Service name:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mysql</span> <span class="at">-h</span> local-db-service <span class="at">-P</span> 3306 <span class="at">-u</span> your-username <span class="at">-p</span></span></code></pre></div></li>
<li><p><strong>Alternative Access Method</strong>: If we want to use
NodePort to access the database, we can use the Minikube IP and NodePort
like this:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">minikube</span> ip</span></code></pre></div>
<p>Then we can connect to the database like this:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mysql</span> <span class="at">-h</span> <span class="op">&lt;</span>MINIKUBE_IP<span class="op">&gt;</span> -P 30000 <span class="at">-u</span> your-username <span class="at">-p</span></span></code></pre></div></li>
</ol>
<p>This way, we can use a Kubernetes Service to manage access to a local
database from inside a Minikube cluster. For more details on Kubernetes
Services, we can check <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-services-and-how-do-they-expose-applications.html">this
article</a>.</p>
<h2
id="how-can-we-connect-to-a-local-database-from-a-minikube-pod-using-host-networking">How
Can We Connect to a Local Database from a Minikube Pod Using Host
Networking</h2>
<p>To connect a Minikube pod to a local database with host networking,
we need to set up the pod to use the host’s network. This lets the pod
access services on the host just like they are part of the pod. Here are
the steps to do this.</p>
<ol type="1">
<li><p><strong>Start Minikube with Host Network</strong>: First, we have
to start Minikube with the <code>--network</code> option set to
<code>host</code>.</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">minikube</span> start <span class="at">--network</span><span class="op">=</span>host</span></code></pre></div></li>
<li><p><strong>Create Pod Configuration</strong>: Next, we use a
Kubernetes pod configuration YAML file to set host networking.</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Pod</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> db-connector</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">hostNetwork</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> db-client</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">image</span><span class="kw">:</span><span class="at"> your-database-client-image</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">command</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">&quot;your-command-to-connect-to-db&quot;</span><span class="kw">]</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> DB_HOST</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;localhost&quot;</span><span class="co">  # We assume the database is running on the host</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> DB_PORT</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;5432&quot;</span><span class="co">  # Change this according to your database port</span></span></code></pre></div></li>
<li><p><strong>Deploy the Pod</strong>: Now we apply the configuration
to create the pod.</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> pod-config.yaml</span></code></pre></div></li>
<li><p><strong>Access the Database</strong>: When the pod is running, it
can connect to the local database using <code>localhost</code> as the
hostname.</p></li>
<li><p><strong>Check Pod Logs</strong>: We can check the pod logs to
make sure the connection works and see the operations.</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> logs db-connector</span></code></pre></div></li>
</ol>
<p>Using host networking helps the pod to talk to services on the host
machine directly. This makes it simple to connect to a local database
from a Minikube cluster. For more information on Kubernetes networking
and services, we can look at <a
href="https://bestonlinetutorial.com/kubernetes/how-does-kubernetes-networking-work.html">how
does Kubernetes networking work</a>.</p>
<h2
id="how-to-configure-minikube-to-use-a-local-database-with-ingress">How
to Configure Minikube to Use a Local Database with Ingress</h2>
<p>To configure Minikube to connect to a local database with Ingress, we
can follow these steps.</p>
<ol type="1">
<li><p><strong>Enable Ingress Add-on</strong>: First, we need to enable
the Ingress add-on in our Minikube cluster.</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">minikube</span> addons enable ingress</span></code></pre></div></li>
<li><p><strong>Deploy a Local Database</strong>: For instance, we can
deploy a MySQL database locally. We have to create a deployment and
service for MySQL.</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> mysql</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> mysql</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> mysql</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> mysql</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">image</span><span class="kw">:</span><span class="at"> mysql:5.7</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> MYSQL_ROOT_PASSWORD</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">value</span><span class="kw">:</span><span class="at"> rootpassword</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">3306</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> mysql</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">3306</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">3306</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">app</span><span class="kw">:</span><span class="at"> mysql</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClusterIP</span></span></code></pre></div></li>
<li><p><strong>Create an Ingress Resource</strong>: Next, we need to
define an Ingress resource to expose the MySQL service. Ingress usually
handles HTTP/S traffic. This example may not work directly for MySQL,
which we access over TCP. But for the example, here is how to define an
Ingress resource:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> networking.k8s.io/v1</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Ingress</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> mysql-ingress</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">rules</span><span class="kw">:</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> mysql.local</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">http</span><span class="kw">:</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">paths</span><span class="kw">:</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">pathType</span><span class="kw">:</span><span class="at"> Prefix</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">backend</span><span class="kw">:</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">name</span><span class="kw">:</span><span class="at"> mysql</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">port</span><span class="kw">:</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">number</span><span class="kw">:</span><span class="at"> </span><span class="dv">3306</span></span></code></pre></div></li>
<li><p><strong>Update /etc/hosts</strong>: We should add an entry to our
local <code>/etc/hosts</code> file. This will resolve
<code>mysql.local</code> to the Minikube IP.</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$(</span><span class="ex">minikube</span> ip<span class="va">)</span><span class="st"> mysql.local&quot;</span> <span class="kw">|</span> <span class="fu">sudo</span> tee <span class="at">-a</span> /etc/hosts</span></code></pre></div></li>
<li><p><strong>Access the Database</strong>: Now we can access the local
MySQL database from our Minikube cluster using the hostname
<code>mysql.local</code>.</p></li>
<li><p><strong>Test the Connection</strong>: We can connect to the
database from a pod in our Minikube cluster using a MySQL client.</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> run <span class="at">-i</span> <span class="at">--tty</span> <span class="at">--rm</span> debug <span class="at">--image</span><span class="op">=</span>mysql:5.7 <span class="at">--</span> mysql <span class="at">-h</span> mysql.local <span class="at">-uroot</span> <span class="at">-prootpassword</span></span></code></pre></div></li>
</ol>
<p>This process helps us configure Minikube to use a local database with
Ingress. It makes the database available to our applications that run in
the Kubernetes environment. For more info on deploying databases in
Kubernetes, we can check <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-deploy-a-stateful-application-e-g-mysql-on-kubernetes.html">how
to deploy a stateful application e.g., MySQL on Kubernetes</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3 id="how-do-we-connect-to-a-local-database-from-a-minikube-pod">1.
How do we connect to a local database from a Minikube pod?</h3>
<p>We can connect to a local database from a Minikube pod in a few ways.
One way is to use port forwarding. We use this command:
<code>kubectl port-forward &lt;pod-name&gt; &lt;local-port&gt;:&lt;db-port&gt;</code>.
This lets us access the local database as if it is running inside the
Minikube cluster. We need to make sure that our database is set to
accept connections from the Minikube IP.</p>
<h3
id="what-are-the-prerequisites-for-connecting-to-a-local-database-in-minikube-1">2.
What are the prerequisites for connecting to a local database in
Minikube?</h3>
<p>Before we connect to a local database in Minikube, we need to ensure
that Minikube is installed and running well. We also need access to the
local database with the right credentials. It is important to set up the
database to allow connections from the Minikube network. Knowing some
Kubernetes concepts like pods, services, and networking will help us
too.</p>
<h3
id="how-can-we-expose-a-local-database-to-minikube-using-port-forwarding-1">3.
How can we expose a local database to Minikube using port
forwarding?</h3>
<p>To expose a local database to our Minikube cluster, we can use the
<code>kubectl port-forward</code> command. This command connects our
local machine and the Minikube pod. For example, using
<code>kubectl port-forward svc/my-database 5432:5432</code> will forward
requests from our local port 5432 to the Minikube service. This way, the
pods can easily access the database.</p>
<h3
id="what-is-the-best-way-to-use-a-kubernetes-service-to-access-a-local-database-1">4.
What is the best way to use a Kubernetes Service to access a local
database?</h3>
<p>The best way to access a local database from our Minikube cluster is
by creating a Kubernetes Service. We can define a <code>Service</code>
with type <code>NodePort</code> or <code>ClusterIP</code> that points to
the local database. This helps our applications running in Minikube to
talk to the database using the service name. It makes things easier than
connecting directly to the database.</p>
<h3
id="can-we-use-host-networking-to-connect-to-a-local-database-from-a-minikube-pod">5.
Can we use host networking to connect to a local database from a
Minikube pod?</h3>
<p>Yes, we can connect to a local database from a Minikube pod using
host networking. If we set <code>hostNetwork: true</code> in our pod’s
configuration, the pod will share the network with the host. This lets
the pod access services running on the host machine, including a local
database, just like any other local app.</p>
<p>For more information about Kubernetes and Minikube, we can look at
these resources: <a
href="https://bestonlinetutorial.com/kubernetes/what-is-kubernetes-and-how-does-it-simplify-container-management.html">What
is Kubernetes and how does it simplify container management?</a>, <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-install-minikube-for-local-kubernetes-development.html">How
do I install Minikube for local Kubernetes development?</a>, and <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-services-and-how-do-they-expose-applications.html">What
are Kubernetes services and how do they expose applications?</a>.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            