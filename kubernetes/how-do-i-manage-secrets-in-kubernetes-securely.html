
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TFCQEJR7TD');
</script>
            <title>How Do I Manage Secrets in Kubernetes Securely?</title>
            <meta name="description" content="Discover effective strategies to manage secrets in Kubernetes securely. Learn best practices for safeguarding sensitive data.">

            <div id="head-placeholder"></div>
            <script src="/assets/js/blog.js" defer></script>
            <link rel="stylesheet" href="/assets/css/post.css">
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">How Do I Manage Secrets in Kubernetes Securely?</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>Managing secrets in Kubernetes is very important for keeping
sensitive info safe. This includes things like passwords, OAuth tokens,
and SSH keys in our container applications. In Kubernetes, secrets are
special objects that hold this private data. They make sure that only
the right apps and users can access it. If we manage these secrets the
right way, we help keep our applications safe from unauthorized
access.</p>
<p>In this article, we will look at how to manage secrets in Kubernetes
in a secure way. We will talk about why secrets are important. We will
also learn how to create and access secrets in pods. We will go over
ways to encrypt secrets and best practices for managing them. We will
check out external tools for managing secrets too. There will be some
real-life examples of managing secrets in Kubernetes. Lastly, we will
discuss how to rotate secrets and answer some common questions.</p>
<ul>
<li>How Can I Manage Secrets in Kubernetes Securely?</li>
<li>Why Are Secrets Important in Kubernetes?</li>
<li>How to Create Secrets in Kubernetes?</li>
<li>How to Access Secrets in Pods?</li>
<li>How Can I Encrypt Secrets in Kubernetes?</li>
<li>What Are Best Practices for Managing Secrets in Kubernetes?</li>
<li>How to Use External Secret Management Tools with Kubernetes?</li>
<li>What Are Real Life Use Cases for Managing Secrets in
Kubernetes?</li>
<li>How to Rotate Secrets in Kubernetes?</li>
<li>Frequently Asked Questions</li>
</ul>
<p>If you want to learn more about Kubernetes and what it can do, you
can read these articles: <a
href="https://bestonlinetutorial.com/kubernetes/what-is-kubernetes-and-how-does-it-simplify-container-management.html">What
is Kubernetes and How Does it Simplify Container Management?</a>, <a
href="https://bestonlinetutorial.com/kubernetes/why-should-i-use-kubernetes-for-my-applications.html">Why
Should I Use Kubernetes for My Applications?</a>, and <a
href="https://bestonlinetutorial.com/kubernetes/what-are-the-key-components-of-a-kubernetes-cluster.html">What
Are the Key Components of a Kubernetes Cluster?</a>.</p>
<h2 id="why-are-secrets-important-in-kubernetes">Why Are Secrets
Important in Kubernetes?</h2>
<p>Secrets in Kubernetes are very important for handling sensitive
information. This includes passwords, OAuth tokens, SSH keys, and API
keys. Secrets help us store and manage sensitive data safely. They make
sure this data is not shown in plain text in our application code or
configuration files. Here are some simple reasons why secrets
matter:</p>
<ul>
<li><p><strong>Security</strong>: Secrets are base64 encoded and kept in
etcd. This is Kubernetesâ€™ storage. We can secure this data with
encryption. This helps to lower the risk of accidental
exposure.</p></li>
<li><p><strong>Access Control</strong>: Kubernetes uses Role-Based
Access Control (RBAC). This lets us manage who can see secrets. Only
authorized users and apps can access sensitive data.</p></li>
<li><p><strong>Dynamic Configuration</strong>: Secrets let applications
get sensitive data while they run. This means we do not need to hardcode
secrets into container images.</p></li>
<li><p><strong>Audit and Compliance</strong>: We can audit Kubernetes
secrets. This helps us track who accesses them and how they are used.
This is important for meeting compliance needs.</p></li>
<li><p><strong>Integration with CI/CD</strong>: We can easily add
secrets to Continuous Integration/Continuous Deployment (CI/CD)
pipelines. This allows secure access to sensitive data during
deployment.</p></li>
</ul>
<p>For example, to create a secret with a password, we can use this
command:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> create secret generic my-secret <span class="at">--from-literal</span><span class="op">=</span>password=mysecretpassword</span></code></pre></div>
<p>This command makes a secret called <code>my-secret</code>. It has a
key named <code>password</code> that holds the value
<code>mysecretpassword</code>. It is very important to access and manage
these secrets well. This helps keep the security of our applications
that run in Kubernetes environments. If we want to know more about
managing Kubernetes, we can read about <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-configmaps-and-how-do-i-use-them.html">what
are Kubernetes ConfigMaps and how do I use them</a>.</p>
<h2 id="how-to-create-secrets-in-kubernetes">How to Create Secrets in
Kubernetes?</h2>
<p>To create secrets in Kubernetes, we can use the <code>kubectl</code>
command-line tool or write secrets in a YAML file. Kubernetes Secrets
can hold important data like passwords, OAuth tokens, and SSH keys.</p>
<h3 id="using-kubectl-command">Using <code>kubectl</code> Command</h3>
<p>We can create a secret from literal values or files.</p>
<p><strong>Example of creating a secret using literals:</strong></p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> create secret generic my-secret <span class="at">--from-literal</span><span class="op">=</span>username=admin <span class="at">--from-literal</span><span class="op">=</span>password=secret123</span></code></pre></div>
<p><strong>Example of creating a secret from a file:</strong></p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> create secret generic my-secret <span class="at">--from-file</span><span class="op">=</span>ssh-privatekey=path/to/private.key <span class="at">--from-file</span><span class="op">=</span>ssh-publickey=path/to/public.key</span></code></pre></div>
<h3 id="using-yaml-configuration">Using YAML Configuration</h3>
<p>We can also write our secret in a YAML file and make it with
<code>kubectl apply</code>.</p>
<p><strong>Example YAML file (secret.yaml):</strong></p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Secret</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-secret</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">type</span><span class="kw">:</span><span class="at"> Opaque</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">username</span><span class="kw">:</span><span class="at"> YWRtaW4=</span><span class="co">  # Base64 encoded value of &#39;admin&#39;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">password</span><span class="kw">:</span><span class="at"> c2VjcmV0MTIz</span><span class="co">  # Base64 encoded value of &#39;secret123&#39;</span></span></code></pre></div>
<p><strong>To create the secret from the YAML file:</strong></p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> secret.yaml</span></code></pre></div>
<h3 id="viewing-secrets">Viewing Secrets</h3>
<p>To check if the secret is created, we can use:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get secrets</span></code></pre></div>
<p>To see details of a specific secret:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> describe secret my-secret</span></code></pre></div>
<p>Keep in mind that secrets are in Base64. We should not store
important data in plain text in our YAML files. For more details on
Kubernetes objects, see <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-configmaps-and-how-do-i-use-them.html">what
are Kubernetes ConfigMaps and how do I use them</a>.</p>
<h2 id="how-to-access-secrets-in-pods">How to Access Secrets in
Pods?</h2>
<p>We can access secrets in Kubernetes pods using two main ways. We can
mount secrets as files in a volume or we can expose them as environment
variables.</p>
<h3 id="mounting-secrets-as-files">Mounting Secrets as Files</h3>
<ol type="1">
<li><p><strong>Create a Secret</strong>:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> create secret generic my-secret <span class="at">--from-literal</span><span class="op">=</span>username=my-user <span class="at">--from-literal</span><span class="op">=</span>password=my-password</span></code></pre></div></li>
<li><p><strong>Define a Pod that mounts the Secret</strong>:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Pod</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> secret-volume-pod</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> secret-volume-container</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> nginx</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">volumeMounts</span><span class="kw">:</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> secret-volume</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">mountPath</span><span class="kw">:</span><span class="at"> /etc/secret</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> secret-volume</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">secret</span><span class="kw">:</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">secretName</span><span class="kw">:</span><span class="at"> my-secret</span></span></code></pre></div>
<p>In this setup, we mount the secrets to <code>/etc/secret</code>
inside the pod.</p></li>
</ol>
<h3 id="using-environment-variables">Using Environment Variables</h3>
<ol type="1">
<li><p><strong>Define a Pod that uses the Secret as Environment
Variables</strong>:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Pod</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> secret-env-pod</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> secret-env-container</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> nginx</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> USERNAME</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">valueFrom</span><span class="kw">:</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">secretKeyRef</span><span class="kw">:</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-secret</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">key</span><span class="kw">:</span><span class="at"> username</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> PASSWORD</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">valueFrom</span><span class="kw">:</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">secretKeyRef</span><span class="kw">:</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-secret</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">key</span><span class="kw">:</span><span class="at"> password</span></span></code></pre></div>
<p>Here, we can access the secrets as environment variables
<code>USERNAME</code> and <code>PASSWORD</code>.</p></li>
</ol>
<h3 id="accessing-the-secrets-in-the-application">Accessing the Secrets
in the Application</h3>
<p>In our application that runs in the pod, we can access the secrets
like this:</p>
<ul>
<li>If we mounted them as files, we read from
<code>/etc/secret/username</code> and
<code>/etc/secret/password</code>.</li>
<li>If we set them as environment variables, we use
<code>process.env.USERNAME</code> and <code>process.env.PASSWORD</code>
in Node.js. We can also use the right method in whatever language our
application uses.</li>
</ul>
<p>This way, we keep sensitive information safe but still let our
applications in Kubernetes access it. For more info on managing secrets
in Kubernetes, check out <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-configmaps-and-how-do-i-use-them.html">this
article on managing secrets in Kubernetes</a>.</p>
<h2 id="how-can-i-encrypt-secrets-in-kubernetes">How Can I Encrypt
Secrets in Kubernetes?</h2>
<p>To keep secrets safe in Kubernetes, we need to use encryption. We
should do this for both storage and communication. Kubernetes can
encrypt secrets when they are stored. Letâ€™s see how to set it up.</p>
<ol type="1">
<li><p><strong>Enable Encryption at Rest</strong>: We need to change the
Kubernetes API server settings to encrypt secrets in etcd.</p>
<ul>
<li>First, create a file for encryption settings called
<code>encryption-config.yaml</code>:</li>
</ul>
<div class="sourceCode" id="cb11"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> EncryptionConfig</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> secrets</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">providers</span><span class="kw">:</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">aescbc</span><span class="kw">:</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">keys</span><span class="kw">:</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> key1</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">secret</span><span class="kw">:</span><span class="at"> &lt;base64-encoded-32-byte-key&gt;</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">identity</span><span class="kw">:</span><span class="at"> </span><span class="kw">{}</span></span></code></pre></div>
<p>Change <code>&lt;base64-encoded-32-byte-key&gt;</code> to a
base64-encoded key that is 32 bytes long.</p></li>
<li><p><strong>Update the API Server</strong>: Add this flag when you
start your kube-apiserver:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--encryption-provider-config=/path/to/encryption-config.yaml</span></span></code></pre></div></li>
<li><p><strong>Verify Encryption</strong>: After we set up the API
server, we create a secret and check how it is stored in etcd. To create
a secret, use this command:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> create secret generic mysecret <span class="at">--from-literal</span><span class="op">=</span>password=<span class="st">&#39;mypassword&#39;</span></span></code></pre></div>
<p>Next, check etcd. Make sure etcdctl is set up:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">etcdctl</span> get /registry/secrets/default/mysecret</span></code></pre></div>
<p>You will see the secret is encrypted, not in plain text.</p></li>
<li><p><strong>Encrypt Secrets in Transit</strong>: We should secure the
connection to the API server with TLS. We can set our services and
applications to use HTTPS to keep data safe when it is sent.</p></li>
<li><p><strong>Use External Secret Management Tools</strong>: We can
also use tools like HashiCorp Vault, AWS Secrets Manager, or Azure Key
Vault for better secret management. For example, with HashiCorp
Vault:</p>
<ul>
<li>Install and set up Vault.</li>
<li>Use the Kubernetes authentication method in Vault to let service
accounts access secrets safely.</li>
</ul></li>
</ol>
<p>For more information about managing Kubernetes secrets, we can check
this article on <a
href="https://bestonlinetutorial.com/kubernetes/why-should-i-use-kubernetes-for-my-applications.html">why
should I use Kubernetes for my applications</a>.</p>
<h2 id="what-are-best-practices-for-managing-secrets-in-kubernetes">What
Are Best Practices for Managing Secrets in Kubernetes?</h2>
<p>Managing secrets in Kubernetes is very important for keeping safe
sensitive information like passwords, tokens, and keys. Here are some
best practices for managing secrets in Kubernetes:</p>
<ol type="1">
<li><p><strong>Use Kubernetes Secrets</strong>: We should store
sensitive information as Kubernetes Secrets. Do not hardcode them in
application code or ConfigMaps.</p>
<p>Here is an example to create a secret:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> create secret generic my-secret <span class="at">--from-literal</span><span class="op">=</span>username=myuser <span class="at">--from-literal</span><span class="op">=</span>password=mypassword</span></code></pre></div></li>
<li><p><strong>Limit Access</strong>: We need to apply the principle of
least privilege. This means restricting access to secrets using
Kubernetes Role-Based Access Control (RBAC). Define roles and role
bindings. This ensures only authorized users and applications can access
secrets.</p></li>
<li><p><strong>Encrypt Secrets at Rest</strong>: We should enable
encryption for secrets stored in etcd. You can configure encryption by
updating the Kubernetes API server configuration.</p>
<p>Here is an example of encryption configuration:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apiserver.k8s.io/v1</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> EncryptionConfiguration</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> secrets</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">providers</span><span class="kw">:</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">aescbc</span><span class="kw">:</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">keys</span><span class="kw">:</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> key1</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">secret</span><span class="kw">:</span><span class="at"> &lt;base64-encoded-key&gt;</span></span></code></pre></div></li>
<li><p><strong>Use External Secret Management Tools</strong>: We can
think about using external tools like HashiCorp Vault or AWS Secrets
Manager. This helps us manage secrets outside of Kubernetes. It gives us
better security and auditing.</p></li>
<li><p><strong>Avoid Exposing Secrets in Environment Variables</strong>:
Instead of passing secrets as environment variables, we should use
mounted secrets as files in our pods. This reduces the risk of
unintentional exposure in logs or process lists.</p>
<p>Here is an example of mounting a secret:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Pod</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> mypod</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> mycontainer</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">image</span><span class="kw">:</span><span class="at"> myimage</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">volumeMounts</span><span class="kw">:</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> secret-volume</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">mountPath</span><span class="kw">:</span><span class="at"> /etc/secret</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> secret-volume</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">secret</span><span class="kw">:</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">secretName</span><span class="kw">:</span><span class="at"> my-secret</span></span></code></pre></div></li>
<li><p><strong>Regularly Rotate Secrets</strong>: We should have a plan
for regularly rotating secrets. This helps to reduce the risk of
unauthorized access. Automate this process if we can.</p></li>
<li><p><strong>Audit Access to Secrets</strong>: We need to enable audit
logging. This helps us track access to secrets. It helps in finding any
unauthorized access attempts and keeping compliance.</p></li>
<li><p><strong>Use Network Policies</strong>: We should apply network
policies to control traffic between pods. Limit which pods can talk to
those that handle secrets.</p></li>
<li><p><strong>Label and Organize Secrets</strong>: We can use labels to
organize our secrets well. This helps us find and manage secrets in
different environments.</p></li>
<li><p><strong>Educate Teams</strong>: We should make sure that all team
members know the importance of secret management. They need to follow
best practices for handling sensitive information.</p></li>
</ol>
<p>If we follow these best practices for managing secrets in Kubernetes,
we can secure sensitive information. This way, our applications stay
safe from unauthorized access and possible vulnerabilities. For more
details on Kubernetes secrets, you can check <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-manage-the-lifecycle-of-a-kubernetes-pod.html">this
article on managing the lifecycle of Kubernetes objects</a>.</p>
<h2 id="how-to-use-external-secret-management-tools-with-kubernetes">How
to Use External Secret Management Tools with Kubernetes?</h2>
<p>We can make our Kubernetes more secure by using external secret
management tools. These tools help us store sensitive information
outside the cluster. Some popular tools are HashiCorp Vault, AWS Secrets
Manager, and Azure Key Vault. Here is how we can use them easily.</p>
<h3 id="hashicorp-vault">HashiCorp Vault</h3>
<ol type="1">
<li><strong>Installation</strong>: We can deploy Vault on our own
servers or use a managed service.</li>
<li><strong>Configuration</strong>: We need to enable Kubernetes
authentication in Vault.</li>
</ol>
<div class="sourceCode" id="cb18"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">vault</span> auth enable kubernetes</span></code></pre></div>
<ol start="3" type="1">
<li><strong>Role Creation</strong>: We create a role in Vault. This role
defines what Kubernetes service accounts can do.</li>
</ol>
<div class="sourceCode" id="cb19"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="ex">vault</span> write auth/kubernetes/role/my-role <span class="dt">\</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    bound_service_account_names=my-service-account <span class="dt">\</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    bound_service_account_namespaces=my-namespace <span class="dt">\</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    policies=my-policy <span class="dt">\</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    ttl=1h</span></code></pre></div>
<ol start="4" type="1">
<li><strong>Accessing Secrets</strong>: We use the Kubernetes service
account token. This helps us to authenticate and get secrets.</li>
</ol>
<div class="sourceCode" id="cb20"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">vault</span> kv get secret/my-secret</span></code></pre></div>
<ol start="5" type="1">
<li><strong>Kubernetes Deployment Example</strong>:</li>
</ol>
<div class="sourceCode" id="cb21"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">serviceAccountName</span><span class="kw">:</span><span class="at"> my-service-account</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-container</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-image</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> MY_SECRET</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">valueFrom</span><span class="kw">:</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">secretKeyRef</span><span class="kw">:</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-secret</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">key</span><span class="kw">:</span><span class="at"> secret-key</span></span></code></pre></div>
<h3 id="aws-secrets-manager">AWS Secrets Manager</h3>
<ol type="1">
<li><strong>Create Secret</strong>: We store our secret in AWS Secrets
Manager.</li>
</ol>
<div class="sourceCode" id="cb22"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> secretsmanager create-secret <span class="at">--name</span> MySecret <span class="at">--secret-string</span> <span class="st">&#39;{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;password&quot;}&#39;</span></span></code></pre></div>
<ol start="2" type="1">
<li><p><strong>IAM Role</strong>: We need to make sure our Kubernetes
nodes have an IAM role. This role must have permission to access the
secret.</p></li>
<li><p><strong>Kubernetes Deployment Example</strong>:</p></li>
</ol>
<div class="sourceCode" id="cb23"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-container</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-image</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> MY_SECRET</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">valueFrom</span><span class="kw">:</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">secretKeyRef</span><span class="kw">:</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-secret</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">key</span><span class="kw">:</span><span class="at"> secret-key</span></span></code></pre></div>
<h3 id="azure-key-vault">Azure Key Vault</h3>
<ol type="1">
<li><strong>Create Key Vault</strong>: We set up an Azure Key Vault and
store our secrets there.</li>
</ol>
<div class="sourceCode" id="cb24"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="ex">az</span> keyvault create <span class="at">--name</span> MyKeyVault <span class="at">--resource-group</span> MyResourceGroup <span class="at">--location</span> westus</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="ex">az</span> keyvault secret set <span class="at">--vault-name</span> MyKeyVault <span class="at">--name</span> MySecret <span class="at">--value</span> <span class="st">&quot;secret-value&quot;</span></span></code></pre></div>
<ol start="2" type="1">
<li><p><strong>Access Policy</strong>: We give our Kubernetes
application access to the Key Vault.</p></li>
<li><p><strong>Kubernetes Deployment Example</strong>:</p></li>
</ol>
<div class="sourceCode" id="cb25"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-container</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-image</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> MY_SECRET</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">valueFrom</span><span class="kw">:</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">secretKeyRef</span><span class="kw">:</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-secret</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">key</span><span class="kw">:</span><span class="at"> secret-key</span></span></code></pre></div>
<h3 id="general-best-practices">General Best Practices</h3>
<ul>
<li><strong>Limit Access</strong>: We should use the principle of least
privilege for service accounts.</li>
<li><strong>Rotation</strong>: We need to rotate secrets regularly in
external tools.</li>
<li><strong>Audit</strong>: We enable logging and auditing for secret
access.</li>
<li><strong>Network Policies</strong>: We can use network policies to
restrict access to secret management tools.</li>
</ul>
<p>By following these steps and best practices, we can manage secrets in
Kubernetes safely using external secret management tools. For more
details about Kubernetes and its parts, we can check out <a
href="https://bestonlinetutorial.com/kubernetes/what-are-the-key-components-of-a-kubernetes-cluster.html">What
Are the Key Components of a Kubernetes Cluster?</a>.</p>
<h2
id="what-are-real-life-use-cases-for-managing-secrets-in-kubernetes">What
Are Real Life Use Cases for Managing Secrets in Kubernetes?</h2>
<p>Managing secrets in Kubernetes is very important for many real-life
uses in different industries. Here are some key examples that show why
secret management in Kubernetes matters and how we can use it:</p>
<ol type="1">
<li><p><strong>Database Credentials</strong>: Applications often need to
connect to databases safely. When we store database credentials as
Kubernetes secrets, we make sure they are not hard-coded in the
application code.</p>
<p>Example:</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> create secret generic db-credentials <span class="at">--from-literal</span><span class="op">=</span>username=myuser <span class="at">--from-literal</span><span class="op">=</span>password=mypassword</span></code></pre></div></li>
<li><p><strong>API Keys</strong>: When we use third-party services, we
can store API keys as secrets. This helps keep sensitive information out
of the source code and reduces the risk of it being exposed.</p>
<p>Example:</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> create secret generic api-key <span class="at">--from-literal</span><span class="op">=</span>key=12345abcde</span></code></pre></div></li>
<li><p><strong>TLS Certificates</strong>: For safe communication,
applications often need TLS certificates. We can use Kubernetes secrets
to hold these certificates for services.</p>
<p>Example:</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> create secret tls my-tls-secret <span class="at">--cert</span><span class="op">=</span>path/to/cert.crt <span class="at">--key</span><span class="op">=</span>path/to/key.key</span></code></pre></div></li>
<li><p><strong>Environment Variables</strong>: We can put secrets into
pods as environment variables. This gives sensitive configuration
without showing them in the pod specification.</p>
<p>Example:</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Pod</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> myapp</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> myapp-container</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> myapp-image</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> DB_USERNAME</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">valueFrom</span><span class="kw">:</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">secretKeyRef</span><span class="kw">:</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">name</span><span class="kw">:</span><span class="at"> db-credentials</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">key</span><span class="kw">:</span><span class="at"> username</span></span></code></pre></div></li>
<li><p><strong>Configuration Management</strong>: In microservices, it
is very important to manage configuration settings safely across many
services. We can use secrets to manage these configurations without
problems.</p></li>
<li><p><strong>Compliance and Audit</strong>: Some industries like
finance and healthcare have rules to follow. They use Kubernetes secrets
to keep sensitive information safe and to keep audit trails.</p></li>
<li><p><strong>Secret Rotation</strong>: It is very important to change
secrets like passwords and API keys regularly for security. Kubernetes
helps us automate the rotation of secrets without stopping the
service.</p></li>
<li><p><strong>Third-Party Integrations</strong>: When applications
connect to third-party services like S3 or Stripe, we need to manage the
credentials safely using Kubernetes secrets. This helps stop
unauthorized access.</p></li>
<li><p><strong>Multi-Environment Deployments</strong>: When applications
run in different environments like development, staging, and production,
we can manage secrets separately for each environment.</p></li>
</ol>
<h2 id="how-to-rotate-secrets-in-kubernetes">How to Rotate Secrets in
Kubernetes?</h2>
<p>Rotating secrets in Kubernetes is very important for keeping our
applications safe. It means we need to update our secrets and let our
applications know about the changes. Here is a simple way to manage
secret rotation:</p>
<ol type="1">
<li><p><strong>Create a New Secret</strong>: First, we should make a new
secret with the updated value. We can use the
<code>kubectl create secret</code> command.</p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> create secret generic my-secret <span class="at">--from-literal</span><span class="op">=</span>username=newuser <span class="at">--from-literal</span><span class="op">=</span>password=newpassword</span></code></pre></div></li>
<li><p><strong>Update the Deployment</strong>: Next, we need to change
the deployment to use the new secret. We can refer to the new secret in
our deployment manifest.</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-container</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-image</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> USERNAME</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">valueFrom</span><span class="kw">:</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">secretKeyRef</span><span class="kw">:</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-secret</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">key</span><span class="kw">:</span><span class="at"> username</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> PASSWORD</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">valueFrom</span><span class="kw">:</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">secretKeyRef</span><span class="kw">:</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-secret</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">key</span><span class="kw">:</span><span class="at"> password</span></span></code></pre></div></li>
<li><p><strong>Trigger a Rolling Update</strong>: After we update the
deployment, Kubernetes will do a rolling update. This will help schedule
the new pods with the updated secret.</p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> rollout restart deployment my-app</span></code></pre></div></li>
<li><p><strong>Clean Up Old Secrets</strong>: When the new pods are
running and working fine, we should delete the old secret. This helps to
reduce exposure.</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> delete secret old-secret</span></code></pre></div></li>
<li><p><strong>Automate Rotation</strong>: We can think about using
tools like <a
href="https://bestonlinetutorial.com/kubernetes/how-to-use-external-secret-management-tools-with-kubernetes.html">Kubernetes
External Secrets</a> or HashiCorp Vault. These tools can help us
automate secret management and rotation.</p></li>
</ol>
<p>By following these steps, we can make sure our secrets are rotated in
a safe and efficient way in Kubernetes. This will help to lower the risk
of unauthorized access.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3 id="what-are-kubernetes-secrets-and-why-are-they-important">1. What
are Kubernetes Secrets and why are they important?</h3>
<p>Kubernetes Secrets are objects that store sensitive data. This data
includes passwords, OAuth tokens, and SSH keys. They are very important
for keeping sensitive information safe in our Kubernetes apps. We can
manage these secrets without putting them directly in our application
code. For more about managing sensitive data in Kubernetes, check <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-secrets-and-how-do-i-use-them.html">Why
Are Secrets Important in Kubernetes?</a>.</p>
<h3 id="how-do-i-create-a-secret-in-kubernetes">2. How do I create a
secret in Kubernetes?</h3>
<p>We can create a secret in Kubernetes with the <code>kubectl</code>
command-line tool. For example, we can use this command to create a
generic secret:</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> create secret generic my-secret <span class="at">--from-literal</span><span class="op">=</span>username=myuser <span class="at">--from-literal</span><span class="op">=</span>password=mypassword</span></code></pre></div>
<p>This command keeps the username and password safe. For more steps on
creating secrets, refer to <a
href="https://bestonlinetutorial.com/kubernetes/how-to-create-secrets-in-kubernetes.html">How
to Create Secrets in Kubernetes?</a>.</p>
<h3 id="how-can-i-access-secrets-within-a-kubernetes-pod">3. How can I
access secrets within a Kubernetes pod?</h3>
<p>To access secrets in a Kubernetes pod, we can mount them as
environment variables or volumes. For example, to use a secret as an
environment variable, we write it in our pod specification like
this:</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> DB_PASSWORD</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">valueFrom</span><span class="kw">:</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">secretKeyRef</span><span class="kw">:</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-secret</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">key</span><span class="kw">:</span><span class="at"> password</span></span></code></pre></div>
<p>This way, our application can access the secret safely. For more
information, check <a
href="https://bestonlinetutorial.com/kubernetes/how-to-access-secrets-in-pods.html">How
to Access Secrets in Pods?</a>.</p>
<h3 id="how-do-i-encrypt-secrets-in-kubernetes">4. How do I encrypt
secrets in Kubernetes?</h3>
<p>To encrypt secrets in Kubernetes, we can turn on encryption at rest
by changing the Kubernetes API server settings. We need to update our
<code>EncryptionConfiguration</code> file to choose the encryption
providers we want. This makes sure our secrets are encrypted in the etcd
database, which makes them safer. For a detailed guide, see <a
href="https://bestonlinetutorial.com/kubernetes/how-can-i-encrypt-secrets-in-kubernetes.html">How
Can I Encrypt Secrets in Kubernetes?</a>.</p>
<h3 id="what-are-best-practices-for-managing-secrets-in-kubernetes-1">5.
What are best practices for managing secrets in Kubernetes?</h3>
<p>Best practices for managing secrets in Kubernetes include using
external secret management tools to store secrets. We should also use
RBAC to control who can access them and rotate secrets often to reduce
risk. Also, we must not show secrets in logs or error messages.
Following these practices helps us manage sensitive information safely
in Kubernetes. For more best practices, visit <a
href="https://bestonlinetutorial.com/kubernetes/what-are-best-practices-for-managing-secrets-in-kubernetes.html">What
Are Best Practices for Managing Secrets in Kubernetes?</a>.</p>
<p>By reading these frequently asked questions, we can better understand
how to manage secrets in Kubernetes safely. This way, our applications
stay safe and comply with security standards.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            