
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
            <!-- Google tag (gtag.js) -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
            <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-TFCQEJR7TD');
            </script>
            
            <title>Difference between targetPort and port in Kubernetes Service definition - kubernetes</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "BestOnlineTutorial",
      "url": "https://www.bestonlinetutorial.com/"
    }
    </script>

<!-- Common CSS & Icons -->
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
<link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
<link rel="stylesheet" href="/assets/css/post.css">
            <meta name="description" content="Learn the key differences between targetPort and port in Kubernetes Service definitions. Enhance your Kubernetes expertise today!">
            <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	        <script src="/assets/js/blog.js"></script>
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">Difference between targetPort and port in Kubernetes Service definition - kubernetes</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>In Kubernetes Service definitions, we need to understand the
difference between <code>targetPort</code> and <code>port</code>. This
difference is very important for our application networking. The
<code>port</code> field shows us the port that the service listens on.
The <code>targetPort</code> tells us the port on the container where the
traffic goes. Knowing this difference helps us make sure our services
work well. This way, different parts of our application can talk to each
other easily.</p>
<p>In this article, we will look at the differences between
<code>targetPort</code> and <code>port</code> in Kubernetes Service
definitions. We want to make their roles clear. We will talk about how
<code>port</code> works, what <code>targetPort</code> does, and how to
use these fields in the right way. We will also discuss common mistakes,
best practices for writing them in YAML, and answer some frequently
asked questions about Kubernetes Service setups.</p>
<ul>
<li>Difference between <code>targetPort</code> and <code>port</code> in
Kubernetes Services</li>
<li>Understanding the role of <code>port</code> in Kubernetes Service
definitions</li>
<li>Exploring the functionality of <code>targetPort</code> in Kubernetes
Services</li>
<li>How to use <code>targetPort</code> and <code>port</code> effectively
in Kubernetes</li>
<li>Common misconfigurations between <code>targetPort</code> and
<code>port</code> in Kubernetes Services</li>
<li>Best practices for defining <code>targetPort</code> and
<code>port</code> in Kubernetes Service YAML</li>
<li>Frequently asked questions about Kubernetes Service definitions</li>
</ul>
<h2
id="understanding-the-role-of-port-in-kubernetes-service-definitions">Understanding
the Role of port in Kubernetes Service Definitions</h2>
<p>In Kubernetes, we use the <code>port</code> property in a Service
definition to tell which port the service is open to clients. Other pods
or outside clients use this port to reach the service. It works as a way
for the service to communicate.</p>
<h3 id="basic-configuration">Basic Configuration</h3>
<p>Here is a simple example of a Kubernetes Service definition with the
<code>port</code> property:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-service</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClusterIP</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span><span class="co">          # The port exposed by the service</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span><span class="co">  # The port on the pod</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span></code></pre></div>
<h3 id="key-features-of-the-port-property">Key Features of the
<code>port</code> Property</h3>
<ul>
<li><strong>Exposure</strong>: The <code>port</code> lets us access the
service from inside the cluster or outside, depending on the service
type like ClusterIP, NodePort, or LoadBalancer.</li>
<li><strong>Consistency</strong>: This port stays the same no matter
what port the application container is using.</li>
<li><strong>Routing</strong>: Kubernetes uses the <code>port</code> to
send incoming traffic to the right pods based on selectors.</li>
</ul>
<h3 id="use-cases">Use Cases</h3>
<ul>
<li><strong>Internal Communication</strong>: Pods in the same namespace
can talk to each other using the service’s <code>port</code>. This hides
the actual pod IPs.</li>
<li><strong>Load Balancing</strong>: Services share traffic among
available pod replicas. They use the <code>port</code> to manage
incoming requests.</li>
</ul>
<p>In summary, the <code>port</code> in a Kubernetes Service definition
is very important. It tells how clients can connect with the service. It
gives a stable way for communication inside and outside the cluster.</p>
<h2
id="exploring-the-functionality-of-targetport-in-kubernetes-services">Exploring
the Functionality of targetPort in Kubernetes Services</h2>
<p>In Kubernetes Services, we use <code>targetPort</code> to tell the
Service which port on the container should get the traffic. This is very
important for Service setup. It helps services connect to the right port
of the app inside the container.</p>
<h3 id="key-characteristics-of-targetport">Key Characteristics of
targetPort:</h3>
<ul>
<li><strong>Purpose</strong>: It shows the port on the container where
the app is waiting for requests.</li>
<li><strong>Data Types</strong>: We can define <code>targetPort</code>
as a number or a string. If we use a string, it must match the port name
in the container setup.</li>
</ul>
<h3 id="example-of-kubernetes-service-with-targetport">Example of
Kubernetes Service with targetPort:</h3>
<div class="sourceCode" id="cb2"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-service</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> http</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span><span class="co">          # Port exposed by the Service</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span><span class="co">  # Port on the container to forward traffic to</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClusterIP</span></span></code></pre></div>
<p>In this example, the Service <code>my-service</code> listens on port
<code>80</code>. It sends the traffic to port <code>8080</code> on the
selected Pods. This way, users can reach the app through port
<code>80</code>. They do not need to know what happens inside the
container.</p>
<h3 id="use-cases-for-targetport">Use Cases for targetPort:</h3>
<ul>
<li><strong>Different Port Mappings</strong>: If the Service port and
container port are not the same, <code>targetPort</code> gives us the
ability to map them flexibly.</li>
<li><strong>Port Naming</strong>: If we use named ports,
<code>targetPort</code> can link to those names. This makes it easier to
read and manage.</li>
</ul>
<h3 id="default-behavior">Default Behavior:</h3>
<p>If we do not say what <code>targetPort</code> is, Kubernetes will use
the same value as <code>port</code> by default. But it is better to say
<code>targetPort</code> clearly. This helps avoid any confusion and
makes Service definitions clear.</p>
<p>For more insights into Kubernetes Services, we can check this <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-services-and-how-do-they-expose-applications.html">Kubernetes
Services Overview</a>.</p>
<h2 id="how-to-use-targetport-and-port-effectively-in-kubernetes">How to
Use targetPort and port Effectively in Kubernetes</h2>
<p>In Kubernetes, we need to understand how to use
<code>targetPort</code> and <code>port</code> in Service definitions.
This is important for good service communication. These two fields help
us route traffic to our Pods. We must use them right to avoid
mistakes.</p>
<ul>
<li><p><strong>port</strong>: This is the port that the Service will
show. It is where the Service listens for incoming requests. Clients
connect to the Service using this port.</p></li>
<li><p><strong>targetPort</strong>: This is the port on the Pod that the
Service sends traffic to. It can be the same as <code>port</code> or
different. If we do not say it, it will use the value of
<code>port</code> by default.</p></li>
</ul>
<h3 id="example-yaml-configuration">Example YAML Configuration</h3>
<p>Here is a simple example of a Kubernetes Service definition. It shows
how to use <code>port</code> and <code>targetPort</code>:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-service</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span><span class="co">               # The port exposed by the service</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span><span class="co">       # The port on the container to forward traffic to</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClusterIP</span></span></code></pre></div>
<p>In this example: - The Service is open on port <code>80</code>. This
means clients will connect to this port. - The Service sends traffic to
port <code>8080</code> on the Pods that have the label
<code>app: my-app</code>.</p>
<h3 id="best-practices-for-using-targetport-and-port">Best Practices for
Using targetPort and port</h3>
<ol type="1">
<li><strong>Consistent Naming</strong>: Try to keep <code>port</code>
and <code>targetPort</code> the same when we can. This helps reduce
confusion.</li>
<li><strong>Use Descriptive Names</strong>: When we define ports, we
should use names that are clear and tell their purpose.</li>
<li><strong>Avoid Hardcoding</strong>: If our applications run on
different ports in different places, we can use environment variables or
ConfigMaps to manage port numbers.</li>
<li><strong>Monitor Traffic</strong>: We should use monitoring tools to
check if traffic is routed right and avoid surprises.</li>
</ol>
<p>By following these tips, we can use <code>targetPort</code> and
<code>port</code> well in our Kubernetes Service definitions. This helps
our services communicate as we want. For more details on Kubernetes
services and their settings, we can check this <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-services-and-how-do-they-expose-applications.html">Kubernetes
services article</a>.</p>
<h2
id="common-misconfigurations-between-targetport-and-port-in-kubernetes-services">Common
Misconfigurations Between targetPort and port in Kubernetes
Services</h2>
<p>Misconfigurations between <code>targetPort</code> and
<code>port</code> in Kubernetes Services can cause connection problems
and service failures. It is important to understand how to use these
fields correctly for the service to work well.</p>
<ul>
<li><p><strong>Port</strong>: This is the port that the service shows.
Other services or clients will use this port to reach the
service.</p></li>
<li><p><strong>targetPort</strong>: This is the port on the container
where the service sends traffic. It helps the service direct traffic to
a different port than the one it shows.</p></li>
</ul>
<h3 id="common-misconfigurations-include">Common Misconfigurations
Include:</h3>
<ol type="1">
<li><p><strong>Mismatch between port and targetPort</strong>: If the
<code>targetPort</code> is not set right with the actual port that the
application listens on inside the container, it can cause connection
problems.</p>
<p>Example:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-service</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span><span class="co"> # Make sure the application listens on this port</span></span></code></pre></div></li>
<li><p><strong>Omitting targetPort</strong>: If we forget to include
<code>targetPort</code>, Kubernetes will use the same value as
<code>port</code>. If the application listens on a different port, this
can create traffic routing problems.</p></li>
<li><p><strong>Using wrong data types</strong>: We need to make sure
that both <code>port</code> and <code>targetPort</code> are numbers.
Using strings or other types can lead to mistakes in
configuration.</p></li>
<li><p><strong>Not specifying the protocol</strong>: The default
protocol is <code>TCP</code>. If we use <code>UDP</code>, we must say it
clearly. Not doing this can cause strange behavior.</p>
<p>Example:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">53</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">53</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> UDP</span></span></code></pre></div></li>
<li><p><strong>Using the same port for many services</strong>: If we set
many services to use the same <code>port</code> value, it can cause
conflicts. We should make sure service ports are unique in the same
namespace.</p></li>
<li><p><strong>Forgetting to update targetPort when changing application
ports</strong>: If the application inside the container changes its
listening port, we need to update the <code>targetPort</code> in the
service definition too.</p></li>
</ol>
<p>By checking the configurations of <code>port</code> and
<code>targetPort</code> in your Kubernetes Service definitions, we can
avoid these common mistakes. For more detailed help on Kubernetes
services, we can read <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-services-and-how-do-they-expose-applications.html">this
article about Kubernetes services and how they expose
applications</a>.</p>
<h2
id="best-practices-for-defining-targetport-and-port-in-kubernetes-service-yaml">Best
Practices for Defining targetPort and port in Kubernetes Service
YAML</h2>
<p>When we define a Kubernetes Service, it is important to know the
difference between <code>port</code> and <code>targetPort</code>. This
helps us to configure the service well. Here are some best practices to
remember:</p>
<ul>
<li><p><strong>Define <code>port</code> as the Service Port</strong>:
The <code>port</code> field is for the port that the service shows to
the outside. This is the port that other services or clients will use to
connect to the Service. It is good to use a well-known port number. This
helps avoid confusion.</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> example-service</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClusterIP</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span><span class="co">  # Port that the service uses</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TCP</span></span></code></pre></div></li>
<li><p><strong>Use <code>targetPort</code> to point to the Container
Port</strong>: The <code>targetPort</code> should be the port where the
application inside the container listens. If the application uses a
different port than the one the service shows, we must define
<code>targetPort</code>.</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> example-service</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClusterIP</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span><span class="co">        # Port that the service uses</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span><span class="co">  # Port on the container</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TCP</span></span></code></pre></div></li>
<li><p><strong>Align <code>port</code> and <code>targetPort</code> for
Simplicity</strong>: If <code>port</code> and <code>targetPort</code>
are the same, we can leave out <code>targetPort</code>. Kubernetes will
think they are equal. But writing both can make it easier to read.</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> example-service</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClusterIP</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span><span class="co">  # Same as port</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TCP</span></span></code></pre></div></li>
<li><p><strong>Use Named Ports</strong>: If our service has many ports,
we should think about using named ports. This makes it clearer and
easier to manage ports in the settings.</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> example-service</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClusterIP</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> http</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TCP</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> https</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">443</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">8443</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TCP</span></span></code></pre></div></li>
<li><p><strong>Consistency Across Environments</strong>: We should keep
port definitions the same in all environments like development, testing,
and production. This helps to avoid problems during
deployments.</p></li>
<li><p><strong>Document Port Usage</strong>: We can add comments to our
YAML configurations. This shows the purpose of each port. This is
helpful for teams and for the future.</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> example-service</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClusterIP</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span><span class="co">        # Public access port</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span><span class="co">  # Internal application port</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TCP</span></span></code></pre></div></li>
</ul>
<p>Using these best practices for <code>targetPort</code> and
<code>port</code> in Kubernetes Service YAML helps us to set up our
services right and makes them easy to manage. For more details on
Kubernetes services, we can check out <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-services-and-how-do-they-expose-applications.html">this
article</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3
id="what-is-the-difference-between-targetport-and-port-in-kubernetes-services">What
is the difference between <code>targetPort</code> and <code>port</code>
in Kubernetes Services?</h3>
<p>In Kubernetes Service definitions, <code>port</code> is the port that
the service listens on. <code>targetPort</code> is the port that the
application container listens to. This difference gives us flexibility.
We can expose a service on one port and send traffic to another port in
the container. Knowing this difference is important for setting up
Kubernetes Services correctly.</p>
<h3
id="how-do-i-define-port-and-targetport-in-a-kubernetes-service-yaml">How
do I define <code>port</code> and <code>targetPort</code> in a
Kubernetes Service YAML?</h3>
<p>When we define a Kubernetes Service in a YAML file, we can put
<code>port</code> and <code>targetPort</code> under the
<code>spec</code> section. Here is a simple example:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-service</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClusterIP</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span></span></code></pre></div>
<p>In this example, the service listens on port 80. It sends traffic to
port 8080 of the container.</p>
<h3 id="can-i-use-the-same-value-for-port-and-targetport">Can I use the
same value for <code>port</code> and <code>targetPort</code>?</h3>
<p>Yes, we can use the same value for both <code>port</code> and
<code>targetPort</code> in our Kubernetes Service definition. But it’s
often good to make them different. This gives us more control over how
applications are accessed. For example, we can expose an app on a
standard port while the application listens on another port. This can
help us avoid problems.</p>
<h3 id="what-happens-if-i-omit-targetport-in-my-service-definition">What
happens if I omit <code>targetPort</code> in my Service definition?</h3>
<p>If we leave out <code>targetPort</code> in our Kubernetes Service
definition, Kubernetes will set it to be the same as <code>port</code>.
This is easy but may not be the best way if our application listens on a
different port. We should always check our application settings to make
sure the traffic goes to the right place.</p>
<h3
id="what-are-common-misconfigurations-between-targetport-and-port-in-kubernetes-services">What
are common misconfigurations between <code>targetPort</code> and
<code>port</code> in Kubernetes Services?</h3>
<p>Common mistakes can happen when <code>targetPort</code> does not
match the application’s listening port. This can cause connection
failures. Also, not adding <code>targetPort</code> when we need it can
lead to strange behavior. We should always check our Kubernetes Service
YAML to make sure <code>port</code> and <code>targetPort</code> are
matched correctly.</p>
<p>For more information about Kubernetes Services, we can check <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-services-and-how-do-they-expose-applications.html">what
Kubernetes services are and how they expose applications</a> to improve
our understanding.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            