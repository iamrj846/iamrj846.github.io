
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TFCQEJR7TD');
</script>
            <title>How Do I Deploy a Python Flask Application on Kubernetes?</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Common CSS & Icons -->
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
<link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
<link rel="stylesheet" href="/assets/css/post.css">
            <meta name="description" content="Learn how to deploy your Python Flask application on Kubernetes with our step-by-step guide. Simplify your deployment today!">

            <div id="head-placeholder"></div>
            <script src="/assets/js/blog.js" defer></script>
            <link rel="stylesheet" href="/assets/css/post.css">
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">How Do I Deploy a Python Flask Application on Kubernetes?</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>Deploying a Python Flask application on Kubernetes is a simple
process. It has steps that help us use the power of container
management. Kubernetes gives us a strong platform. It helps us automate
deployment, scaling, and managing applications across many hosts. This
makes it a great choice for web applications like Flask.</p>
<p>In this article, we will talk about the important parts of deploying
a Python Flask application on Kubernetes. We will look at what we need
before starting the deployment. Then, we will see how to make a Docker
image for our Flask app. We will also go through the Kubernetes
resources we need and how to write a deployment manifest for Kubernetes.
After that, we will learn how to show our Flask application using
Kubernetes services. Finally, we will discuss best practices for
deployment, real-life examples, and ways to monitor and scale our
application well.</p>
<ul>
<li>How Can We Deploy a Python Flask Application on Kubernetes?</li>
<li>What Prerequisites Do We Need for Kubernetes Deployment?</li>
<li>How Do We Create a Docker Image for Our Flask Application?</li>
<li>What Kubernetes Resources Do We Need for a Flask App?</li>
<li>How Do We Write a Kubernetes Deployment Manifest for Flask?</li>
<li>How Can We Expose Our Flask Application Using Kubernetes
Services?</li>
<li>What Are the Best Practices for Deploying Flask Apps on
Kubernetes?</li>
<li>What Are Real Life Use Cases for Flask on Kubernetes?</li>
<li>How Do We Monitor and Scale Our Flask Application in
Kubernetes?</li>
<li>Frequently Asked Questions</li>
</ul>
<p>For more information about Kubernetes and how it helps with
management, we can read about <a
href="https://bestonlinetutorial.com/kubernetes/what-is-kubernetes-and-how-does-it-simplify-container-management.html">what
Kubernetes is and how it simplifies container management</a> and <a
href="https://bestonlinetutorial.com/kubernetes/why-should-i-use-kubernetes-for-my-applications.html">why
we should use Kubernetes for our applications</a>.</p>
<h2 id="what-prerequisites-do-we-need-for-kubernetes-deployment">What
Prerequisites Do We Need for Kubernetes Deployment?</h2>
<p>Before we deploy a Python Flask app on Kubernetes, let’s check we
have these things ready:</p>
<ol type="1">
<li><p><strong>Kubernetes Cluster</strong>: We need access to a working
Kubernetes cluster. We can set this up on our computer using tools like
Minikube. We can also use cloud services like AWS EKS, Google GKE, or
Azure AKS. For local setup, we can follow <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-install-minikube-for-local-kubernetes-development.html">this
guide on how to install Minikube</a>.</p></li>
<li><p><strong>kubectl</strong>: We must install the Kubernetes
command-line tool called <code>kubectl</code>. This tool helps us to
talk with our Kubernetes cluster. We can download it from the official
Kubernetes documentation.</p></li>
<li><p><strong>Docker</strong>: We should install Docker to create
images of our Flask app. Let’s make sure Docker is running before we
build any images.</p></li>
<li><p><strong>Flask Application</strong>: We need to have our Flask app
ready to go. It is better if our app has a <code>requirements.txt</code>
file. This file will list all the things our app needs.</p></li>
<li><p><strong>Container Registry</strong>: If we want to deploy our app
in the cloud, we should set up a container registry. We can use Docker
Hub or Google Container Registry to store our Docker images.</p></li>
<li><p><strong>Configuration Files</strong>: It is important to prepare
Kubernetes configuration files. These files include deployment and
service manifests. We need to define things like resource needs,
environment variables, and any secrets we might need.</p></li>
<li><p><strong>Networking and Storage</strong>: Let’s learn a bit about
Kubernetes networking and storage. If our app needs to connect to a
database or save data, this is important.</p></li>
<li><p><strong>Access Credentials</strong>: We have to make sure we have
the right access credentials. This will help us interact with our
Kubernetes cluster and any cloud services we use.</p></li>
</ol>
<p>With these things ready, we can deploy our Python Flask app on
Kubernetes. If we want more detailed steps on how to deploy apps on
Kubernetes, we can check <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-deploy-a-simple-web-application-on-kubernetes.html">this
guide on deploying a simple web application</a>.</p>
<h2 id="how-do-i-create-a-docker-image-for-my-flask-application">How Do
I Create a Docker Image for My Flask Application?</h2>
<p>To create a Docker image for our Python Flask application, we can
follow these simple steps:</p>
<ol type="1">
<li><p><strong>Create a <code>Dockerfile</code></strong>. We put this
file in the main folder of our Flask application. This file gives
instructions on how to build our image. Here is a sample
<code>Dockerfile</code>:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the official Python image from Docker Hub</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> python:3.9-slim</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the working directory</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">WORKDIR</span> /app</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy requirements.txt and install dependencies</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> requirements.txt .</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">pip</span> install <span class="at">--no-cache-dir</span> <span class="at">-r</span> requirements.txt</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy the rest of the application code</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> . .</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Expose the port the app runs on</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="kw">EXPOSE</span> 5000</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Command to run the application</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;python&quot;</span>, <span class="st">&quot;app.py&quot;</span>]</span></code></pre></div></li>
<li><p><strong>Create a <code>requirements.txt</code></strong> file. We
put this in our application folder. This file lists all the packages our
Flask application needs. For example:</p>
<pre><code>Flask==2.0.1
gunicorn==20.1.0</code></pre></li>
<li><p><strong>Build the Docker image</strong>. We can do this by
running this command in our terminal. We do this from the main folder of
our Flask application:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> build <span class="at">-t</span> my-flask-app .</span></code></pre></div></li>
<li><p><strong>Check the image is created</strong>. We can list the
available Docker images to see if it worked:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> images</span></code></pre></div></li>
<li><p><strong>Run the Docker container</strong>. We do this to test if
our image works:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-p</span> 5000:5000 my-flask-app</span></code></pre></div></li>
</ol>
<p>Now, our Flask application should be accessible at
<code>http://localhost:5000</code>.</p>
<p>If we want to learn more about deploying applications with
Kubernetes, we can look at this article on <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-deploy-a-simple-web-application-on-kubernetes.html">how
to deploy a simple web application on Kubernetes</a>.</p>
<h2 id="what-kubernetes-resources-do-we-need-for-a-flask-app">What
Kubernetes Resources Do We Need for a Flask App?</h2>
<p>To deploy a Python Flask app on Kubernetes, we need several
resources. These resources help our app run well and grow when needed.
Here are the important resources we should think about:</p>
<ol type="1">
<li><p><strong>Pod</strong>: This is the basic unit we use to deploy in
Kubernetes. A pod can hold one or more containers. For our Flask app, we
usually have one pod with one container for our Flask app.</p>
<p>Example Pod manifest:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Pod</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> flask-app</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> flask-container</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> your-docker-image:latest</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">5000</span></span></code></pre></div></li>
<li><p><strong>Deployment</strong>: This manages how we deploy our Pods.
It makes sure that the number of Pods we want is running. It also helps
with updates and rollbacks.</p>
<p>Example Deployment manifest:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> flask-app-deployment</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> flask-app</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> flask-app</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> flask-container</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> your-docker-image:latest</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">5000</span></span></code></pre></div></li>
<li><p><strong>Service</strong>: This exposes our app to the network. We
can use a ClusterIP service for communication inside the cluster. Or we
can use a LoadBalancer service for access from outside.</p>
<p>Example Service manifest:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> flask-app-service</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> LoadBalancer</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">5000</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">app</span><span class="kw">:</span><span class="at"> flask-app</span></span></code></pre></div></li>
<li><p><strong>ConfigMap</strong>: This helps us manage configuration
data for our app. It allows us to keep configuration separate from the
app code.</p>
<p>Example ConfigMap manifest:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> flask-config</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">FLASK_ENV</span><span class="kw">:</span><span class="at"> production</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">DATABASE_URL</span><span class="kw">:</span><span class="at"> your-database-url</span></span></code></pre></div></li>
<li><p><strong>Secret</strong>: This is like ConfigMap, but we use it
for sensitive data. We store passwords, tokens, and other private
information here.</p>
<p>Example Secret manifest:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Secret</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> flask-secret</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">type</span><span class="kw">:</span><span class="at"> Opaque</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">DATABASE_PASSWORD</span><span class="kw">:</span><span class="at"> base64-encoded-password</span></span></code></pre></div></li>
<li><p><strong>Persistent Volume (PV) and Persistent Volume Claim
(PVC)</strong>: If our Flask app needs storage that lasts (like for file
uploads or database data), we define PV and PVC.</p>
<p>Example PVC manifest:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> PersistentVolumeClaim</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> flask-pvc</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">accessModes</span><span class="kw">:</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> ReadWriteOnce</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">requests</span><span class="kw">:</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">storage</span><span class="kw">:</span><span class="at"> 1Gi</span></span></code></pre></div></li>
</ol>
<p>These resources will work together to create a strong environment for
our Flask app on Kubernetes. For more steps on how to deploy apps on
Kubernetes, we can check this <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-deploy-a-simple-web-application-on-kubernetes.html">Kubernetes
deployment guide</a>.</p>
<h2 id="how-do-we-write-a-kubernetes-deployment-manifest-for-flask">How
Do We Write a Kubernetes Deployment Manifest for Flask?</h2>
<p>To deploy a Python Flask app on Kubernetes, we need to make a
Kubernetes Deployment manifest. This manifest shows what we want for our
app. It includes things like how many copies we want, which container
image to use, and the limits for resources. Here is a simple example of
a Kubernetes Deployment manifest for a Flask app.</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> flask-app</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">app</span><span class="kw">:</span><span class="at"> flask-app</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> flask-app</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> flask-app</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> flask-app</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> your-dockerhub-username/flask-app:latest</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">5000</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> FLASK_ENV</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;production&quot;</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">limits</span><span class="kw">:</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">memory</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;256Mi&quot;</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">cpu</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;500m&quot;</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">requests</span><span class="kw">:</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">memory</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;128Mi&quot;</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">cpu</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;250m&quot;</span></span></code></pre></div>
<h3 id="key-parts-explained">Key Parts Explained:</h3>
<ul>
<li><strong>apiVersion</strong>: This tells us the version of the API
for the Deployment.</li>
<li><strong>kind</strong>: This shows that we are working with a
Deployment resource.</li>
<li><strong>metadata</strong>: This has information about the deployment
like name and labels.</li>
<li><strong>spec</strong>: This shows what we want for the deployment.
<ul>
<li><strong>replicas</strong>: This is how many pod copies we want to
run.</li>
<li><strong>selector</strong>: This helps us find the pods that this
deployment manages.</li>
<li><strong>template</strong>: This tells us how to make new pods.
<ul>
<li><strong>containers</strong>: This lists the container details like:
<ul>
<li><strong>name</strong>: The name of the container.</li>
<li><strong>image</strong>: The Docker image for the Flask app.</li>
<li><strong>ports</strong>: The ports we want to expose.</li>
<li><strong>env</strong>: The environment variables we want to set.</li>
<li><strong>resources</strong>: This shows the limits and requests for
resources.</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p>When we have this manifest file (like
<code>flask-deployment.yaml</code>), we can use this command to apply
it:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> flask-deployment.yaml</span></code></pre></div>
<p>This command will make the deployment. It ensures that the number of
copies of our Flask app is running in the Kubernetes cluster. Don’t
forget to change <code>your-dockerhub-username/flask-app:latest</code>
with your real image name from a container registry.</p>
<p>For more details on Kubernetes deployments, we can check <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-deployments-and-how-do-i-use-them.html">what
are Kubernetes deployments and how do I use them</a>.</p>
<h2
id="how-can-we-expose-our-flask-application-using-kubernetes-services">How
Can We Expose Our Flask Application Using Kubernetes Services?</h2>
<p>To expose our Python Flask application in Kubernetes, we can use a
Kubernetes Service. This makes our application reachable from outside
the Kubernetes cluster. There are different types of services. For web
applications, we usually use <strong>NodePort</strong> and
<strong>LoadBalancer</strong>.</p>
<h3 id="using-nodeport-service">Using NodePort Service</h3>
<p>A NodePort service makes our application available on a specific port
on each Node in the cluster. Here is how we can create a NodePort
service for our Flask application:</p>
<ol type="1">
<li>First, we need to define the service in a YAML file. We can call it
<code>flask-service.yaml</code>:</li>
</ol>
<div class="sourceCode" id="cb14"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> flask-service</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> NodePort</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">app</span><span class="kw">:</span><span class="at"> flask-app</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">5000</span><span class="co">  # Flask default port</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">nodePort</span><span class="kw">:</span><span class="at"> </span><span class="dv">30000</span><span class="co">    # Port to access service from outside</span></span></code></pre></div>
<ol start="2" type="1">
<li>Then, we apply the service configuration:</li>
</ol>
<div class="sourceCode" id="cb15"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> flask-service.yaml</span></code></pre></div>
<ol start="3" type="1">
<li>Now, we can access our application using
<code>http://&lt;NodeIP&gt;:30000</code>.</li>
</ol>
<h3 id="using-loadbalancer-service">Using LoadBalancer Service</h3>
<p>If we use a cloud provider that supports LoadBalancers, we can create
a LoadBalancer service. This will automatically set up a cloud load
balancer for our application.</p>
<ol type="1">
<li>We define the service in a YAML file, also called
<code>flask-service.yaml</code>:</li>
</ol>
<div class="sourceCode" id="cb16"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> flask-service</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> LoadBalancer</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">app</span><span class="kw">:</span><span class="at"> flask-app</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">5000</span></span></code></pre></div>
<ol start="2" type="1">
<li>Next, we apply the service configuration:</li>
</ol>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> flask-service.yaml</span></code></pre></div>
<ol start="3" type="1">
<li>We can find the external IP address with:</li>
</ol>
<div class="sourceCode" id="cb18"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get services</span></code></pre></div>
<ol start="4" type="1">
<li>Finally, we can access our application using
<code>http://&lt;External-IP&gt;</code>.</li>
</ol>
<h3 id="using-ingress">Using Ingress</h3>
<p>For better routing and SSL termination, we can use an Ingress
resource. We need to have an Ingress controller installed in our
cluster.</p>
<ol type="1">
<li>We define the Ingress in a YAML file called
<code>flask-ingress.yaml</code>:</li>
</ol>
<div class="sourceCode" id="cb19"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> networking.k8s.io/v1</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Ingress</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> flask-ingress</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">rules</span><span class="kw">:</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> flask.example.com</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">http</span><span class="kw">:</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">paths</span><span class="kw">:</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">pathType</span><span class="kw">:</span><span class="at"> Prefix</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">backend</span><span class="kw">:</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">name</span><span class="kw">:</span><span class="at"> flask-service</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">port</span><span class="kw">:</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">number</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span></span></code></pre></div>
<ol start="2" type="1">
<li>Then we apply the Ingress configuration:</li>
</ol>
<div class="sourceCode" id="cb20"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> flask-ingress.yaml</span></code></pre></div>
<ol start="3" type="1">
<li>We need to make sure that our DNS points
<code>flask.example.com</code> to the IP of the Ingress controller to
reach our application.</li>
</ol>
<p>By using these methods, we can easily expose our Python Flask
application on Kubernetes. This makes it reachable to users. For more
details about Kubernetes services, we can read <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-services-and-how-do-they-expose-applications.html">What
Are Kubernetes Services and How Do They Expose Applications?</a>.</p>
<h2
id="what-are-the-best-practices-for-deploying-flask-apps-on-kubernetes">What
Are the Best Practices for Deploying Flask Apps on Kubernetes?</h2>
<p>When we deploy a Python Flask app on Kubernetes, we want to follow
some best practices. This helps us keep our app reliable, scalable, and
easy to maintain. Here are some simple guidelines:</p>
<ol type="1">
<li><strong>Containerization</strong>:
<ul>
<li>We should use a small base image like <code>python:3.9-slim</code>
to make the image smaller.</li>
<li>Our <code>Dockerfile</code> should only install the packages we
need. This helps to reduce security risks.</li>
</ul>
<div class="sourceCode" id="cb21"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> python:3.9-slim</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="kw">WORKDIR</span> /app</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> requirements.txt .</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">pip</span> install <span class="at">--no-cache-dir</span> <span class="at">-r</span> requirements.txt</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> . .</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;flask&quot;</span>, <span class="st">&quot;run&quot;</span>, <span class="st">&quot;--host=0.0.0.0&quot;</span>]</span></code></pre></div></li>
<li><strong>Configuration Management</strong>:
<ul>
<li>We can store sensitive information such as API keys and database
passwords in Kubernetes Secrets.</li>
<li>For other configuration data, we can use ConfigMaps.</li>
</ul>
<div class="sourceCode" id="cb22"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Secret</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> flask-secret</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">type</span><span class="kw">:</span><span class="at"> Opaque</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">DATABASE_URL</span><span class="kw">:</span><span class="at"> &lt;base64_encoded_value&gt;</span></span></code></pre></div></li>
<li><strong>Use Health Checks</strong>:
<ul>
<li>We should set up readiness and liveness probes. This helps us check
if our app is running well and manage traffic.</li>
</ul>
<div class="sourceCode" id="cb23"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">livenessProbe</span><span class="kw">:</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">httpGet</span><span class="kw">:</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /health</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">5000</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">initialDelaySeconds</span><span class="kw">:</span><span class="at"> </span><span class="dv">30</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">periodSeconds</span><span class="kw">:</span><span class="at"> </span><span class="dv">10</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">readinessProbe</span><span class="kw">:</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">httpGet</span><span class="kw">:</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /ready</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">5000</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">initialDelaySeconds</span><span class="kw">:</span><span class="at"> </span><span class="dv">5</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">periodSeconds</span><span class="kw">:</span><span class="at"> </span><span class="dv">5</span></span></code></pre></div></li>
<li><strong>Resource Requests and Limits</strong>:
<ul>
<li>We need to set CPU and memory requests and limits in our deployment.
This way, our app gets enough resources but does not use too much.</li>
</ul>
<div class="sourceCode" id="cb24"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">requests</span><span class="kw">:</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">memory</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;128Mi&quot;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">cpu</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;500m&quot;</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">limits</span><span class="kw">:</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">memory</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;256Mi&quot;</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">cpu</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;1&quot;</span></span></code></pre></div></li>
<li><strong>Horizontal Pod Autoscaling</strong>:
<ul>
<li>We can use Horizontal Pod Autoscaler (HPA) to automatically change
the number of pods based on CPU usage or other metrics.</li>
</ul>
<div class="sourceCode" id="cb25"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> autoscale deployment flask-deployment <span class="at">--cpu-percent</span><span class="op">=</span>50 <span class="at">--min</span><span class="op">=</span>1 <span class="at">--max</span><span class="op">=</span>10</span></code></pre></div></li>
<li><strong>Logging and Monitoring</strong>:
<ul>
<li>We should use centralized logging like Fluentd and Elasticsearch.
For monitoring, we can use Prometheus and Grafana.</li>
<li>It is good to have structured logs that help us troubleshoot
issues.</li>
</ul></li>
<li><strong>Network Policies</strong>:
<ul>
<li>We can use Kubernetes Network Policies to control traffic to and
from our Flask app. This makes our app more secure.</li>
</ul></li>
<li><strong>Version Control</strong>:
<ul>
<li>We should use GitOps practices. This helps us manage our Kubernetes
files easily and track changes.</li>
</ul></li>
<li><strong>Canary and Blue-Green Deployments</strong>:
<ul>
<li>We can use deployment methods like Canary or Blue-Green. This helps
reduce downtime and risks when we update our app.</li>
</ul></li>
<li><strong>Backup and Disaster Recovery</strong>:
<ul>
<li>We need to back up our app data and settings regularly. Tools like
Velero can help us with disaster recovery.</li>
</ul></li>
<li><strong>Documentation and CI/CD</strong>:
<ul>
<li>We should keep good documentation about the deployment process. We
can also use CI/CD pipelines to automate our deployments. Tools like
Jenkins or GitHub Actions can be useful.</li>
</ul></li>
</ol>
<p>By following these best practices, we can deploy our Python Flask app
on Kubernetes in a better and safer way. This will help us have a
smoother experience in production. For more details on deploying apps on
Kubernetes, we can check <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-deploy-a-simple-web-application-on-kubernetes.html">this
article on deploying applications on Kubernetes</a>.</p>
<h2 id="what-are-real-life-use-cases-for-flask-on-kubernetes">What Are
Real Life Use Cases for Flask on Kubernetes?</h2>
<p>Flask applications are light and flexible. They are great for running
on Kubernetes in many situations. Here are some real-life examples where
we can use Flask on Kubernetes:</p>
<ol type="1">
<li><p><strong>Microservices Architecture</strong>: We often use Flask
to build microservices. Each service can run in its own container on
Kubernetes. This helps us scale and manage them separately. This setup
makes our applications more reliable and easier to maintain.</p></li>
<li><p><strong>RESTful APIs</strong>: Flask is popular for making
RESTful APIs. When we deploy these APIs on Kubernetes, we get good load
balancing and can scale them automatically. It also makes it easy to
manage different versions. Kubernetes services can connect the API to
outside clients smoothly.</p></li>
<li><p><strong>Data Processing Pipelines</strong>: We can use Flask as a
simple web interface for data tasks. When we run it on Kubernetes, it
can work with other tools like Celery for processing tasks. This helps
us do tasks efficiently and keep track of them.</p></li>
<li><p><strong>Machine Learning Applications</strong>: We often build
interfaces for machine learning models with Flask. Kubernetes helps us
deploy these models. It lets us scale them based on need and makes A/B
testing with different versions easier.</p></li>
<li><p><strong>Prototyping and MVP Development</strong>: Flask is simple
to use, which makes it great for quick prototyping. When we deploy these
prototypes on Kubernetes, we get a reliable and scalable environment.
This helps when we move to production as the application grows.</p></li>
<li><p><strong>Real-time Applications</strong>: We can use Flask with
WebSockets to add real-time features. Kubernetes helps us manage the
complex system needed for these applications. It allows for scaling and
makes sure they are always available.</p></li>
<li><p><strong>Multi-Tenant Applications</strong>: We can design Flask
applications to support multiple users. Kubernetes helps us isolate
these users using namespaces and resource limits. This way, we can
manage each user’s resources well.</p></li>
<li><p><strong>E-commerce Platforms</strong>: Flask can run different
parts of an e-commerce site, like product catalogs and payment systems.
Kubernetes gives us the ability to scale and be resilient, which is
important during busy sales times.</p></li>
<li><p><strong>Content Management Systems (CMS)</strong>: We can use
Flask to create custom CMS solutions. When we run these on Kubernetes,
we can update and scale them easily based on what content we need to
deliver. This helps keep a good user experience.</p></li>
<li><p><strong>Internal Tools and Dashboards</strong>: We often build
internal tools and dashboards with Flask. Kubernetes makes it easier to
deploy these tools and manage their settings. It also helps keep them
secure and accessible.</p></li>
</ol>
<p>These examples show how flexible and effective it is to run Flask
applications on Kubernetes. We can use Kubernetes’ abilities to manage
applications better. For more details on deploying applications on
Kubernetes, we can check out <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-deploy-a-simple-web-application-on-kubernetes.html">how
to deploy a simple web application on Kubernetes</a>.</p>
<h2
id="how-do-we-monitor-and-scale-our-flask-application-in-kubernetes">How
Do We Monitor and Scale Our Flask Application in Kubernetes?</h2>
<p>To monitor and scale our Python Flask application on Kubernetes, we
need to use some tools and features from Kubernetes. These help us see
how our app is doing and make it grow when needed.</p>
<h3 id="monitoring-our-flask-application">Monitoring Our Flask
Application</h3>
<ol type="1">
<li><strong>Prometheus and Grafana</strong>: This is a popular way to
monitor Kubernetes apps.
<ul>
<li><p><strong>Install Prometheus</strong> in our cluster:</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> https://github.com/prometheus-operator/prometheus-operator/raw/master/bundle.yaml</span></code></pre></div></li>
<li><p><strong>Metrics Endpoint</strong>: We need our Flask app to show
Prometheus metrics. We can use the
<code>prometheus_flask_exporter</code> package.</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> prometheus_flask_exporter <span class="im">import</span> PrometheusMetrics</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>app <span class="op">=</span> Flask(<span class="va">__name__</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>metrics <span class="op">=</span> PrometheusMetrics(app)</span></code></pre></div></li>
<li><p><strong>Grafana Setup</strong>: We can use Grafana to see the
metrics better.</p></li>
</ul></li>
<li><strong>ELK Stack (Elasticsearch, Logstash, Kibana)</strong>: This
helps us with logging and showing logs.
<ul>
<li>We can deploy the ELK stack in our Kubernetes cluster. This helps us
collect and show logs from our Flask app.</li>
<li>We can use a logging library like <code>Flask-Logging</code> to send
logs to Logstash.</li>
</ul></li>
<li><strong>Kubernetes Dashboard</strong>: This gives us a user
interface to check cluster health and see how our resources are
used.</li>
</ol>
<h3 id="scaling-our-flask-application">Scaling Our Flask
Application</h3>
<ol type="1">
<li><p><strong>Horizontal Pod Autoscaling (HPA)</strong>: This
automatically changes the number of pods based on CPU use or other
metrics.</p>
<ul>
<li><p><strong>Enable Metrics Server</strong>:</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml</span></code></pre></div></li>
<li><p><strong>Create HPA</strong>:</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> autoscale deployment your-flask-app <span class="at">--cpu-percent</span><span class="op">=</span>50 <span class="at">--min</span><span class="op">=</span>1 <span class="at">--max</span><span class="op">=</span>10</span></code></pre></div></li>
<li><p>This command keeps the average CPU use at 50% across pods and
scales between 1 and 10 replicas.</p></li>
</ul></li>
<li><p><strong>Vertical Pod Autoscaling (VPA)</strong>: This adjusts the
resource needs based on how much we use.</p>
<ul>
<li><p>We can deploy VPA in our cluster:</p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> https://github.com/kubernetes/autoscaler/tree/master/vertical-pod-autoscaler/deploy/vpa</span></code></pre></div></li>
<li><p>VPA helps us use resources better for our Flask app.</p></li>
</ul></li>
<li><p><strong>Manual Scaling</strong>: We can also scale our deployment
by hand:</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> scale deployment your-flask-app <span class="at">--replicas</span><span class="op">=</span>5</span></code></pre></div></li>
<li><p><strong>Load Testing</strong>: Before we scale, we should do load
testing. We can use tools like Apache JMeter or Locust to see how our
app works under pressure.</p></li>
</ol>
<p>By using these monitoring and scaling methods, we can make sure our
Flask application works well in Kubernetes. It can respond to different
loads while keeping good performance.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3
id="what-is-the-best-way-to-deploy-a-python-flask-application-on-kubernetes">1.
What is the best way to deploy a Python Flask application on
Kubernetes?</h3>
<p>We can deploy a Python Flask application on Kubernetes by creating a
Docker image for our app. Then, we write Kubernetes deployment files. We
need to define our app’s container, how many copies we want, and a
service to make it available. For more details, check out <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-deploy-a-simple-web-application-on-kubernetes.html">How
Do I Deploy a Simple Web Application on Kubernetes</a>.</p>
<h3 id="how-do-i-create-a-docker-image-for-my-flask-application-1">2.
How do I create a Docker image for my Flask application?</h3>
<p>To create a Docker image for our Flask application, we need to write
a Dockerfile. This file will tell what base image to use, what
dependencies we need, and how to run our app. We can use Flask’s
official image or a basic Python image. Make sure to copy our
application code into the image. For a full guide, see <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-deploy-a-node-js-application-on-kubernetes.html">How
Do I Deploy a Node.js Application on Kubernetes</a>.</p>
<h3
id="what-kubernetes-resources-are-required-for-deploying-a-flask-app">3.
What Kubernetes resources are required for deploying a Flask app?</h3>
<p>When we deploy a Flask application on Kubernetes, we need some
resources. We need <code>Pods</code> to run our containers. We also need
<code>Deployments</code> to manage our application’s state and
<code>Services</code> for network access. Sometimes we also need
<code>ConfigMaps</code> to manage configurations and
<code>Secrets</code> for private information. To learn more about these
resources, check <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-pods-and-how-do-i-work-with-them.html">What
Are Kubernetes Pods and How Do I Work With Them</a>.</p>
<h3 id="how-can-i-expose-my-flask-application-on-kubernetes">4. How can
I expose my Flask application on Kubernetes?</h3>
<p>To expose our Flask application on Kubernetes, we can create a
<code>Service</code> resource. This service will be a stable point for
our app and send traffic to the right pods. We can choose a
<code>ClusterIP</code>, <code>NodePort</code>, or
<code>LoadBalancer</code> service type based on what we need. For more
instructions, see <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-services-and-how-do-they-expose-applications.html">What
Are Kubernetes Services and How Do They Expose Applications</a>.</p>
<h3
id="what-are-the-best-practices-for-deploying-flask-apps-on-kubernetes-1">5.
What are the best practices for deploying Flask apps on Kubernetes?</h3>
<p>The best practices for deploying Flask applications on Kubernetes
include using environment variables for settings. We should also add
health checks for our pods. It is good to set resource requests and
limits too. We can also think about using horizontal pod autoscaling for
better resource use. To learn more about scaling, see <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-scale-applications-using-kubernetes-deployments.html">How
Do I Scale Applications Using Kubernetes Deployments</a>.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            