
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TFCQEJR7TD');
</script>
            <title>How Do I Monitor My Kubernetes Cluster?</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "BestOnlineTutorial",
      "url": "https://www.bestonlinetutorial.com/"
    }
    </script>

<!-- Common CSS & Icons -->
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
<link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
<link rel="stylesheet" href="/assets/css/post.css">
            <meta name="description" content="Learn effective strategies to monitor your Kubernetes cluster with our comprehensive guide. Ensure performance & reliability!">

            <div id="head-placeholder"></div>
            <script src="/assets/js/blog.js" defer></script>
            <link rel="stylesheet" href="/assets/css/post.css">
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">How Do I Monitor My Kubernetes Cluster?</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>Monitoring a Kubernetes cluster means we keep an eye on how well the
Kubernetes environment is doing. We want to make sure everything runs
smoothly. This includes watching different metrics, logs, and events. By
doing this, we can find problems, use resources better, and keep the
system reliable.</p>
<p>In this article, we will talk about good ways to monitor our
Kubernetes cluster. We will look at the best tools we can use. We will
show you how to set up popular monitoring tools like Prometheus and
Grafana. We will also talk about which metrics are important to watch.
We will explain how to set up alerts for better management. Finally, we
will share tips for fixing common monitoring problems. We will also show
real-life examples that show why monitoring Kubernetes is important.</p>
<ul>
<li>How Can I Effectively Monitor My Kubernetes Cluster?</li>
<li>What Are the Best Tools for Monitoring Kubernetes?</li>
<li>How Do I Set Up Prometheus for Kubernetes Monitoring?</li>
<li>How Do I Use Grafana to Visualize Kubernetes Metrics?</li>
<li>What Metrics Should I Monitor in My Kubernetes Cluster?</li>
<li>How Can I Set Up Alerts for My Kubernetes Cluster?</li>
<li>How Do I Monitor Resource Usage in Kubernetes?</li>
<li>What Are Real-Life Use Cases for Kubernetes Monitoring?</li>
<li>How Can I Troubleshoot Monitoring Issues in Kubernetes?</li>
<li>Frequently Asked Questions</li>
</ul>
<p>For more information on Kubernetes, you can check these articles: <a
href="https://bestonlinetutorial.com/kubernetes/what-is-kubernetes-and-how-does-it-simplify-container-management.html">What
is Kubernetes and How Does it Simplify Container Management?</a> and <a
href="https://bestonlinetutorial.com/kubernetes/why-should-i-use-kubernetes-for-my-applications.html">Why
Should I Use Kubernetes for My Applications?</a>.</p>
<h2 id="what-are-the-best-tools-for-monitoring-kubernetes">What Are the
Best Tools for Monitoring Kubernetes?</h2>
<p>Monitoring a Kubernetes cluster well needs the right tools to
collect, analyze, and show metrics. Here are some of the best tools for
monitoring Kubernetes:</p>
<ol type="1">
<li><strong>Prometheus</strong>
<ul>
<li><p>It is an open-source tool for monitoring and alerting. It is made
for reliability and can grow easily.</p></li>
<li><p>It uses a time-series data model to keep metrics.</p></li>
<li><p>To set up Prometheus in our Kubernetes cluster, we can use this
configuration in a <code>prometheus.yml</code> file:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global</span><span class="kw">:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">scrape_interval</span><span class="kw">:</span><span class="at"> 15s</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">scrape_configs</span><span class="kw">:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">job_name</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;kubernetes-nodes&#39;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">kubernetes_sd_configs</span><span class="kw">:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">role</span><span class="kw">:</span><span class="at"> node</span></span></code></pre></div></li>
</ul></li>
<li><strong>Grafana</strong>
<ul>
<li><p>Grafana is a strong tool for visualization. It works with many
data sources like Prometheus.</p></li>
<li><p>We can easily create dashboards to show metrics and get insights
into how our cluster performs.</p></li>
<li><p>Here is an example of a simple dashboard configuration:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;panels&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;graph&quot;</span><span class="fu">,</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;targets&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;target&quot;</span><span class="fu">:</span> <span class="st">&quot;node_memory_MemAvailable_bytes&quot;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div></li>
</ul></li>
<li><strong>Kube-state-metrics</strong>
<ul>
<li><p>This tool shows metrics about the state of Kubernetes objects
like Pods, Deployments, and Nodes.</p></li>
<li><p>It works with Prometheus to give a full view of the cluster
state.</p></li>
<li><p>We can install it using Helm:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install kube-state-metrics prometheus-community/kube-state-metrics</span></code></pre></div></li>
</ul></li>
<li><strong>Elasticsearch, Fluentd, and Kibana (EFK) Stack</strong>
<ul>
<li>This is a well-known logging solution to gather logs from Kubernetes
applications.</li>
<li>Fluentd collects logs. Elasticsearch indexes them. Kibana gives a UI
to search and analyze logs.</li>
</ul></li>
<li><strong>Datadog</strong>
<ul>
<li>Datadog is a paid monitoring service. It gives real-time visibility
for Kubernetes clusters.</li>
<li>It has features like APM, log management, and automatic
dashboards.</li>
</ul></li>
<li><strong>Sysdig</strong>
<ul>
<li>Sysdig gives deep visibility into Kubernetes and app
performance.</li>
<li>It has security features along with monitoring functions.</li>
</ul></li>
<li><strong>New Relic</strong>
<ul>
<li>New Relic is a cloud-based platform for observability. It supports
monitoring for Kubernetes.</li>
<li>It gives detailed insights into app performance and
infrastructure.</li>
</ul></li>
</ol>
<p>Using these tools will help us make sure that our Kubernetes cluster
is monitored well. This will give us the metrics and insights we need
for the best performance. For more detailed information on how to set up
a Kubernetes cluster, we can check <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-set-up-a-kubernetes-cluster-on-aws-eks.html">how
do I set up a Kubernetes cluster on AWS EKS</a>.</p>
<h2 id="how-do-i-set-up-prometheus-for-kubernetes-monitoring">How Do I
Set Up Prometheus for Kubernetes Monitoring?</h2>
<p>To set up Prometheus for monitoring our Kubernetes cluster, we can
follow these steps:</p>
<ol type="1">
<li><p><strong>Install Prometheus using Helm</strong>:<br />
First, we need to make sure we have Helm installed. Then, we add the
Prometheus community charts and install Prometheus:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> repo add prometheus-community https://prometheus-community.github.io/helm-charts</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> repo update</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install prometheus prometheus-community/prometheus</span></code></pre></div></li>
<li><p><strong>Configure Prometheus</strong>:<br />
We can change the Prometheus settings by making a
<code>values.yaml</code> file. Here is a simple example to get metrics
from Kubernetes nodes and pods:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">server</span><span class="kw">:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">global</span><span class="kw">:</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">scrape_interval</span><span class="kw">:</span><span class="at"> 15s</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClusterIP</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">scrape_configs</span><span class="kw">:</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">job_name</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;kubernetes-nodes&#39;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">kubernetes_sd_configs</span><span class="kw">:</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">role</span><span class="kw">:</span><span class="at"> node</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">job_name</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;kubernetes-pods&#39;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">kubernetes_sd_configs</span><span class="kw">:</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">role</span><span class="kw">:</span><span class="at"> pod</span></span></code></pre></div>
<p>Now we can apply this configuration:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> upgrade prometheus prometheus-community/prometheus <span class="at">-f</span> values.yaml</span></code></pre></div></li>
<li><p><strong>Access Prometheus UI</strong>:<br />
To see the Prometheus dashboard, we can use port-forwarding for the
service:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> port-forward service/prometheus-server 9090:80</span></code></pre></div>
<p>After that, we open our browser and go to
<code>http://localhost:9090</code>.</p></li>
<li><p><strong>Verify Metrics Collection</strong>:<br />
In the Prometheus UI, we go to the “Targets” page. Here, we can check if
Prometheus is collecting metrics from our Kubernetes nodes and
pods.</p></li>
<li><p><strong>Using Service Monitor</strong>:<br />
If we have other apps in our cluster, we can set up a ServiceMonitor to
collect metrics from them. First, we create a YAML file for the
ServiceMonitor:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> monitoring.coreos.com/v1</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ServiceMonitor</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app-monitor</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">endpoints</span><span class="kw">:</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> metrics</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">interval</span><span class="kw">:</span><span class="at"> 30s</span></span></code></pre></div>
<p>Then we apply the ServiceMonitor:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> servicemonitor.yaml</span></code></pre></div></li>
</ol>
<p>When we follow these steps, we will have a working Prometheus
instance. This will help us monitor our Kubernetes cluster well. For
more information on Kubernetes monitoring, we can check <a
href="https://bestonlinetutorial.com/kubernetes/what-are-the-key-components-of-a-kubernetes-cluster.html">this
guide</a>.</p>
<h2 id="how-do-we-use-grafana-to-visualize-kubernetes-metrics">How Do We
Use Grafana to Visualize Kubernetes Metrics?</h2>
<p>To visualize Kubernetes metrics with Grafana, we follow these
steps:</p>
<ol type="1">
<li><p><strong>Install Grafana</strong>: We can deploy Grafana in our
Kubernetes cluster. We can use Helm or a YAML file.</p>
<p><strong>Using Helm</strong>:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> repo add grafana https://grafana.github.io/helm-charts</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install grafana grafana/grafana</span></code></pre></div>
<p><strong>Using YAML</strong>:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> grafana</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> grafana</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> grafana</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> grafana</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">image</span><span class="kw">:</span><span class="at"> grafana/grafana</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">3000</span></span></code></pre></div></li>
<li><p><strong>Access Grafana</strong>: After we install it, we need to
port-forward the Grafana service. This helps us access it on our local
machine.</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> port-forward service/grafana 3000:80</span></code></pre></div></li>
<li><p><strong>Configure Data Source</strong>: We log into Grafana. The
default username and password is <code>admin/admin</code>. Then we add
Prometheus as a data source:</p>
<ul>
<li>Go to <strong>Configuration</strong> &gt; <strong>Data
Sources</strong>.</li>
<li>Click on <strong>Add data source</strong> and pick
<strong>Prometheus</strong>.</li>
<li>Set the URL to our Prometheus server (like
<code>http://prometheus:9090</code>).</li>
<li>Click <strong>Save &amp; Test</strong>.</li>
</ul></li>
<li><p><strong>Create Dashboards</strong>:</p>
<ul>
<li><p>We go to the <strong>Dashboard</strong> section and click on
<strong>New Dashboard</strong>.</p></li>
<li><p>Add a new panel. In the query editor, we select our Prometheus
data source.</p></li>
<li><p>We enter a Prometheus query to see metrics. For example, to show
CPU usage:</p>
<pre class="promql"><code>sum(rate(container_cpu_usage_seconds_total[5m])) by (pod)</code></pre></li>
</ul></li>
<li><p><strong>Customize Visualizations</strong>: We can use the options
to change how the metrics look. We can choose graphs, tables, and other
formats. We can also set thresholds and colors.</p></li>
<li><p><strong>Save the Dashboard</strong>: After we set up our panels
and visualizations, we click on <strong>Save Dashboard</strong>. This
keeps our settings.</p></li>
</ol>
<p>By following these steps, we can use Grafana to visualize metrics
from our Kubernetes cluster. This helps us monitor and analyze our
applications and infrastructure better. For more details on Kubernetes
monitoring tools, we can check <a
href="https://bestonlinetutorial.com/kubernetes/what-are-the-key-components-of-a-kubernetes-cluster.html">this
guide on the best tools for monitoring Kubernetes</a>.</p>
<h2 id="what-metrics-should-we-monitor-in-our-kubernetes-cluster">What
Metrics Should We Monitor in Our Kubernetes Cluster?</h2>
<p>To monitor our Kubernetes cluster well, we need to watch different
metrics. These metrics help us understand how healthy our applications
and infrastructure are. Here are the main metrics we should check:</p>
<ol type="1">
<li><strong>Node Metrics</strong>:
<ul>
<li><strong>CPU Usage</strong>: We should look at the CPU usage of each
node. This helps us see if any node is overloaded.</li>
<li><strong>Memory Usage</strong>: We need to track how much memory is
used. This can help us avoid out-of-memory (OOM) errors.</li>
<li><strong>Disk I/O</strong>: It is important to monitor disk read and
write operations. This helps us find any slow points.</li>
</ul></li>
<li><strong>Pod Metrics</strong>:
<ul>
<li><strong>Pod Status</strong>: We should check if pods are running,
pending, or failed.</li>
<li><strong>Container CPU and Memory Usage</strong>: We can measure the
resource usage of each container in the pods.</li>
</ul>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> top pod <span class="at">--all-namespaces</span></span></code></pre></div>
<ul>
<li><strong>Restarts</strong>: We need to keep an eye on how many times
each pod restarts. This shows us if any applications are not
stable.</li>
</ul></li>
<li><strong>Cluster Metrics</strong>:
<ul>
<li><strong>API Server Latency</strong>: We should measure how quickly
the Kubernetes API server responds. This helps us know if it is working
well.</li>
<li><strong>Scheduler Performance</strong>: We need to monitor how fast
the scheduler is. This ensures our workloads are scheduled
properly.</li>
</ul></li>
<li><strong>Application Metrics</strong>:
<ul>
<li><strong>Application-Specific Metrics</strong>: We should track
metrics that relate to our applications like request rates, error rates,
and response times.</li>
<li><strong>Custom Metrics</strong>: We can create custom metrics that
fit our application needs. For example, user logins or transactions
processed.</li>
</ul></li>
<li><strong>Network Metrics</strong>:
<ul>
<li><strong>Network Traffic</strong>: We need to monitor the traffic
coming in and going out. This helps us understand how the network is
used.</li>
<li><strong>Error Rates</strong>: We should track any failed requests
and errors that happen when services talk to each other.</li>
</ul></li>
<li><strong>Health Checks</strong>:
<ul>
<li><strong>Liveness and Readiness Probes</strong>: We have to ensure
our application is healthy and ready to serve users. We do this by
checking the results of the probes we set up.</li>
</ul></li>
<li><strong>Resource Quotas and Limits</strong>:
<ul>
<li>We should monitor the resource quotas and limits we set for
namespaces. This helps us make sure we follow them and avoid resource
fights.</li>
</ul></li>
<li><strong>Persistent Volume Metrics</strong>:
<ul>
<li>We need to keep an eye on the storage usage and performance of
persistent volumes. This helps us avoid slowdowns in data storage.</li>
</ul></li>
</ol>
<p>To see these metrics clearly, we can use tools like
<strong>Prometheus</strong> and <strong>Grafana</strong>. These tools
help us collect, store, and show the metrics in a useful way. For
example, we can set up Prometheus to gather metrics from our Kubernetes
cluster. Then, we can use Grafana to make dashboards that show the data
for better understanding.</p>
<p>For more details about monitoring Kubernetes, we can check <a
href="https://bestonlinetutorial.com/kubernetes/what-are-the-key-components-of-a-kubernetes-cluster.html">How
Do I Monitor My Kubernetes Cluster?</a>.</p>
<h2 id="how-can-we-set-up-alerts-for-our-kubernetes-cluster">How Can We
Set Up Alerts for Our Kubernetes Cluster?</h2>
<p>Setting up alerts for our Kubernetes cluster is very important. It
helps us keep our applications healthy and running well. We can use
tools like Prometheus with Alertmanager to do this. Here are the steps
we can follow to set up alerts.</p>
<h3 id="step-1-install-prometheus-and-alertmanager">Step 1: Install
Prometheus and Alertmanager</h3>
<p>If we have not set up Prometheus yet, we can deploy it with the YAML
configuration below:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Namespace</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> monitoring</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> prometheus</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">namespace</span><span class="kw">:</span><span class="at"> monitoring</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> prometheus</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> prometheus</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> prometheus</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> prom/prometheus</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">args</span><span class="kw">:</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> --config.file=/etc/prometheus/prometheus.yml</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> --storage.tsdb.path=/prometheus</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">9090</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">volumeMounts</span><span class="kw">:</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> config-volume</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">mountPath</span><span class="kw">:</span><span class="at"> /etc/prometheus</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> data-volume</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">mountPath</span><span class="kw">:</span><span class="at"> /prometheus</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> config-volume</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">configMap</span><span class="kw">:</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">name</span><span class="kw">:</span><span class="at"> prometheus-config</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> data-volume</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">emptyDir</span><span class="kw">:</span><span class="at"> </span><span class="kw">{}</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> prometheus</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">namespace</span><span class="kw">:</span><span class="at"> monitoring</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">9090</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">9090</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">app</span><span class="kw">:</span><span class="at"> prometheus</span></span></code></pre></div>
<h3 id="step-2-configure-alertmanager">Step 2: Configure
Alertmanager</h3>
<p>Next, we need to make a ConfigMap for Alertmanager. Here is an
example:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> alertmanager-config</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">namespace</span><span class="kw">:</span><span class="at"> monitoring</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">  alertmanager.yml</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    global:</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>      resolve_timeout: 5m</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    route:</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>      group_by: [&#39;alertname&#39;]</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>      group_wait: 30s</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>      group_interval: 5m</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>      repeat_interval: 1h</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>      receiver: &#39;team-X-mails&#39;</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    receivers:</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    - name: &#39;team-X-mails&#39;</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>      email_configs:</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>      - to: &#39;team-X@example.com&#39;</span></code></pre></div>
<h3 id="step-3-create-alert-rules">Step 3: Create Alert Rules</h3>
<p>We also need to create alerting rules in Prometheus. We can make a
ConfigMap for the rules:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> ConfigMap</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> prometheus-rules</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">namespace</span><span class="kw">:</span><span class="at"> monitoring</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">  alert.rules</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    groups:</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    - name: example-alerts</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>      rules:</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>      - alert: HighCpuUsage</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>        expr: sum(rate(container_cpu_usage_seconds_total{job=&quot;kubelet&quot;}[5m])) by (pod) &gt; 0.9</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>        for: 5m</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>        labels:</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>          severity: warning</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>        annotations:</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>          summary: &quot;High CPU Usage Detected&quot;</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>          description: &quot;Pod {{ $labels.pod }} is using more than 90% CPU.&quot;</span></code></pre></div>
<h3 id="step-4-deploy-alertmanager">Step 4: Deploy Alertmanager</h3>
<p>Now we can deploy Alertmanager using this configuration:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> alertmanager</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">namespace</span><span class="kw">:</span><span class="at"> monitoring</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> alertmanager</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> alertmanager</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> alertmanager</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> prom/alertmanager</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">args</span><span class="kw">:</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> --config.file=/etc/alertmanager/alertmanager.yml</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">9093</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">volumeMounts</span><span class="kw">:</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> config-volume</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">mountPath</span><span class="kw">:</span><span class="at"> /etc/alertmanager</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> config-volume</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">configMap</span><span class="kw">:</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">name</span><span class="kw">:</span><span class="at"> alertmanager-config</span></span></code></pre></div>
<h3 id="step-5-integrate-alertmanager-with-prometheus">Step 5: Integrate
Alertmanager with Prometheus</h3>
<p>Next, we need to change our Prometheus configuration to include
Alertmanager:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global</span><span class="kw">:</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">scrape_interval</span><span class="kw">:</span><span class="at"> 15s</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">evaluation_interval</span><span class="kw">:</span><span class="at"> 15s</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">alerting</span><span class="kw">:</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">alertmanagers</span><span class="kw">:</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">static_configs</span><span class="kw">:</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">targets</span><span class="kw">:</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> alertmanager.monitoring.svc:9093</span></span></code></pre></div>
<h3 id="step-6-test-alerts">Step 6: Test Alerts</h3>
<p>We can test alerts by simulating high CPU usage or other conditions
we defined in our alert rules. We should check Alertmanager to see if we
get notifications.</p>
<p>These steps will help us set up a good alerting system for our
Kubernetes cluster. We can respond fast to any problems that come up.
For more about Kubernetes monitoring, we can look at <a
href="https://bestonlinetutorial.com/kubernetes/what-are-the-key-components-of-a-kubernetes-cluster.html">this
article on Kubernetes monitoring tools</a>.</p>
<h2 id="how-do-we-monitor-resource-usage-in-kubernetes">How Do We
Monitor Resource Usage in Kubernetes?</h2>
<p>Monitoring resource use in a Kubernetes cluster is very important. It
helps us keep our applications running well and reliably. We can track
CPU, memory, and disk use for pods and nodes using many tools and
methods.</p>
<p>To monitor resource use, we can use the following ways:</p>
<h3 id="using-kubectl-top">1. Using <code>kubectl top</code></h3>
<p>The <code>kubectl top</code> command gives us a quick look at the
resource use of our nodes and pods. We need to have the metrics-server
installed in our cluster first.</p>
<ul>
<li><p>To see node use:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> top nodes</span></code></pre></div></li>
<li><p>To see pod use:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> top pods <span class="at">--all-namespaces</span></span></code></pre></div></li>
</ul>
<h3 id="metrics-server">2. Metrics Server</h3>
<p>Metrics Server collects resource use data for the whole cluster. We
can install it with this command:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml</span></code></pre></div>
<p>After we install it, we can use the <code>kubectl top</code> command
we talked about before.</p>
<h3 id="prometheus">3. Prometheus</h3>
<p>Prometheus is a strong tool for monitoring. It can collect metrics
from our Kubernetes cluster. To set it up, we follow these steps:</p>
<ul>
<li><p>Install Prometheus using Helm:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install prometheus prometheus-community/prometheus</span></code></pre></div></li>
<li><p>We need to set Prometheus to collect metrics. We add this to our
<code>values.yaml</code>:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">serviceMonitor</span><span class="kw">:</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code></pre></div></li>
</ul>
<h3 id="grafana-for-visualization">4. Grafana for Visualization</h3>
<p>We can connect Grafana with Prometheus to see the metrics clearly. We
can install Grafana with Helm:</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install grafana grafana/grafana</span></code></pre></div>
<p>After we install it, we add Prometheus as a data source. Then we can
make dashboards to see CPU and memory use.</p>
<h3 id="custom-metrics">5. Custom Metrics</h3>
<p>We can also make custom metrics using the Kubernetes API. This helps
us track resource use for our specific applications. We can use this
example to create a custom metric:</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> metrics.k8s.io/v1beta1</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> PodMetrics</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> example-pod</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">namespace</span><span class="kw">:</span><span class="at"> default</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">timestamp</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;2023-01-01T00:00:00Z&quot;</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">window</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;30s&quot;</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> example-container</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">usage</span><span class="kw">:</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cpu</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;100m&quot;</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">memory</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;256Mi&quot;</span></span></code></pre></div>
<h3 id="resource-requests-and-limits">6. Resource Requests and
Limits</h3>
<p>We should set resource requests and limits for our pods. This helps
us monitor resource use better. Here is an example of how to set
requests and limits in a deployment:</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> example-deployment</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> example-container</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> nginx</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">requests</span><span class="kw">:</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">memory</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;128Mi&quot;</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">cpu</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;250m&quot;</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">limits</span><span class="kw">:</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">memory</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;256Mi&quot;</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">cpu</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;500m&quot;</span></span></code></pre></div>
<h3 id="third-party-tools">7. Third-Party Tools</h3>
<p>We can also think about using third-party tools like Datadog, New
Relic, or Sysdig. These tools give us good monitoring for Kubernetes
clusters. They also help us track resource use.</p>
<p>By using these methods and tools, we can monitor resource use in our
Kubernetes cluster. This helps us keep everything running well and
manage resources better.</p>
<h2 id="what-are-real-life-use-cases-for-kubernetes-monitoring">What Are
Real-Life Use Cases for Kubernetes Monitoring?</h2>
<p>Kubernetes monitoring is very important for keeping our applications
healthy and working well in a Kubernetes cluster. Here are some
real-life examples where good monitoring is very necessary:</p>
<ol type="1">
<li><strong>Performance Monitoring</strong>:
<ul>
<li>We can track how much CPU and memory our pods and nodes are using.
This helps us keep everything running smoothly.</li>
<li>For example, we can use Prometheus to get metrics and show them in
Grafana.</li>
</ul></li>
<li><strong>Capacity Planning</strong>:
<ul>
<li>We should look at past usage data to guess how much resource we will
need in the future. This helps us avoid running out of resources.</li>
<li>For example, we can watch how pods scale and how nodes use resources
over time.</li>
</ul></li>
<li><strong>Health Checks</strong>:
<ul>
<li><p>We can set up liveness and readiness probes. These help us check
if our applications are healthy and running well.</p></li>
<li><p>Here is a simple YAML code:</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">readinessProbe</span><span class="kw">:</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">httpGet</span><span class="kw">:</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /healthz</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">initialDelaySeconds</span><span class="kw">:</span><span class="at"> </span><span class="dv">5</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">periodSeconds</span><span class="kw">:</span><span class="at"> </span><span class="dv">10</span></span></code></pre></div></li>
</ul></li>
<li><strong>Alerting</strong>:
<ul>
<li>We can create alerts for important issues like high CPU usage or
when memory limits get too close. This helps us fix problems
quickly.</li>
<li>For example, we can use Alertmanager with Prometheus to send alerts
through email or Slack when resource use goes over limits we set.</li>
</ul></li>
<li><strong>Debugging</strong>:
<ul>
<li>We can use monitoring data to fix problems when deployments fail or
when performance goes down.</li>
<li>For example, we can look at logs and metrics together to find issues
in how our application runs.</li>
</ul></li>
<li><strong>Cost Management</strong>:
<ul>
<li>We should keep track of how much it costs to run our services in the
cloud by checking resource use and improving our deployments based on
what we really need.</li>
<li>For example, we can use tools like kube-cost to look at costs of
Kubernetes resources.</li>
</ul></li>
<li><strong>Security Monitoring</strong>:
<ul>
<li>We need to watch the activity in our cluster for unauthorized access
or strange behavior. This helps us stay safe and follow security
rules.</li>
<li>For example, we can use tools like Falco to find unusual actions and
possible security risks.</li>
</ul></li>
<li><strong>Service Level Objective (SLO) Tracking</strong>:
<ul>
<li>We can check how well our applications perform against the SLOs we
set. This helps us keep users happy.</li>
<li>For example, we can use custom metrics to see response times and
error rates that matter for our SLOs.</li>
</ul></li>
<li><strong>Deployment Validation</strong>:
<ul>
<li>We should monitor our applications during and after deployments.
This way, we can make sure new versions do not slow things down.</li>
<li>For example, we can use canary deployments and adjust them based on
what we see from monitoring before we fully release changes.</li>
</ul></li>
<li><strong>Cluster Optimization</strong>:
<ul>
<li>We can look at performance data from our cluster to make nodes,
pods, and services work better together.</li>
<li>For example, we can check metrics to find nodes that are not being
used much and think about resizing or combining workloads.</li>
</ul></li>
</ol>
<p>By using Kubernetes monitoring well, we can make sure our
applications are fast, safe, and cost-efficient. For more detailed info
on how to set up monitoring tools, check out <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-set-up-prometheus-for-kubernetes-monitoring.html">how
to set up Prometheus for Kubernetes monitoring</a>.</p>
<h2 id="how-can-we-troubleshoot-monitoring-issues-in-kubernetes">How Can
We Troubleshoot Monitoring Issues in Kubernetes?</h2>
<p>To troubleshoot monitoring issues in Kubernetes, we can follow these
steps:</p>
<ol type="1">
<li><p><strong>Check Prometheus Status</strong>:<br />
First, we should ensure that Prometheus is running and collecting
metrics. We can access the Prometheus UI at
<code>http://&lt;prometheus-ip&gt;:9090</code> and check the “Targets”
page for any targets that are down.</p></li>
<li><p><strong>Verify Metrics Availability</strong>:<br />
Next, we can use the Prometheus query interface to run a simple query.
For example:</p>
<pre class="plaintext"><code>up</code></pre>
<p>This helps us see if our targets are sending metrics. If the result
is zero, it means the targets might be set up wrong or we cannot reach
them.</p></li>
<li><p><strong>Examine Logs</strong>:<br />
We need to check the logs of our monitoring tools for errors. To see
Prometheus logs, we can use:</p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> logs <span class="op">&lt;</span>prometheus-pod-name<span class="op">&gt;</span> -n <span class="op">&lt;</span>namespace<span class="op">&gt;</span></span></code></pre></div></li>
<li><p><strong>Inspect Grafana Configuration</strong>:<br />
We should make sure Grafana is set up right to connect to Prometheus. We
can check the data source settings in Grafana under
<code>Configuration &gt; Data Sources</code>.</p></li>
<li><p><strong>Review Service Discovery</strong>:<br />
Let’s confirm that our service discovery setup, like Kubernetes service
discovery, is working in the Prometheus <code>prometheus.yml</code>
file:</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scrape_configs</span><span class="kw">:</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">job_name</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;kubernetes-nodes&#39;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">kubernetes_sd_configs</span><span class="kw">:</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">role</span><span class="kw">:</span><span class="at"> node</span></span></code></pre></div></li>
<li><p><strong>Network Policies and Firewalls</strong>:<br />
We need to check for any network rules or firewalls that might block
traffic between Prometheus, Grafana, or our application pods.</p></li>
<li><p><strong>Resource Limits</strong>:<br />
It’s important to make sure our monitoring tools have enough resources.
If Prometheus or Grafana does not get enough CPU or memory, it may not
work right. We can check and change resource limits in the deployment
YAML:</p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">requests</span><span class="kw">:</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">memory</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;512Mi&quot;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">cpu</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;500m&quot;</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">limits</span><span class="kw">:</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">memory</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;1Gi&quot;</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">cpu</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;1&quot;</span></span></code></pre></div></li>
<li><p><strong>Node Health</strong>:<br />
We have to confirm that our Kubernetes nodes are healthy. We can use
this command:</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get nodes</span></code></pre></div>
<p>We should check for any nodes that are in a NotReady state.</p></li>
<li><p><strong>Pod Status</strong>:<br />
Let’s review the status of our monitoring pods:</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get pods <span class="at">-n</span> <span class="op">&lt;</span>namespace<span class="op">&gt;</span></span></code></pre></div>
<p>We should look for any pods that show CrashLoopBackOff or
Error.</p></li>
<li><p><strong>Examine Alerts</strong>:<br />
If alerts are not going off, we need to check the alert rules in
Prometheus. We must make sure they are set correctly and that the
conditions are met.</p></li>
<li><p><strong>Kubernetes Events</strong>:<br />
Finally, we can check for any important Kubernetes events that might
show issues:
<code>bash     kubectl get events --sort-by='.metadata.creationTimestamp'</code></p></li>
</ol>
<p>By following these steps, we can find and fix monitoring issues in
our Kubernetes cluster. For more help with Kubernetes monitoring, we can
look at <a
href="https://bestonlinetutorial.com/kubernetes/what-are-the-key-components-of-a-kubernetes-cluster.html">this
guide on monitoring your Kubernetes cluster</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3 id="what-are-the-key-metrics-to-monitor-in-a-kubernetes-cluster">1.
What are the key metrics to monitor in a Kubernetes cluster?</h3>
<p>To monitor our Kubernetes cluster well, we need to track some
important metrics. These include CPU usage, memory use, disk I/O, and
network traffic. We also should check pod status, node health, and how
our services perform. This helps us keep our cluster running smoothly.
For more information on Kubernetes metrics, we can read <a
href="https://bestonlinetutorial.com/kubernetes/what-are-the-key-components-of-a-kubernetes-cluster.html">What
Are the Best Tools for Monitoring Kubernetes?</a>.</p>
<h3
id="how-do-i-troubleshoot-monitoring-issues-in-my-kubernetes-cluster">2.
How do I troubleshoot monitoring issues in my Kubernetes cluster?</h3>
<p>When we have monitoring issues in our Kubernetes cluster, we should
check the setup of our monitoring tools like Prometheus and Grafana. We
need to make sure that metrics are collected right and there are no
connection problems. The logs from our monitoring tools can give us
clues about any issues. For more tips, we can look at <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-use-kubernetes-namespaces-for-resource-isolation.html">How
Can I Troubleshoot Monitoring Issues in Kubernetes?</a>.</p>
<h3 id="can-i-set-up-alerts-for-my-kubernetes-cluster">3. Can I set up
alerts for my Kubernetes cluster?</h3>
<p>Yes, we can set up alerts for our Kubernetes cluster using tools like
Prometheus Alertmanager. By making alert rules based on certain metrics
and limits, we can get notifications by email, Slack, or other ways when
problems happen. For step-by-step guides, we can check <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-install-minikube-for-local-kubernetes-development.html">How
Can I Set Up Alerts for My Kubernetes Cluster?</a>.</p>
<h3 id="what-are-the-best-tools-for-monitoring-kubernetes-1">4. What are
the best tools for monitoring Kubernetes?</h3>
<p>The best tools for monitoring Kubernetes are Prometheus for
collecting metrics, Grafana for showing data in a visual way, and ELK
Stack for logging. These tools help us monitor our cluster well. They
allow us to see performance, fix problems, and keep our Kubernetes
environment running well. To learn more, we can read <a
href="https://bestonlinetutorial.com/kubernetes/how-does-kubernetes-differ-from-docker-swarm.html">What
Are the Best Tools for Monitoring Kubernetes?</a>.</p>
<h3 id="how-do-i-visualize-kubernetes-metrics-using-grafana">5. How do I
visualize Kubernetes metrics using Grafana?</h3>
<p>To see Kubernetes metrics using Grafana, we first need to set up a
data source that connects to Prometheus. After this, we can create
dashboards that show different metrics like pod status and resource use.
Grafana has many options for visualization to help us monitor our
cluster better. For more info, we should check <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-deploy-a-kubernetes-cluster-on-aws-eks.html">How
Do I Use Grafana to Visualize Kubernetes Metrics?</a>.</p>
<p>By answering these frequently asked questions, we can improve our
understanding of monitoring our Kubernetes cluster. This will help us
keep a healthy and good working place for our applications.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            