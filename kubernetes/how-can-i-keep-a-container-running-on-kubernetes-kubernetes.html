
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
            <!-- Google tag (gtag.js) -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
            <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-TFCQEJR7TD');
            </script>
            
            <title>How can I keep a container running on Kubernetes? - kubernetes</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Common CSS & Icons -->
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
<link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
<link rel="stylesheet" href="/assets/css/post.css">
            <meta name="description" content="Learn effective strategies to keep your container running on Kubernetes. Discover tips, best practices, and troubleshooting methods!">
            <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	        <script src="/assets/js/blog.js"></script>
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">How can I keep a container running on Kubernetes? - kubernetes</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>To keep a container running on Kubernetes, we can use different ways
that help containers stay strong and work well. One good way is to use a
Kubernetes Deployment. This tool helps us manage our application. It
makes sure that the right number of copies of our app are always
running. We can also set up restart policies. This helps us fix
containers that crash due to errors. This way, our application can keep
running smoothly in Kubernetes.</p>
<p>In this article, we will look at different ways to make sure our
containers stay working on Kubernetes. We will talk about Kubernetes
Deployments for strength, restart policies, DaemonSets for always
running, and using Jobs for processes that take a long time. We will
also see how to check and grow our applications with the Kubernetes
Horizontal Pod Autoscaler. Here is what we will talk about:</p>
<ul>
<li>How to Keep Containers Running in Kubernetes</li>
<li>Using Kubernetes Deployment for Strong Containers</li>
<li>Setting Up Kubernetes Restart Policies</li>
<li>Using Kubernetes DaemonSets for Always Running</li>
<li>Using Kubernetes Jobs for Long Processes</li>
<li>Checking and Growing with Kubernetes Horizontal Pod Autoscaler</li>
<li>Questions We Often Get</li>
</ul>
<p>For more information about Kubernetes and managing containers, you
can read articles like <a
href="https://bestonlinetutorial.com/kubernetes/what-is-kubernetes-and-how-does-it-simplify-container-management.html">What
is Kubernetes and How Does it Simplify Container Management?</a> and <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-deploy-a-simple-web-application-on-kubernetes.html">How
Do I Deploy a Simple Web Application on Kubernetes?</a>.</p>
<h2
id="utilizing-kubernetes-deployment-for-container-resilience">Utilizing
Kubernetes Deployment for Container Resilience</h2>
<p>We can use Kubernetes Deployments to make sure our containers run
well and can handle problems. A Deployment helps us update Pods and
ReplicaSets in a clear way. This lets us keep our applications in the
state we want. So our container apps keep running, even if there is a
problem.</p>
<p>To make a Deployment, we can use this YAML setup:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-container</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-image:latest</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span></span></code></pre></div>
<h3 id="key-features-of-kubernetes-deployments">Key Features of
Kubernetes Deployments:</h3>
<ul>
<li><strong>Self-healing</strong>: If a Pod stops working, the
Deployment controller will replace it. This keeps the number of replicas
we want.</li>
<li><strong>Rolling updates</strong>: We can update our app without
waiting. We do this by slowly changing Pods to new ones with the
<code>kubectl apply</code> command.</li>
<li><strong>Rollback capability</strong>: If an update causes a problem,
we can quickly go back to the last stable version.</li>
</ul>
<h3 id="managing-deployments">Managing Deployments</h3>
<p>To manage our Deployment, we can use these <code>kubectl</code>
commands:</p>
<ul>
<li><p><strong>Create a Deployment</strong>:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> deployment.yaml</span></code></pre></div></li>
<li><p><strong>Update a Deployment</strong>:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> set image deployment/my-app my-container=my-image:v2</span></code></pre></div></li>
<li><p><strong>Rollback to a previous version</strong>:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> rollout undo deployment/my-app</span></code></pre></div></li>
<li><p><strong>Check the status of a Deployment</strong>:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> rollout status deployment/my-app</span></code></pre></div></li>
</ul>
<p>Deployments work nicely with other Kubernetes things like Services.
This helps us show our app easily. For more tips on managing Kubernetes
Deployments, check this article on <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-deployments-and-how-do-i-use-them.html">Kubernetes
Deployments</a>.</p>
<h2 id="implementing-kubernetes-restart-policies">Implementing
Kubernetes Restart Policies</h2>
<p>Kubernetes gives us some restart policies to manage how containers
run. These policies help us decide what to do when a container fails.
They make sure our applications keep running.</p>
<h3 id="restart-policy-types">Restart Policy Types</h3>
<p>Kubernetes has three main restart policies:</p>
<ol type="1">
<li><strong>Always</strong>: The container will restart every time. It
does not matter how it stops. This is the default for Deployments.</li>
<li><strong>OnFailure</strong>: The container will restart only if it
stops with a failure status (a number that is not zero).</li>
<li><strong>Never</strong>: The container will not restart no matter how
it stops.</li>
</ol>
<h3 id="example-configuration">Example Configuration</h3>
<p>To add a restart policy in a Pod specification, we can write it in
the YAML file like this:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Pod</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> example-pod</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">restartPolicy</span><span class="kw">:</span><span class="at"> OnFailure</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> example-container</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-image:latest</span></span></code></pre></div>
<h3 id="using-restart-policies-in-deployments">Using Restart Policies in
Deployments</h3>
<p>When we use a Deployment, the restart policy must be set to
<code>Always</code>. We cannot change this because it is the default.
Here is an example:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> example-deployment</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> example</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> example</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> example-container</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-image:latest</span></span></code></pre></div>
<h3 id="considerations">Considerations</h3>
<ul>
<li><strong>Resource Management</strong>: We should watch how much
resources our containers use. Too many restarts can use up resources
fast.</li>
<li><strong>Graceful Shutdown</strong>: We need to set up proper
shutdown hooks. This helps containers to stop nicely and not end
suddenly.</li>
</ul>
<p>By setting the right restart policies, we can keep our Kubernetes
applications running well. They will have high availability and be
reliable even when problems happen. If we want to learn more about
Kubernetes, we can check out <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-deployments-and-how-do-i-use-them.html">what
are Kubernetes deployments and how do I use them</a>.</p>
<h2
id="leveraging-kubernetes-daemonsets-for-continuous-execution">Leveraging
Kubernetes DaemonSets for Continuous Execution</h2>
<p>Kubernetes DaemonSets make sure that a certain pod runs on all or
some nodes in a cluster. This helps us run background processes all the
time. It works great for tasks like monitoring, logging, and other
system services that need to be on every node.</p>
<h3 id="creating-a-daemonset">Creating a DaemonSet</h3>
<p>To create a DaemonSet, we need to make a YAML configuration file.
Here is a simple example that puts a logging agent on every node:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> DaemonSet</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> fluentd</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">namespace</span><span class="kw">:</span><span class="at"> kube-system</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span><span class="at"> fluentd</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">name</span><span class="kw">:</span><span class="at"> fluentd</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> fluentd</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> fluent/fluentd:v1.12-1</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> FLUENTD_CONF</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;fluentd.conf&quot;</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">volumeMounts</span><span class="kw">:</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> varlog</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">mountPath</span><span class="kw">:</span><span class="at"> /var/log</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> varlog</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">hostPath</span><span class="kw">:</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /var/log</span></span></code></pre></div>
<h3 id="deploying-the-daemonset">Deploying the DaemonSet</h3>
<p>We can apply the configuration by using this command:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> fluentd-daemonset.yaml</span></code></pre></div>
<h3 id="validating-daemonset-deployment">Validating DaemonSet
Deployment</h3>
<p>To see the status of the DaemonSet, we can use:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get daemonsets <span class="at">-n</span> kube-system</span></code></pre></div>
<h3 id="updating-and-managing-daemonsets">Updating and Managing
DaemonSets</h3>
<p>We can update a DaemonSet by changing the YAML file and applying it
again. Kubernetes will handle the updates by itself. It will make sure
all nodes run the latest version of the pod.</p>
<h3 id="common-use-cases-for-daemonsets">Common Use Cases for
DaemonSets</h3>
<ul>
<li><strong>Logging Agents</strong>: Use logging tools like Fluentd or
Logstash.</li>
<li><strong>Monitoring Agents</strong>: Run monitoring tools like
Prometheus Node Exporter on each node.</li>
<li><strong>Network Proxies</strong>: Use sidecar proxies to manage
network traffic.</li>
</ul>
<p>DaemonSets are very important for keeping critical background tasks
running all the time in our Kubernetes cluster. They help us with
resilience and make our operations more efficient. For more info on
Kubernetes parts, check <a
href="https://bestonlinetutorial.com/kubernetes/what-are-the-key-components-of-a-kubernetes-cluster.html">Kubernetes
Components Overview</a>.</p>
<h2 id="using-kubernetes-jobs-for-long-running-processes">Using
Kubernetes Jobs for Long-Running Processes</h2>
<p>Kubernetes Jobs help us manage pods that do a specific task until
they finish. This makes them great for long-running processes. When we
want to run batch jobs or tasks that must finish reliably, Kubernetes
Jobs keep the containers running until the task is done.</p>
<h3 id="creating-a-kubernetes-job">Creating a Kubernetes Job</h3>
<p>To make a Kubernetes Job, we can write a YAML configuration file.
Here is an example of a simple Job that runs a Python script:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> batch/v1</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Job</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-long-running-job</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-job-container</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> python:3.8</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">command</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">&quot;python&quot;</span><span class="kw">,</span><span class="at"> </span><span class="st">&quot;-c&quot;</span><span class="kw">,</span><span class="at"> </span><span class="st">&quot;import time; time.sleep(3600)&quot;</span><span class="kw">]</span><span class="co">  # Simulates a long-running process</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">restartPolicy</span><span class="kw">:</span><span class="at"> Never</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">backoffLimit</span><span class="kw">:</span><span class="at"> </span><span class="dv">4</span></span></code></pre></div>
<h3 id="key-properties">Key Properties</h3>
<ul>
<li><strong>restartPolicy</strong>: We set this to <code>Never</code>
for jobs. This means the pod will not restart if it fails.</li>
<li><strong>backoffLimit</strong>: This tells how many times to try
again before saying the job failed.</li>
<li><strong>completionMode</strong> (optional): If we set this to
<code>Indexed</code>, it lets the job manage many pods with indexed
results.</li>
</ul>
<h3 id="submitting-the-job">Submitting the Job</h3>
<p>To send this Job to our Kubernetes cluster, we use this command:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> my-long-running-job.yaml</span></code></pre></div>
<h3 id="monitoring-the-job">Monitoring the Job</h3>
<p>We can check the status of the Job with:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get jobs</span></code></pre></div>
<p>To see the logs of the Job’s pods, we run:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> logs job/my-long-running-job</span></code></pre></div>
<h3 id="cleanup">Cleanup</h3>
<p>After the Job finishes successfully, it creates a pod that we can
delete. We can clean up completed jobs with:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> delete job my-long-running-job</span></code></pre></div>
<p>Using Kubernetes Jobs the right way helps us manage long-running
processes. This way, we make sure they finish correctly. If we want to
learn more about managing and deploying apps in Kubernetes, we can look
at <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-run-batch-jobs-in-kubernetes-with-jobs-and-cronjobs.html">Kubernetes
Jobs and CronJobs</a>.</p>
<h2
id="monitoring-and-scaling-with-kubernetes-horizontal-pod-autoscaler">Monitoring
and Scaling with Kubernetes Horizontal Pod Autoscaler</h2>
<p>We use the Kubernetes Horizontal Pod Autoscaler (HPA) to change the
number of pod replicas in a deployment. It does this based on CPU usage
or other metrics we choose. This helps our application to grow or shrink
based on the load.</p>
<h3 id="prerequisites">Prerequisites</h3>
<ul>
<li>We must have a running Kubernetes cluster.</li>
<li>We need to install the metrics server in our cluster to gather
metrics.</li>
</ul>
<h3 id="basic-hpa-configuration">Basic HPA Configuration</h3>
<p>To create an HPA, we can use the following YAML configuration. This
example scales the pods based on CPU usage.</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> autoscaling/v2beta2</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> HorizontalPodAutoscaler</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> myapp-hpa</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">scaleTargetRef</span><span class="kw">:</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> myapp</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">minReplicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">maxReplicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">10</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">metrics</span><span class="kw">:</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Resource</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">resource</span><span class="kw">:</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span><span class="at"> cpu</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">target</span><span class="kw">:</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> AverageUtilization</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">averageUtilization</span><span class="kw">:</span><span class="at"> </span><span class="dv">50</span></span></code></pre></div>
<h3 id="applying-hpa-configuration">Applying HPA Configuration</h3>
<p>We apply the HPA configuration with kubectl:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> hpa.yaml</span></code></pre></div>
<h3 id="viewing-hpa-status">Viewing HPA Status</h3>
<p>To see the status of our HPA, we can run:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get hpa</span></code></pre></div>
<h3 id="autoscaling-with-custom-metrics">Autoscaling with Custom
Metrics</h3>
<p>If we want to scale using custom metrics, we must make sure that the
metrics server can support it. We will also change the HPA definition.
Here is an example using a custom metric:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">metrics</span><span class="kw">:</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Object</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">object</span><span class="kw">:</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">metric</span><span class="kw">:</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">name</span><span class="kw">:</span><span class="at"> requests_per_second</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">target</span><span class="kw">:</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> AverageValue</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">averageValue</span><span class="kw">:</span><span class="at"> </span><span class="dv">100</span></span></code></pre></div>
<h3 id="monitoring-with-metrics-server">Monitoring with Metrics
Server</h3>
<p>We need to make sure the metrics server is running and set up
correctly in our cluster. If we have problems, we should check the
logs:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get pods <span class="at">-n</span> kube-system</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> logs <span class="at">-l</span> k8s-app=metrics-server <span class="at">-n</span> kube-system</span></code></pre></div>
<h3 id="important-considerations">Important Considerations</h3>
<ul>
<li>We can use HPA with the <strong>Vertical Pod Autoscaler</strong> to
get the best resource usage.</li>
<li>It is always good to test autoscaling in a staging environment
before going to production. This helps to make sure it works well.</li>
</ul>
<p>For more details on configuring autoscaling, we can check the <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-use-horizontal-pod-autoscaler-hpa-to-scale-my-application.html">Kubernetes
documentation on Horizontal Pod Autoscaler</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3 id="how-can-we-ensure-our-container-stays-running-in-kubernetes">1.
How can we ensure our container stays running in Kubernetes?</h3>
<p>To make sure our container keeps working in Kubernetes, we can use a
<strong>Kubernetes Deployment</strong>. This helps us manage our
application’s lifecycle. It automatically handles updates and scaling.
If our container crashes, the Deployment starts a new one to take its
place. This helps keep our application available. For more information,
we can check our guide on <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-deployments-and-how-do-i-use-them.html">Kubernetes
Deployments</a>.</p>
<h3 id="what-are-kubernetes-restart-policies-and-how-do-they-work">2.
What are Kubernetes Restart Policies, and how do they work?</h3>
<p>Kubernetes Restart Policies tell us how containers should restart
after they fail. We can set these policies in our Pod specifications.
Some common options are <code>Always</code>, <code>OnFailure</code>, or
<code>Never</code>. By choosing the right policy, we can make sure our
containerized applications restart automatically when needed. This helps
keep everything running. To learn more about Pods, we can read our
article on <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-manage-the-lifecycle-of-a-kubernetes-pod.html">Kubernetes
Pod Lifecycle</a>.</p>
<h3 id="can-we-use-kubernetes-jobs-for-long-running-processes">3. Can we
use Kubernetes Jobs for long-running processes?</h3>
<p>Yes, Kubernetes Jobs are good for short tasks that need to finish.
But for long-running processes, we should use
<strong>Deployments</strong> or <strong>DaemonSets</strong>. Deployments
help scale and heal applications that run all the time. This makes sure
they keep working. For more details on managing workloads, we can look
at our article on <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-run-batch-jobs-in-kubernetes-with-jobs-and-cronjobs.html">Kubernetes
Jobs</a>.</p>
<h3
id="how-does-the-horizontal-pod-autoscaler-hpa-help-with-container-operation">4.
How does the Horizontal Pod Autoscaler (HPA) help with container
operation?</h3>
<p>The Horizontal Pod Autoscaler (HPA) changes the number of Pods in a
Deployment based on CPU use or other chosen metrics. This helps our
application deal with different workloads easily. It keeps everything
running well during busy times. For more information about HPA, we can
visit our guide on <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-autosale-my-applications-with-horizontal-pod-autoscaler-hpa.html">Using
Horizontal Pod Autoscaler</a>.</p>
<h3 id="what-role-do-daemonsets-play-in-keeping-containers-running">5.
What role do DaemonSets play in keeping containers running?</h3>
<p>DaemonSets in Kubernetes make sure there is a copy of a Pod on all or
some nodes in a cluster. This is useful for monitoring, logging, or
other tasks that need a container on every node. By managing these Pods
automatically, DaemonSets help our applications stay reliable and
running. To understand more, we can read our article on <a
href="https://bestonlinetutorial.com/kubernetes/what-are-kubernetes-daemonsets-and-when-should-i-use-them.html">Kubernetes
DaemonSets</a>.</p>
<p>These FAQs cover the key methods for keeping containers running in
Kubernetes. They address common questions and highlight good strategies
for managing containerized applications.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            