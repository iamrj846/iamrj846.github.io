
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
            <!-- Google tag (gtag.js) -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
            <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-TFCQEJR7TD');
            </script>
            <meta charset="utf-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <!-- Common CSS & Icons -->
            <link rel="icon" href="/favicon.ico" type="image/x-icon">
            <link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
            <link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
            <link rel="stylesheet" href="/assets/css/post.css">
            <title>Can I Configure Custom Ports for Kubernetes Ingress Beyond 80 and 443?</title>
            <meta name="description" content="Discover how to configure custom ports for Kubernetes Ingress beyond 80 and 443 to enhance your application deployment flexibility.">
            <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	        <script src="/assets/js/blog.js"></script>
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">Can I Configure Custom Ports for Kubernetes Ingress Beyond 80 and 443?</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>Yes, we can set up custom ports for Kubernetes Ingress. This is
possible beyond the default ports 80 and 443. By changing some settings
in our Ingress resources, we can show our applications on any port we
want. This gives us more flexibility for different services and helps us
meet different networking needs.</p>
<p>In this article, we will look at how to set up custom ports for
Kubernetes Ingress. We will learn about Kubernetes Ingress controllers
and their limits. We will explain how to define custom ports in Ingress
resources. Also, we will see how to set up NodePort and LoadBalancer
services for custom ports. We will also use the NGINX Ingress Controller
to manage custom ports better. Lastly, we will answer some common
questions about this topic.</p>
<ul>
<li>Understanding Kubernetes Ingress Controllers and Their Limits</li>
<li>How to Define Custom Ports in Ingress Resources</li>
<li>Configuring NodePort Services for Custom Ports in Kubernetes
Ingress</li>
<li>Using LoadBalancer Services for Custom Ports with Ingress</li>
<li>Using NGINX Ingress Controller for Custom Ports</li>
<li>Frequently Asked Questions</li>
</ul>
<h2
id="understanding-kubernetes-ingress-controllers-and-their-limitations">Understanding
Kubernetes Ingress Controllers and Their Limitations</h2>
<p>Kubernetes Ingress Controllers help us manage how outside users
access services in a Kubernetes cluster. They take care of HTTP and
HTTPS traffic routing. Think of them as a bridge between users on the
internet and our services inside the cluster. Ingress Controllers let us
set rules for routing. They also help with SSL termination and routing
based on host or path.</p>
<h3 id="key-types-of-ingress-controllers">Key Types of Ingress
Controllers</h3>
<ol type="1">
<li><strong>NGINX Ingress Controller</strong>: This is the most popular
controller. It gives many features and supports custom settings.</li>
<li><strong>Traefik</strong>: This is a dynamic reverse proxy. It works
well with Kubernetes and updates its settings automatically when
services change.</li>
<li><strong>HAProxy Ingress</strong>: This one offers great performance
and advanced load balancing options.</li>
</ol>
<h3 id="limitations-of-kubernetes-ingress-controllers">Limitations of
Kubernetes Ingress Controllers</h3>
<ul>
<li><strong>Default Ports</strong>: Ingress Controllers usually listen
on ports 80 (HTTP) and 443 (HTTPS). If we want to use other ports, we
need to do extra work.</li>
<li><strong>Protocol Support</strong>: Most Ingress Controllers mainly
support HTTP and HTTPS. They may not work well with other
protocols.</li>
<li><strong>Load Balancing</strong>: The default load balancing settings
might not fit all applications. We may need to change them to fit our
needs.</li>
<li><strong>Complexity in Configuration</strong>: Setting advanced
routing rules can make things complicated. This can make it harder to
manage.</li>
</ul>
<h3 id="example-nginx-ingress-configuration">Example: NGINX Ingress
Configuration</h3>
<p>To set up an NGINX Ingress Controller with a different port, we need
to change the service definition:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> nginx-ingress-controller</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> LoadBalancer</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> http</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> https</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">8443</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">443</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">app</span><span class="kw">:</span><span class="at"> nginx-ingress</span></span></code></pre></div>
<p>This setup shows the NGINX Ingress Controller on ports 8080 and 8443.
We must make sure our Ingress resources are set up correctly to use
these ports.</p>
<h3 id="considerations">Considerations</h3>
<ul>
<li><strong>Network Policies</strong>: We should set up network
policies. This helps control traffic between services since Ingress
Controllers expose services to the outside.</li>
<li><strong>SSL/TLS Configuration</strong>: For safe connections, we
need to make sure SSL certificates are set up and managed
correctly.</li>
<li><strong>Monitoring &amp; Logging</strong>: We can use tools like
Prometheus and Grafana. They help us watch ingress traffic and logs for
performance and problems.</li>
</ul>
<p>For more information on how to set up Ingress Controllers and learn
about their role in Kubernetes networking, we can check out <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-configure-ingress-for-external-access-to-my-applications.html">how
to configure ingress for external access to applications</a>.</p>
<h2 id="how-to-define-custom-ports-in-ingress-resources">How to Define
Custom Ports in Ingress Resources</h2>
<p>To set custom ports in Kubernetes Ingress resources, we need to tell
the <code>backend</code> service what port we want in our Ingress YAML
file. Ingress helps us create rules to send traffic to different
services based on the requestâ€™s host and path. Here is how we can define
custom ports in our Ingress resource:</p>
<h3 id="example-of-custom-port-configuration">Example of Custom Port
Configuration</h3>
<div class="sourceCode" id="cb2"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> networking.k8s.io/v1</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Ingress</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> custom-port-ingress</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">annotations</span><span class="kw">:</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">nginx.ingress.kubernetes.io/backend-protocol</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;HTTP&quot;</span><span class="co">  # or &quot;HTTPS&quot;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">rules</span><span class="kw">:</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> custom.example.com</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">http</span><span class="kw">:</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">paths</span><span class="kw">:</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">pathType</span><span class="kw">:</span><span class="at"> Prefix</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">backend</span><span class="kw">:</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-service</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">port</span><span class="kw">:</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">number</span><span class="kw">:</span><span class="at"> </span><span class="dv">3000</span><span class="co">  # Custom port</span></span></code></pre></div>
<h3 id="important-considerations">Important Considerations</h3>
<ul>
<li><strong>Ingress Controller Compatibility</strong>: We must check if
our Ingress controller can handle custom ports. Some controllers may
limit which ports can be used.</li>
<li><strong>Firewall Rules</strong>: We need to ensure that any firewall
or network rules let traffic go through the specified custom ports.</li>
<li><strong>Custom Annotations</strong>: Ingress controllers like NGINX
may need special annotations for custom settings or behaviors.</li>
<li><strong>TLS Configuration</strong>: If we use HTTPS, we must set up
TLS settings correctly for ports that are not standard.</li>
</ul>
<h3 id="using-multiple-backends">Using Multiple Backends</h3>
<p>If we want to send traffic to different services on various ports, we
can set up multiple rules or paths in the same Ingress resource:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">rules</span><span class="kw">:</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> custom.example.com</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">http</span><span class="kw">:</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">paths</span><span class="kw">:</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /service1</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">pathType</span><span class="kw">:</span><span class="at"> Prefix</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">backend</span><span class="kw">:</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">name</span><span class="kw">:</span><span class="at"> service1</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">port</span><span class="kw">:</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">number</span><span class="kw">:</span><span class="at"> </span><span class="dv">3000</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /service2</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">pathType</span><span class="kw">:</span><span class="at"> Prefix</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">backend</span><span class="kw">:</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">name</span><span class="kw">:</span><span class="at"> service2</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">port</span><span class="kw">:</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">number</span><span class="kw">:</span><span class="at"> </span><span class="dv">4000</span><span class="co">  # Another custom port</span></span></code></pre></div>
<p>This setup lets us send traffic based on the URL path while using
custom ports for each service.</p>
<h2
id="configuring-nodeport-services-for-custom-ports-in-kubernetes-ingress">Configuring
NodePort Services for Custom Ports in Kubernetes Ingress</h2>
<p>We can expose services on custom ports in Kubernetes by using
NodePort. To do this, we need to define a service of type
<code>NodePort</code> in our Kubernetes manifest. This helps us access
our application through a specific port on the cluster nodes.</p>
<p>Here is a simple YAML configuration for a NodePort service:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-nodeport-service</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> NodePort</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span><span class="co">           # Port that the service listens on</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span><span class="co">       # Port on the container</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">nodePort</span><span class="kw">:</span><span class="at"> </span><span class="dv">30008</span><span class="co">      # Custom port exposed on each node</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span></code></pre></div>
<p>In this configuration: - <code>port</code> is the port that the
service will use inside. - <code>targetPort</code> is the port on the
container where traffic goes. - <code>nodePort</code> is the port that
will open on each node in the cluster. If we do not set a port,
Kubernetes will choose one for us. But we can pick our own custom
port.</p>
<p>To deploy this service, we run the command:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> my-nodeport-service.yaml</span></code></pre></div>
<p>Now we can access our application using
<code>http://&lt;node-ip&gt;:30008</code>. Here,
<code>&lt;node-ip&gt;</code> is the IP address of any node in our
cluster.</p>
<p>To connect this NodePort service with an Ingress controller, we might
need more settings to route traffic the right way. We should check that
our Ingress resources point to the service correctly. This way, external
traffic can go through the chosen NodePort. For more help on setting up
Ingress resources, see <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-configure-ingress-for-external-access-to-my-applications.html">how
to configure ingress for external access to applications</a>.</p>
<h2 id="using-loadbalancer-services-for-custom-ports-with-ingress">Using
LoadBalancer Services for Custom Ports with Ingress</h2>
<p>In Kubernetes, we can set up LoadBalancer services to show our apps
on custom ports with Ingress. This lets us send traffic to our apps on
ports other than the usual HTTP (80) and HTTPS (443) ports.</p>
<p>To set up a LoadBalancer service with custom ports, we can follow
these steps:</p>
<ol type="1">
<li><strong>Define a Service</strong>: We create a Kubernetes Service of
type <code>LoadBalancer</code> that tells the custom port.</li>
</ol>
<div class="sourceCode" id="cb6"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-service</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> LoadBalancer</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span><span class="co">         # Port exposed by the LoadBalancer</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span><span class="co">     # Port on the Pod that gets traffic</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TCP</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span></code></pre></div>
<ol start="2" type="1">
<li><strong>Deploy an Ingress Resource</strong>: We need to create an
Ingress resource to send traffic from the LoadBalancer to our
application. We make sure the Ingress controller can handle the custom
port.</li>
</ol>
<div class="sourceCode" id="cb7"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> networking.k8s.io/v1</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Ingress</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-ingress</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">rules</span><span class="kw">:</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> myapp.example.com</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">http</span><span class="kw">:</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">paths</span><span class="kw">:</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">pathType</span><span class="kw">:</span><span class="at"> Prefix</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">backend</span><span class="kw">:</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-service</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">port</span><span class="kw">:</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">number</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span><span class="co">  # The custom port we set in the Service</span></span></code></pre></div>
<ol start="3" type="1">
<li><p><strong>Deploy the Ingress Controller</strong>: We check that our
cluster has an Ingress controller running, like NGINX or Traefik. This
controller will listen on the LoadBalancerâ€™s IP for traffic that comes
to the host and path we defined.</p></li>
<li><p><strong>Access the Application</strong>: After the LoadBalancer
service is running, we can reach our application by using the
LoadBalancerâ€™s external IP and the custom port we chose.</p></li>
</ol>
<p>If we are using a domain name, we should set up our DNS to point to
the LoadBalancerâ€™s IP.</p>
<p>For more details on Kubernetes Ingress and how to show our
applications well, we can check <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-configure-ingress-for-external-access-to-my-applications.html">this
guide on configuring Ingress for external access</a>.</p>
<h2 id="leveraging-nginx-ingress-controller-for-custom-ports">Leveraging
NGINX Ingress Controller for Custom Ports</h2>
<p>We can use the NGINX Ingress Controller to set up custom ports for
our applications. This is helpful when our apps need ports that are not
the standard HTTP (80) and HTTPS (443).</p>
<p>To set up custom ports with the NGINX Ingress Controller, we follow
these steps:</p>
<ol type="1">
<li><p><strong>Install the NGINX Ingress Controller</strong> if we have
not done it yet:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> repo add ingress-nginx https://kubernetes.github.io/ingress-nginx</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> repo update</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="ex">helm</span> install nginx-ingress ingress-nginx/ingress-nginx</span></code></pre></div></li>
<li><p><strong>Change Ingress Resource</strong> to include custom ports.
We can define a custom backend service in our Ingress YAML file. Here is
an example of an Ingress resource that listens on a custom port (like
8080):</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> networking.k8s.io/v1</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Ingress</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> custom-port-ingress</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">rules</span><span class="kw">:</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> custom.example.com</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">http</span><span class="kw">:</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">paths</span><span class="kw">:</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">pathType</span><span class="kw">:</span><span class="at"> Prefix</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">backend</span><span class="kw">:</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-service</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">port</span><span class="kw">:</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">number</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span></span></code></pre></div></li>
<li><p><strong>Set up NGINX to listen on more ports</strong>. We might
need to change the NGINX config to add our custom ports. We can do this
by updating the ConfigMap for the NGINX Ingress Controller:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> edit configmap nginx-configuration <span class="at">-n</span> ingress-nginx</span></code></pre></div>
<p>We add this config to specify the extra ports:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">  server-snippet</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    listen 8080;</span></code></pre></div></li>
<li><p><strong>Check the configuration</strong>. After we apply our
Ingress resource and update the ConfigMap, we can confirm if the NGINX
Ingress Controller is listening on our custom ports:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get services <span class="at">-n</span> ingress-nginx</span></code></pre></div></li>
<li><p><strong>Testing</strong>. We can access our application through
the custom port using the hostname we set up. For example, if we set our
Ingress like above, we can use:</p>
<pre><code>http://custom.example.com:8080</code></pre></li>
</ol>
<p>This setup helps us use the NGINX Ingress Controller well for routing
traffic to custom ports instead of just the default HTTP and HTTPS
ports. For more details on configuring Ingress resources, we can check
the <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-configure-ingress-for-external-access-to-my-applications.html">Kubernetes
Ingress documentation</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3
id="can-we-use-ports-other-than-80-and-443-for-kubernetes-ingress">1.
Can we use ports other than 80 and 443 for Kubernetes Ingress?</h3>
<p>Yes, we can set custom ports for Kubernetes Ingress. But it depends
on the Ingress controller we are using. Many controllers, like NGINX,
let us define extra ports in our Ingress resource. To do this, we need
to make sure that the Ingress controller listens on those ports for our
services.</p>
<h3 id="what-are-the-limits-of-kubernetes-ingress-controllers">2. What
are the limits of Kubernetes Ingress controllers?</h3>
<p>Kubernetes Ingress controllers have some limits. They cannot handle
TCP/UDP traffic directly. Also, they may have rules about
protocol-specific features. Some controllers might not support custom
ports unless we set them up correctly. Knowing these limits is important
for good Ingress management. It helps us make sure our applications are
reachable.</p>
<h3
id="how-do-we-define-custom-ports-in-kubernetes-ingress-resources">3.
How do we define custom ports in Kubernetes Ingress resources?</h3>
<p>To define custom ports in Kubernetes Ingress resources, we need to
mention the ports in the backend service. We also have to make sure our
Ingress controller is set up to direct traffic on these ports. For
example, when using NGINX, we can define the service port in the Ingress
YAML file. This lets external traffic come to our application through
the chosen ports.</p>
<h3
id="what-is-the-difference-between-nodeport-and-loadbalancer-services-in-kubernetes">4.
What is the difference between NodePort and LoadBalancer services in
Kubernetes?</h3>
<p>NodePort and LoadBalancer services have different uses in Kubernetes.
A NodePort service makes our application available on a fixed port on
each nodeâ€™s IP address. This allows outside access. On the other hand, a
LoadBalancer service uses a cloud providerâ€™s load balancer. It spreads
traffic to our application across many pods. We should choose the right
service type based on our applicationâ€™s setup and how we want to manage
traffic.</p>
<h3 id="how-can-we-use-the-nginx-ingress-controller-for-custom-ports">5.
How can we use the NGINX Ingress Controller for custom ports?</h3>
<p>The NGINX Ingress Controller is easy to set up. We can configure it
to use custom ports. We can change the settings to add new ports in the
NGINX config file or mention these ports in our Ingress resource. This
flexibility lets us direct traffic well through non-standard ports while
keeping our applications working. For more help on setting up NGINX
Ingress, check out our guide on <a
href="https://bestonlinetutorial.com/kubernetes/how-do-i-configure-ingress-for-external-access-to-my-applications.html">how
to configure ingress for external access to my applications</a>.</p>
<p>By answering these common questions about setting custom ports for
Kubernetes Ingress, we hope to give clear help for users who want to
improve their Kubernetes networking setup.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            