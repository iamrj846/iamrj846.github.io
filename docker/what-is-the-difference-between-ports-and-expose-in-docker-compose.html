
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
            <!-- Google tag (gtag.js) -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
            <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-TFCQEJR7TD');
            </script>
            <meta charset="utf-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <!-- Common CSS & Icons -->
            <link rel="icon" href="/favicon.ico" type="image/x-icon">
            <link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
            <link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
            <link rel="stylesheet" href="/assets/css/post.css">
            <title>What Is the Difference Between Ports and Expose in Docker Compose?</title>
            <meta name="description" content="Discover the key differences between 'ports' and 'expose' in Docker Compose to optimize your container networking strategy.">
            <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	        <script src="/assets/js/blog.js"></script>
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">What Is the Difference Between Ports and Expose in Docker Compose?</h1>
                        </header>

                        <div class="blog-post-body">
                            <h1 id="understanding-ports-and-expose-in-docker-compose">Understanding
Ports and Expose in Docker Compose</h1>
<p>We need to know the difference between “ports” and “expose” in Docker
Compose. This is important for good container networking. The “ports”
directive connects container ports to host ports. This way, services can
be reached from outside the container. On the other hand, the “expose”
directive only allows other containers in the same network to use the
ports. It does not let the host access them. This difference helps us
secure our applications and make our Docker setup better.</p>
<p>In this article, we will look closely at the differences between the
“ports” and “expose” directives in Docker Compose. We will talk about
what each one does, how to use them, common misunderstandings, and best
ways to improve our Docker setup. Here are the topics we will
discuss:</p>
<ul>
<li>Understanding the Ports Directive in Docker Compose</li>
<li>Exploring the Expose Directive in Docker Compose</li>
<li>How to Use Ports vs. Expose in Docker Compose</li>
<li>Common Misconceptions About Ports and Expose in Docker Compose</li>
<li>Best Practices for Using Ports and Expose in Docker Compose</li>
<li>Frequently Asked Questions</li>
</ul>
<h2
id="understanding-the-ports-directive-in-docker-compose">Understanding
the Ports Directive in Docker Compose</h2>
<p>In Docker Compose, we use the <code>ports</code> directive to connect
container ports to host ports. This lets outside users access services
that run inside containers. This step is important for helping the host
machine talk to the applications in the containers.</p>
<h3 id="syntax">Syntax</h3>
<p>The basic way to write the <code>ports</code> directive in a
<code>docker-compose.yml</code> file looks like this:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">service_name</span><span class="kw">:</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> image_name</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;host_port:container_port&quot;</span></span></code></pre></div>
<h3 id="example">Example</h3>
<p>Here is an example of how we can use the <code>ports</code>
directive:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;3.8&quot;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">web</span><span class="kw">:</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> nginx</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;8080:80&quot;</span></span></code></pre></div>
<p>In this example, we map port <code>80</code> of the
<code>nginx</code> container to port <code>8080</code> on the host.
Users can reach the web server by going to
<code>http://localhost:8080</code>.</p>
<h3 id="multiple-ports">Multiple Ports</h3>
<p>We can also open many ports by writing them under the
<code>ports</code> section:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;3.8&quot;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">api</span><span class="kw">:</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my_api_image</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;3000:3000&quot;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;3001:3001&quot;</span></span></code></pre></div>
<h3 id="considerations">Considerations</h3>
<ul>
<li>We use the <code>ports</code> directive to expose ports to the host
system. This allows access from outside the Docker network.</li>
<li>Ports need to be in the <code>host_port:container_port</code>
format.</li>
<li>If we leave out the host port (like <code>- "80"</code>), Docker
will pick a random port on the host and link it to port <code>80</code>
in the container.</li>
</ul>
<p>Using the <code>ports</code> directive well helps us let necessary
services be accessible to the outside world. At the same time, it keeps
containerized applications safe and separate. For more about container
ports, check out <a
href="https://bestonlinetutorial.com/docker/what-are-docker-container-ports-and-how-do-they-work.html">What
Are Docker Container Ports and How Do They Work?</a>.</p>
<h2 id="exploring-the-expose-directive-in-docker-compose">Exploring the
Expose Directive in Docker Compose</h2>
<p>We use the <code>expose</code> directive in Docker Compose to show
which ports a service should share with other services in the same
Docker network. It does not share the ports with the host machine.
Instead, it allows other containers to access them. This helps services
talk to each other without letting outside access in.</p>
<h3 id="syntax-1">Syntax</h3>
<p>Here is how we use the <code>expose</code> directive in a
<code>docker-compose.yml</code> file:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3&#39;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">web</span><span class="kw">:</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> nginx</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">expose</span><span class="kw">:</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;80&quot;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;443&quot;</span></span></code></pre></div>
<p>In this example, the <code>web</code> service shares ports 80 and 443
with other services in the same Docker network.</p>
<h3 id="key-points">Key Points</h3>
<ul>
<li><strong>No Host Binding</strong>: The ports that we expose are not
connected to the host’s network.</li>
<li><strong>Inter-Container Communication</strong>: Only linked services
or containers in the same network can reach these ports.</li>
<li><strong>No Security Risks</strong>: Since we do not expose the ports
to the host, we lower security risks that come with outside access.</li>
</ul>
<h3 id="use-case-example">Use Case Example</h3>
<p>Imagine we have several services that need to connect to a database.
We can expose the database’s port without letting the host access
it:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3&#39;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">db</span><span class="kw">:</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> postgres</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">expose</span><span class="kw">:</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;5432&quot;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">app</span><span class="kw">:</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> myapp</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">depends_on</span><span class="kw">:</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> db</span></span></code></pre></div>
<p>In this case, the <code>app</code> service can talk to the
<code>db</code> service through port 5432. The host machine cannot reach
that port.</p>
<h3 id="summary-of-the-expose-directive">Summary of the Expose
Directive</h3>
<ul>
<li>We use <code>expose</code> to show internal service ports.</li>
<li>It makes our setup safer by not sharing ports with the host.</li>
<li>This is great for microservices where containers need to connect
without outside access.</li>
</ul>
<p>For more details on Docker Compose directives, you can check <a
href="https://bestonlinetutorial.com/docker/what-is-docker-compose-and-how-does-it-simplify-multi-container-applications.html">this
guide on Docker Compose</a>.</p>
<h2 id="how-to-use-ports-vs-expose-in-docker-compose">How to Use Ports
vs Expose in Docker Compose</h2>
<p>In Docker Compose, we have <code>ports</code> and
<code>expose</code>. Both help us manage networking but they do
different things.</p>
<h3 id="using-ports">Using <code>ports</code></h3>
<p>The <code>ports</code> directive helps us map container ports to host
ports. This lets people access our service from outside. We use this
when we want to show our service to the public.</p>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3&#39;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">web</span><span class="kw">:</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> nginx</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;8080:80&quot;</span></span></code></pre></div>
<p>In this example, we map port <code>80</code> of the
<code>nginx</code> container to port <code>8080</code> on the host. So
we can reach the web server by going to
<code>http://localhost:8080</code>.</p>
<h3 id="using-expose">Using <code>expose</code></h3>
<p>The <code>expose</code> directive makes ports available to linked
services that are on the same Docker network. It does not publish the
ports to the host. This is only for communication between
containers.</p>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3&#39;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">web</span><span class="kw">:</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> nginx</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">expose</span><span class="kw">:</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;80&quot;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">app</span><span class="kw">:</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> myapp</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">depends_on</span><span class="kw">:</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> web</span></span></code></pre></div>
<p>In this case, the <code>web</code> service exposes port
<code>80</code> to the <code>app</code> service. This allows them to
talk to each other inside the network without showing the port to the
host.</p>
<h3 id="key-differences">Key Differences</h3>
<ul>
<li><strong>Visibility</strong>:
<ul>
<li><code>ports</code>: We can access it from outside the
container.</li>
<li><code>expose</code>: Only other containers on the same network can
access it.</li>
</ul></li>
<li><strong>Use Case</strong>:
<ul>
<li>We use <code>ports</code> when we want to let outside access.</li>
<li>We use <code>expose</code> when we only need containers to talk to
each other.</li>
</ul></li>
</ul>
<p>Knowing how to use <code>ports</code> and <code>expose</code>
properly will help us manage network traffic in our Docker Compose apps.
For more details on Docker networking, check <a
href="https://bestonlinetutorial.com/docker/how-to-expose-ports-in-docker-containers.html">how
to expose ports in Docker containers</a>.</p>
<h2
id="common-misconceptions-about-ports-and-expose-in-docker-compose">Common
Misconceptions About Ports and Expose in Docker Compose</h2>
<p>When we work with Docker Compose, there are many misunderstandings
about the <code>ports</code> and <code>expose</code> parts. These can
create confusion. Here are some common mistakes:</p>
<ol type="1">
<li><p><strong><code>Expose</code> Makes Ports Public</strong>: The
<code>expose</code> part does not make ports open to everyone outside.
It only makes them available for services that are linked in the same
Docker network. For example:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">web</span><span class="kw">:</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-web-app</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">expose</span><span class="kw">:</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;8080&quot;</span></span></code></pre></div>
<p>In this case, port 8080 is only open to other services in the same
network. It is not open to the host.</p></li>
<li><p><strong><code>Ports</code> and <code>Expose</code> Are
Interchangeable</strong>: Both <code>ports</code> and
<code>expose</code> are about networking, but they do different things.
The <code>ports</code> part connects container ports to host ports. This
lets outside access happen. On the other hand, <code>expose</code> just
shows which ports other containers can use.</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">web</span><span class="kw">:</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-web-app</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;8080:80&quot;</span><span class="co">  # Connects host port 8080 to container port 80</span></span></code></pre></div></li>
<li><p><strong>Using <code>Expose</code> Alone Is Sufficient for Service
Communication</strong>: Relying only on <code>expose</code> for services
to talk can be a mistake. If services are not in the same network or
need outside access, we may need other settings.</p></li>
<li><p><strong>All Exposed Ports Must Be Published</strong>: Many think
all ports in <code>expose</code> must be published with
<code>ports</code>. This is not true. We can expose ports without
publishing them. We can use them inside as needed.</p></li>
<li><p><strong>Security Through <code>Expose</code></strong>: Some
people think using <code>expose</code> can keep things safe. But it only
helps with internal notes about ports. We should manage security with
good network settings and firewall rules.</p></li>
<li><p><strong><code>Expose</code> Is Deprecated</strong>: Another wrong
idea is that <code>expose</code> is old and not useful. It is still good
and helps with service discovery and notes in Docker Compose.</p></li>
</ol>
<p>When we understand these mistakes, it helps us see the different jobs
of <code>ports</code> and <code>expose</code> in Docker Compose. This
way, we can set up services and manage networks better. For more
information about Docker networking, check out the article on <a
href="https://bestonlinetutorial.com/docker/what-are-docker-container-ports-and-how-do-they-work.html">Docker
Container Ports</a>.</p>
<h2
id="best-practices-for-using-ports-and-expose-in-docker-compose">Best
Practices for Using Ports and Expose in Docker Compose</h2>
<p>When we work with Docker Compose, it is important to know how to use
the <code>ports</code> and <code>expose</code> commands for container
networking. Here are some best practices to think about:</p>
<ol type="1">
<li><strong>Use <code>ports</code> for External Access</strong>:
<ul>
<li><p>We should use the <code>ports</code> command when we need to let
outside users access our application in a container. This is good for
web apps or APIs.</p></li>
<li><p>Example:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3&#39;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">web</span><span class="kw">:</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> nginx</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;8080:80&quot;</span></span></code></pre></div></li>
<li><p>This connects port 80 in the container to port 8080 on the
host.</p></li>
</ul></li>
<li><strong>Use <code>expose</code> for Internal Communication</strong>:
<ul>
<li><p>We can use the <code>expose</code> command for services that talk
to each other inside the Docker network. This does not share the port
with the host.</p></li>
<li><p>Example:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3&#39;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">app</span><span class="kw">:</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> myapp</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">expose</span><span class="kw">:</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;3000&quot;</span></span></code></pre></div></li>
<li><p>This lets other containers in the same network reach the
application on port 3000.</p></li>
</ul></li>
<li><strong>Avoid Port Conflicts</strong>:
<ul>
<li>When we use <code>ports</code>, we need to make sure the host ports
do not clash with other services on the host. This can stop the
container from starting.</li>
<li>We should always check which ports are being used on our host
machine.</li>
</ul></li>
<li><strong>Document Port Usage</strong>:
<ul>
<li>We must clearly comment and write down which ports each service uses
in our <code>docker-compose.yml</code>. This helps us maintain the code
and helps other developers understand it better.</li>
</ul></li>
<li><strong>Use Networks for Isolation</strong>:
<ul>
<li><p>We should think about making custom networks in our Docker
Compose file to keep services that should not talk to each other
separate. This makes things safer and stops unwanted
interactions.</p></li>
<li><p>Example:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3&#39;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">db</span><span class="kw">:</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> postgres</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> backend</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">app</span><span class="kw">:</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> myapp</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> frontend</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">frontend</span><span class="kw">:</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">backend</span><span class="kw">:</span></span></code></pre></div></li>
</ul></li>
<li><strong>Utilize Environment Variables</strong>:
<ul>
<li><p>We can use environment variables to set port bindings easily.
This makes it more flexible for different environments.</p></li>
<li><p>Example:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3&#39;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">web</span><span class="kw">:</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> nginx</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;${WEB_PORT}:80&quot;</span></span></code></pre></div></li>
</ul></li>
<li><strong>Minimize Use of <code>ports</code></strong>:
<ul>
<li>We should only open ports that we really need for outside access.
Each port we expose can be a risk, so using fewer of them helps keep
things safe.</li>
</ul></li>
<li><strong>Combine with Health Checks</strong>:
<ul>
<li><p>We can add health checks for our services to make sure they are
okay and ready before they start getting traffic. This is very helpful
when we use <code>ports</code> for outside services.</p></li>
<li><p>Example:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3&#39;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">web</span><span class="kw">:</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> nginx</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;8080:80&quot;</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">healthcheck</span><span class="kw">:</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">test</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">&quot;CMD&quot;</span><span class="kw">,</span><span class="at"> </span><span class="st">&quot;curl&quot;</span><span class="kw">,</span><span class="at"> </span><span class="st">&quot;-f&quot;</span><span class="kw">,</span><span class="at"> </span><span class="st">&quot;http://localhost&quot;</span><span class="kw">]</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">interval</span><span class="kw">:</span><span class="at"> 30s</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">timeout</span><span class="kw">:</span><span class="at"> 10s</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">retries</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span></code></pre></div></li>
</ul></li>
</ol>
<p>By following these best practices, we can manage <code>ports</code>
and <code>expose</code> in Docker Compose better. This also helps keep
our container applications secure and functional. For more info about
Docker networking, we can check out <a
href="https://bestonlinetutorial.com/docker/what-are-docker-networks-and-why-are-they-necessary.html">what
are Docker networks and why are they necessary</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3
id="what-is-the-difference-between-ports-and-expose-in-docker-compose">What
is the difference between <code>ports</code> and <code>expose</code> in
Docker Compose?</h3>
<p>The main difference between <code>ports</code> and
<code>expose</code> in Docker Compose is about how they work. The
<code>ports</code> directive connects container ports to the host
machine. This allows outside access. On the other hand,
<code>expose</code> only lets linked services inside the Docker network
access the ports. We need to know these differences to manage Docker
container communication well.</p>
<h3 id="can-i-use-both-ports-and-expose-together-in-docker-compose">Can
I use both <code>ports</code> and <code>expose</code> together in Docker
Compose?</h3>
<p>Yes, we can use both <code>ports</code> and <code>expose</code> in a
Docker Compose file. The <code>expose</code> directive is for
communication between services inside. The <code>ports</code> directive
lets external users access those ports. This is helpful when we want to
keep some internal services private but still allow public access when
needed.</p>
<h3
id="how-do-i-specify-multiple-ports-using-the-ports-directive-in-docker-compose">How
do I specify multiple ports using the <code>ports</code> directive in
Docker Compose?</h3>
<p>To set multiple ports in the <code>ports</code> directive of a Docker
Compose file, we can list them with commas. For example:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">my_service</span><span class="kw">:</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my_image</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;8080:80&quot;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;8443:443&quot;</span></span></code></pre></div>
<p>This setup connects port 80 and 443 of the container to ports 8080
and 8443 on the host.</p>
<h3
id="are-ports-and-expose-directives-affected-by-docker-networking">Are
<code>ports</code> and <code>expose</code> directives affected by Docker
networking?</h3>
<p>Yes, both <code>ports</code> and <code>expose</code> are affected by
Docker networking. The <code>expose</code> directive makes the ports
available to other containers in the same network. The
<code>ports</code> directive allows access from the host and external
networks. We need to understand Docker networking for good communication
between containers.</p>
<h3
id="what-are-some-common-misconceptions-about-expose-in-docker-compose">What
are some common misconceptions about <code>expose</code> in Docker
Compose?</h3>
<p>Many people think the <code>expose</code> directive opens ports for
external access like <code>ports</code> does. But this is not true. The
<code>expose</code> directive only makes ports accessible to other
containers in the same network. It does not allow access from the host.
Knowing this difference is important for good Docker Compose setups.</p>
<p>For more information about Docker and its functions, check out this
article on <a
href="https://bestonlinetutorial.com/docker/how-to-expose-ports-in-docker-containers.html">how
to expose ports in Docker containers</a> or look at <a
href="https://bestonlinetutorial.com/docker/what-is-docker-compose-and-how-does-it-simplify-multi-container-applications.html">Docker
Compose and its features</a>.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            