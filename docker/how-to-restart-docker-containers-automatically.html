
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TFCQEJR7TD');
</script>
            <title>How to Restart Docker Containers Automatically?</title>
            <meta name="description" content="Learn how to restart Docker containers automatically with our step-by-step guide. Optimize your workflow effortlessly!">

            
            <script src="/assets/js/blog.js" defer></script>
            <link rel="stylesheet" href="/assets/css/post.css">
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">How to Restart Docker Containers Automatically?</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>Restarting Docker containers automatically is very important for
managing container apps. It helps to keep services running without us
needing to do it by hand. This is especially helpful in production
places. If we have downtime, it can cause big losses.</p>
<p>In this article, we will look at some key topics about automatically
restarting Docker containers. We will see how we can restart Docker
containers automatically. We will also talk about the different Docker
restart policies and how to set them when we create containers. Also, we
will learn how to change restart policies for containers we already
have. We will check how to monitor Docker containers for automatic
restarts. Finally, we will see how to use Docker Compose for automatic
restarts. This guide will help us improve our Docker container
management.</p>
<ul>
<li>How Can You Automatically Restart Docker Containers?</li>
<li>What Are Docker Restart Policies?</li>
<li>How to Set Restart Policies When Creating Containers?</li>
<li>How to Update Restart Policies for Existing Containers?</li>
<li>How to Monitor Docker Containers for Automatic Restarts?</li>
<li>How to Use Docker Compose for Automatic Restarts?</li>
<li>Frequently Asked Questions</li>
</ul>
<h2 id="what-are-docker-restart-policies">What Are Docker Restart
Policies?</h2>
<p>Docker restart policies are rules that tell how a Docker container
should act when it stops. These rules help containers restart
automatically based on certain conditions. This makes our applications
more reliable when they run in Docker containers. Docker gives us
different restart policy options:</p>
<ul>
<li><strong>No</strong>: This is the default. The container will not
restart on its own.</li>
<li><strong>Always</strong>: The container will always restart unless we
stop it. This is good for containers that need to run all the time.</li>
<li><strong>Unless-stopped</strong>: This is like “always,” but it will
not restart if we stopped the container on purpose.</li>
<li><strong>On-failure</strong>: The container will restart only if it
stops with an error. We can set a maximum number of tries. For example,
<code>on-failure:5</code> lets it restart up to 5 times before it gives
up.</li>
</ul>
<p>We can set these policies when we create a container using the
<code>--restart</code> flag in the <code>docker run</code> command:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">--restart</span><span class="op">=</span>always your_image_name</span></code></pre></div>
<p>To see the restart policy of a container that already exists, we can
use:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> inspect <span class="at">-f</span> <span class="st">&#39;{{ .HostConfig.RestartPolicy.Name }}&#39;</span> container_id</span></code></pre></div>
<p>These policies help keep our applications running and manage how
containers work in a Docker environment. For more information on
controlling Docker containers, check out <a
href="https://bestonlinetutorial.com/docker/how-to-stop-and-start-docker-containers.html">how
to stop and start Docker containers</a>.</p>
<h2 id="how-to-set-restart-policies-when-creating-containers">How to Set
Restart Policies When Creating Containers?</h2>
<p>To make Docker containers restart automatically, we can set restart
policies when we create them. We do this by using the
<code>--restart</code> flag with the <code>docker run</code> command.
This way, our containers can restart based on certain conditions without
us having to do anything.</p>
<h3 id="restart-policy-options">Restart Policy Options</h3>
<p>Docker has some restart policies we can choose from:</p>
<ul>
<li><strong>no</strong>: This means the container will not restart
automatically. This is the default option.</li>
<li><strong>always</strong>: This means the container will always
restart if it stops.</li>
<li><strong>unless-stopped</strong>: This means it will restart unless
we stop it manually.</li>
<li><strong>on-failure[:max-retries]</strong>: This means the container
will restart only if it stops with an error. We can also set a max
number of times it can try to restart.</li>
</ul>
<h3 id="example-command">Example Command</h3>
<p>Here is how we can set different restart policies when we create a
container:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Always restart the container</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">--restart</span> always <span class="at">-d</span> my-image</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Restart only on failure, with a maximum of 5 retries</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">--restart</span> on-failure:5 <span class="at">-d</span> my-image</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Restart unless stopped</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">--restart</span> unless-stopped <span class="at">-d</span> my-image</span></code></pre></div>
<h3 id="additional-notes">Additional Notes</h3>
<p>The restart policy can help keep services running in production
environments.</p>
<p>We can check the restart policy of a running container by using this
command:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> inspect <span class="at">-f</span> <span class="st">&quot;{{ .HostConfig.RestartPolicy }}&quot;</span> container_name_or_id</span></code></pre></div>
<p>By setting the restart policies right, we can make our Docker
applications more strong.</p>
<h2 id="how-to-update-restart-policies-for-existing-containers">How to
Update Restart Policies for Existing Containers?</h2>
<p>We can update the restart policies for existing Docker containers
using the <code>docker update</code> command. This command helps us
change the restart policy of a running or stopped container. We do not
need to recreate the container.</p>
<h3 id="syntax">Syntax</h3>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> update <span class="at">--restart</span> <span class="op">&lt;</span>policy<span class="op">&gt;</span> <span class="op">&lt;</span>container_name_or_id<span class="op">&gt;</span></span></code></pre></div>
<h3 id="restart-policy-options-1">Restart Policy Options</h3>
<ul>
<li><code>no</code>: It means do not restart the container
automatically.</li>
<li><code>always</code>: This means always restart the container if it
stops.</li>
<li><code>unless-stopped</code>: Restart the container unless we stop it
manually.</li>
<li><code>on-failure</code>: Restart the container only if it stops with
a non-zero status. We can set a maximum retry count.</li>
</ul>
<h3 id="examples">Examples</h3>
<ol type="1">
<li><p><strong>Set the restart policy to always</strong>:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> update <span class="at">--restart</span> always my_container</span></code></pre></div></li>
<li><p><strong>Set the restart policy to on-failure with a maximum of 5
retries</strong>:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> update <span class="at">--restart</span> on-failure:5 my_container</span></code></pre></div></li>
<li><p><strong>Disable the restart policy</strong>:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> update <span class="at">--restart</span> no my_container</span></code></pre></div></li>
</ol>
<h3 id="verify-changes">Verify Changes</h3>
<p>To check that the restart policy was updated, we can inspect the
container using this command:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> inspect <span class="at">-f</span> <span class="st">&#39;{{ .HostConfig.RestartPolicy.Name }}&#39;</span> my_container</span></code></pre></div>
<p>This command shows the current restart policy for the specified
container. If we want more details about the container, we can use:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> inspect my_container</span></code></pre></div>
<p>This helps us confirm that the changes are successful. For more help
on managing Docker containers, we can look at <a
href="https://bestonlinetutorial.com/docker/how-to-stop-and-start-docker-containers.html">how
to stop and start Docker containers</a>.</p>
<h2 id="how-to-monitor-docker-containers-for-automatic-restarts">How to
Monitor Docker Containers for Automatic Restarts?</h2>
<p>To monitor Docker containers for automatic restarts, we can use some
simple techniques and tools. These help us check their status and make
sure they work well.</p>
<ol type="1">
<li><p><strong>Docker Logs</strong>: We can use the Docker logs command
to see the output from our containers. This helps us find out if a
container is restarting a lot because of errors.</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> logs <span class="op">&lt;</span>container_id<span class="op">&gt;</span></span></code></pre></div></li>
<li><p><strong>Docker Events</strong>: We can watch Docker events to
know when containers start and stop. This gives us real-time views of
what is happening with the containers.</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> events <span class="at">--filter</span> <span class="st">&#39;event=start&#39;</span> <span class="at">--filter</span> <span class="st">&#39;event=die&#39;</span></span></code></pre></div></li>
<li><p><strong>Docker Stats</strong>: The <code>docker stats</code>
command helps us check the performance of running containers. This can
show us problems that might cause restarts.</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> stats</span></code></pre></div></li>
<li><p><strong>Health Checks</strong>: We can set up health checks in
our Docker containers. This way, they restart automatically if they
become unhealthy.</p>
<p>Example Dockerfile snippet:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">HEALTHCHECK</span> <span class="kw">CMD</span> <span class="ex">curl</span> <span class="at">--fail</span> http://localhost/ <span class="kw">||</span> <span class="bu">exit</span> 1</span></code></pre></div></li>
<li><p><strong>Third-Party Monitoring Tools</strong>: We can use tools
like Prometheus, Grafana, or Datadog. These provide deep insights and
alerts when containers restart.</p></li>
<li><p><strong>System Resource Monitoring</strong>: We should check
system resources like CPU, memory, and disk I/O where Docker runs. This
tells us if resource limits cause restarts.</p></li>
<li><p><strong>Log Management Solutions</strong>: Using log management
systems like ELK Stack can help collect logs. We can then analyze
restart patterns over time.</p></li>
</ol>
<p>By using these monitoring strategies, we can track Docker containers
and their automatic restarts. This helps us keep our applications
available and reliable.</p>
<h2 id="how-to-use-docker-compose-for-automatic-restarts">How to Use
Docker Compose for Automatic Restarts?</h2>
<p>Docker Compose makes it easy to manage Docker containers and
services. It also helps us set up automatic restarts. We can tell Docker
how to restart containers in the <code>docker-compose.yml</code>
file.</p>
<p>To set up automatic restarts, we use the <code>restart</code> key in
our service definition. Here is a simple example:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3.8&#39;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">my_service</span><span class="kw">:</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my_image:latest</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">restart</span><span class="kw">:</span><span class="at"> always</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;80:80&quot;</span></span></code></pre></div>
<h3 id="restart-policy-options-2">Restart Policy Options</h3>
<p>We can pick from different restart policies:</p>
<ul>
<li><code>no</code>: Do not restart the container automatically. This is
the default option.</li>
<li><code>always</code>: Restart the container every time it stops.</li>
<li><code>unless-stopped</code>: Restart the container unless we stop it
manually.</li>
<li><code>on-failure</code>: Restart the container if it fails with a
non-zero status. We can also set a maximum number of retry
attempts:</li>
</ul>
<div class="sourceCode" id="cb16"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">restart</span><span class="kw">:</span><span class="at"> on-failure:5</span></span></code></pre></div>
<h3 id="deploying-with-docker-compose">Deploying with Docker
Compose</h3>
<p>Once we write our <code>docker-compose.yml</code> file, we can deploy
our services with this command:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker-compose</span> up <span class="at">-d</span></span></code></pre></div>
<p>This command starts our containers in detached mode. The restart
policies we set will work now.</p>
<h3 id="monitoring-and-updating">Monitoring and Updating</h3>
<p>To check the status of our services and see if they are restarting
correctly, we use:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker-compose</span> ps</span></code></pre></div>
<p>If we want to change the restart policy for a service, we change the
<code>docker-compose.yml</code> file. Then we redeploy with:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker-compose</span> up <span class="at">-d</span></span></code></pre></div>
<p>By using Docker Compose for automatic restarts, we can make our
applications in containers more reliable.</p>
<p>For more details about Docker and its features, we can look at this
article on <a
href="https://bestonlinetutorial.com/docker/what-is-a-docker-container-s-lifecycle.html">Docker
container lifecycle</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3 id="how-do-docker-restart-policies-work">1. How do Docker restart
policies work?</h3>
<p>Docker restart policies help us set how Docker containers act when
they stop. We can choose policies like <code>always</code>,
<code>unless-stopped</code>, or <code>on-failure</code>. This way, our
containers restart by themselves under certain situations. This feature
is very important for keeping our applications running and making them
more reliable.</p>
<h3
id="can-i-change-the-restart-policy-of-a-running-docker-container">2.
Can I change the restart policy of a running Docker container?</h3>
<p>Yes, we can change the restart policy of a Docker container that is
already running by using the <code>docker update</code> command. For
example, to make a container restart always, we can write:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> update <span class="at">--restart</span> always <span class="op">&lt;</span>container_name<span class="op">&gt;</span></span></code></pre></div>
<p>This helps us change how our container works without having to create
it again. It makes managing easier.</p>
<h3 id="what-is-the-default-restart-policy-for-docker-containers">3.
What is the default restart policy for Docker containers?</h3>
<p>By default, Docker containers do not have a restart policy. This
means they will not restart automatically when they stop. If we want our
containers to restart by themselves, we have to set a restart policy
when we create the container using the <code>--restart</code> flag.</p>
<h3 id="how-can-i-monitor-docker-containers-for-automatic-restarts">4.
How can I monitor Docker containers for automatic restarts?</h3>
<p>We can monitor Docker containers with the <code>docker ps</code>
command. This lets us check their status. We can also use the
<code>docker logs</code> command to see the logs. There are tools like
Prometheus or Grafana that can give us more details about container
restarts and health. This helps us watch performance and solve problems
better.</p>
<h3 id="is-it-possible-to-use-docker-compose-for-automatic-restarts">5.
Is it possible to use Docker Compose for automatic restarts?</h3>
<p>Yes, Docker Compose lets us set restart policies for our services
right in the <code>docker-compose.yml</code> file. We can say the
restart policy for each service under the <code>deploy</code> section.
This makes it easy to control container behavior in a setup with many
containers. For example:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">myservice</span><span class="kw">:</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> myimage</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">restart</span><span class="kw">:</span><span class="at"> always</span></span></code></pre></div>
<p>This makes sure our services restart automatically when needed.</p>
<p>For more insights into Docker’s function, check out <a
href="https://bestonlinetutorial.com/docker/what-is-docker-and-why-should-you-use-it.html">What
is Docker and Why Should You Use It?</a> or learn about <a
href="https://bestonlinetutorial.com/docker/what-is-a-docker-container-s-lifecycle.html">Docker
Container Lifecycle</a> to understand better how to manage your Docker
containers.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            