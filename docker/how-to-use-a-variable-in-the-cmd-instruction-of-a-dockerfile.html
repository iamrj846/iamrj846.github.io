
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
            <!-- Google tag (gtag.js) -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
            <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-TFCQEJR7TD');
            </script>
            <meta charset="utf-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <!-- Common CSS & Icons -->
            <link rel="icon" href="/favicon.ico" type="image/x-icon">
            <link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
            <link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
            <link rel="stylesheet" href="/assets/css/post.css">
            <title>How to Use a Variable in the CMD Instruction of a Dockerfile?</title>
            <meta name="description" content="Learn how to effectively use variables in CMD instructions within a Dockerfile to optimize your container builds and processes.">
            <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	        <script src="/assets/js/blog.js"></script>
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">How to Use a Variable in the CMD Instruction of a Dockerfile?</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>To use a variable in the CMD instruction of a Dockerfile, we can use
environment variables that we declare in the Dockerfile. We use the
<code>ENV</code> command to set these variables. Then, we can reference
them in the CMD instruction. This helps us create flexible and
easy-to-manage Docker containers.</p>
<p>In this article, we will look at different parts of using variables
in the CMD instruction of a Dockerfile. We will talk about what the CMD
instruction does. We will also explain how to declare and use
environment variables. We will learn about ARG variables and how to pass
variables at runtime with Docker Compose. Lastly, we will share best
practices for using variables in CMD and answer some common questions
about this topic.</p>
<ul>
<li>Understanding the CMD Instruction in a Dockerfile</li>
<li>How to Declare and Use Environment Variables in a Dockerfile</li>
<li>Using ARG Variables in the CMD Instruction of a Dockerfile</li>
<li>How to Pass Variables at Runtime with Docker Compose</li>
<li>Best Practices for Using Variables in the CMD Instruction of a
Dockerfile</li>
<li>Frequently Asked Questions</li>
</ul>
<h2 id="understanding-the-cmd-instruction-in-a-dockerfile">Understanding
the CMD Instruction in a Dockerfile</h2>
<p>The CMD instruction in a Dockerfile tells us the default command to
run when we start a container from the built image. It helps us decide
which command should run. We can change this command when we run the
container. The CMD instruction has three forms.</p>
<ol type="1">
<li><p><strong>Exec form</strong>: This is the best choice because it is
simple and runs directly without a shell.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;executable&quot;</span>, <span class="st">&quot;param1&quot;</span>, <span class="st">&quot;param2&quot;</span>]</span></code></pre></div></li>
<li><p><strong>Shell form</strong>: This runs the command in a shell. It
allows us to use features like command chaining or changing environment
variables.</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> <span class="ex">executable</span> param1 param2</span></code></pre></div></li>
<li><p><strong>Default parameters</strong>: If we use CMD in the form of
an array, it can give default parameters to an ENTRYPOINT
instruction.</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;param1&quot;</span>, <span class="st">&quot;param2&quot;</span>]</span></code></pre></div></li>
</ol>
<p>We can only use the CMD instruction once in a Dockerfile. If we write
it more than once, only the last one will work. Also, remember that CMD
does not run during the build process. It only runs when we start a
container.</p>
<p>To see how CMD works with other instructions in a Dockerfile, we can
use it with ENTRYPOINT for more complex cases.</p>
<p>For more information about how Docker handles commands, we can check
the <a
href="https://bestonlinetutorial.com/docker/what-are-the-key-differences-between-cmd-and-entrypoint-in-a-dockerfile.html">key
differences between CMD and ENTRYPOINT</a> in a Dockerfile.</p>
<h2
id="how-to-declare-and-use-environment-variables-in-a-dockerfile">How to
Declare and Use Environment Variables in a Dockerfile</h2>
<p>In a Dockerfile, we can declare and use environment variables with
the <code>ENV</code> instruction. These variables are available for any
command that runs in the container while building and during runtime.
Letâ€™s see how to do this.</p>
<h3 id="declaring-environment-variables">Declaring Environment
Variables</h3>
<p>To declare environment variables, we use the <code>ENV</code>
instruction. After that, we write the variable name and its value.</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> ubuntu:20.04</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Declare environment variables</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">ENV</span> APP_ENV=production</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="kw">ENV</span> APP_PORT=8080</span></code></pre></div>
<h3 id="using-environment-variables">Using Environment Variables</h3>
<p>We can use the declared environment variables in later instructions
like <code>RUN</code>, <code>CMD</code>, or <code>ENTRYPOINT</code>.
Here is an example of how to use a variable in a command:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use environment variable in a command</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;echo&quot;</span>, <span class="st">&quot;The application is running in $APP_ENV mode on port $APP_PORT&quot;</span>]</span></code></pre></div>
<h3 id="accessing-variables-in-scripts">Accessing Variables in
Scripts</h3>
<p>If our application needs environment variables in a script, we can
access them using the normal way:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Accessing environment variables in a script</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Running in environment: </span><span class="va">$APP_ENV</span><span class="st">&quot;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Listening on port: </span><span class="va">$APP_PORT</span><span class="st">&quot;</span></span></code></pre></div>
<h3 id="example-dockerfile">Example Dockerfile</h3>
<p>Here is a full example of a Dockerfile that declares and uses
environment variables:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> ubuntu:20.04</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Declare environment variables</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="kw">ENV</span> APP_ENV=production</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="kw">ENV</span> APP_PORT=8080</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy script into the container</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> start.sh /usr/local/bin/start.sh</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="fu">chmod</span> +x /usr/local/bin/start.sh</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the script as the entrypoint</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;/usr/local/bin/start.sh&quot;</span>]</span></code></pre></div>
<h3 id="best-practices">Best Practices</h3>
<ul>
<li>Use uppercase letters for variable names. This helps to see them
easily.</li>
<li>Remember the scope. Environment variables with <code>ENV</code> are
available at runtime, but they might make the image bigger.</li>
<li>Think about using <code>.env</code> files with Docker Compose. This
helps manage environment variables across different services.</li>
</ul>
<p>For more information on Docker and its practices, we can check out <a
href="https://bestonlinetutorial.com/docker/how-can-you-use-environment-variables-in-cmd-with-docker.html">this
article on using environment variables in CMD with Docker</a>.</p>
<h2
id="using-arg-variables-in-the-cmd-instruction-of-a-dockerfile">Using
ARG Variables in the CMD Instruction of a Dockerfile</h2>
<p>In a Dockerfile, we can use <code>ARG</code> variables. These let us
set variables that we can pass when we build. We can use these variables
in the <code>CMD</code> instruction. This helps us customize the command
that runs when we start a container. It is helpful when we want to build
images with different setups or options.</p>
<p>To use <code>ARG</code> variables in the <code>CMD</code>
instruction, we can follow some simple steps:</p>
<ol type="1">
<li><p><strong>Declare the ARG Variable</strong>: We start by using the
<code>ARG</code> keyword in our Dockerfile to set a variable.</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ARG</span> MY_VAR=default_value</span></code></pre></div></li>
<li><p><strong>Use the ARG Variable</strong>: Next, we can use this
variable in the <code>CMD</code> instruction with shell form.</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;sh&quot;</span>, <span class="st">&quot;-c&quot;</span>, <span class="st">&quot;echo ${MY_VAR}&quot;</span>]</span></code></pre></div></li>
<li><p><strong>Build the Docker Image</strong>: When we build the Docker
image, we can change the default value of <code>MY_VAR</code> by using
the <code>--build-arg</code> flag.</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> build <span class="at">--build-arg</span> MY_VAR=value_you_want <span class="at">-t</span> my_image .</span></code></pre></div></li>
<li><p><strong>Run the Container</strong>: After building the image, we
run a container from it. The command in the <code>CMD</code> instruction
will run with the value of <code>MY_VAR</code>.</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run my_image</span></code></pre></div></li>
</ol>
<h3 id="example-dockerfile-1">Example Dockerfile</h3>
<p>Here is a complete example Dockerfile that shows the steps we talked
about:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Start from a base image</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> alpine:latest</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Declare ARG variable</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="kw">ARG</span> MY_VAR=default_value</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the ARG variable in CMD</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;sh&quot;</span>, <span class="st">&quot;-c&quot;</span>, <span class="st">&quot;echo ${MY_VAR}&quot;</span>]</span></code></pre></div>
<h3 id="building-and-running-the-example">Building and Running the
Example</h3>
<p>To build and run the Dockerfile above:</p>
<ol type="1">
<li><p>Build the image:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> build <span class="at">--build-arg</span> MY_VAR=HelloWorld <span class="at">-t</span> my_echo_image .</span></code></pre></div></li>
<li><p>Run the container:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run my_echo_image</span></code></pre></div></li>
</ol>
<p>This will show:</p>
<pre><code>HelloWorld</code></pre>
<p>Using <code>ARG</code> variables in the <code>CMD</code> instruction
helps us create flexible and dynamic container setups. It makes our
Docker images more useful. For more information about environment
variables in Docker, we can check <a
href="https://bestonlinetutorial.com/docker/how-can-i-pass-environment-variables-to-docker-containers.html">this
article</a>.</p>
<h2 id="how-to-pass-variables-at-runtime-with-docker-compose">How to
Pass Variables at Runtime with Docker Compose</h2>
<p>To pass variables at runtime in Docker Compose, we can use
environment variables. We can define these variables in our
<code>.env</code> file or right in the <code>docker-compose.yml</code>
file. This helps us change our services based on where they run.</p>
<h3 id="using-a-.env-file">Using a <code>.env</code> File</h3>
<ol type="1">
<li><p>First, we create a <code>.env</code> file in the same folder as
our <code>docker-compose.yml</code> file:</p>
<pre class="plaintext"><code>DB_HOST=database
DB_PORT=5432
DB_USER=user
DB_PASSWORD=securepassword</code></pre></li>
<li><p>Next, we reference these variables in our
<code>docker-compose.yml</code> file:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3.8&#39;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">web</span><span class="kw">:</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-web-app</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> DB_HOST=${DB_HOST}</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> DB_PORT=${DB_PORT}</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> DB_USER=${DB_USER}</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> DB_PASSWORD=${DB_PASSWORD}</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;8080:80&quot;</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">database</span><span class="kw">:</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> postgres</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">POSTGRES_USER</span><span class="kw">:</span><span class="at"> ${DB_USER}</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">POSTGRES_PASSWORD</span><span class="kw">:</span><span class="at"> ${DB_PASSWORD}</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">POSTGRES_DB</span><span class="kw">:</span><span class="at"> mydatabase</span></span></code></pre></div></li>
</ol>
<h3 id="passing-variables-directly-in-docker-compose.yml">Passing
Variables Directly in <code>docker-compose.yml</code></h3>
<p>We can also set environment variables directly in our
<code>docker-compose.yml</code> file:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3.8&#39;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">web</span><span class="kw">:</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-web-app</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">DB_HOST</span><span class="kw">:</span><span class="at"> database</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">DB_PORT</span><span class="kw">:</span><span class="at"> </span><span class="dv">5432</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">DB_USER</span><span class="kw">:</span><span class="at"> user</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">DB_PASSWORD</span><span class="kw">:</span><span class="at"> securepassword</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;8080:80&quot;</span></span></code></pre></div>
<h3 id="overriding-variables-at-runtime">Overriding Variables at
Runtime</h3>
<p>We can change the variables from our <code>.env</code> file or
<code>docker-compose.yml</code> by passing them in the command line when
we run Docker Compose:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="va">DB_PASSWORD</span><span class="op">=</span>mynewpassword <span class="ex">docker-compose</span> up</span></code></pre></div>
<h3 id="using-docker-compose-with-cli-variables">Using Docker Compose
with CLI Variables</h3>
<p>We can also use <code>docker-compose</code> commands to pass
variables directly:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker-compose</span> up <span class="at">-d</span> <span class="at">--build</span> <span class="at">--env-file</span> .env</span></code></pre></div>
<p>This command makes sure that our Docker Compose uses the environment
variables from the <code>.env</code> file we specified.</p>
<h3 id="conclusion">Conclusion</h3>
<p>Using environment variables in Docker Compose helps us manage our
settings easily. It also makes things more secure by keeping sensitive
information out of our <code>docker-compose.yml</code>. For more details
on managing environment variables in Docker, you can check <a
href="https://bestonlinetutorial.com/docker/how-can-i-use-docker-environment-variables-in-the-entrypoint-array.html">this
article</a>.</p>
<h2
id="best-practices-for-using-variables-in-the-cmd-instruction-of-a-dockerfile">Best
Practices for Using Variables in the CMD Instruction of a
Dockerfile</h2>
<p>When we use variables in the <code>CMD</code> instruction of a
Dockerfile, it is important to follow good practices. This helps us keep
things flexible, easy to maintain, and clear. Here are some key
points:</p>
<ul>
<li><p><strong>Use Environment Variables</strong>: We should use
environment variables for values that can change depending on where we
deploy. This lets us set up the application without changing the
Dockerfile.</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ENV</span> MY_APP_PORT=8080</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;node&quot;</span>, <span class="st">&quot;app.js&quot;</span>, <span class="st">&quot;--port&quot;</span>, <span class="st">&quot;$MY_APP_PORT&quot;</span>]</span></code></pre></div></li>
<li><p><strong>Use ARG for Build-time Variables</strong>: If we need a
variable only when we build, we should use <code>ARG</code> instead of
<code>ENV</code>. This keeps the scope limited and helps not pollute the
container environment.</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ARG</span> NODE_ENV=production</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;npm&quot;</span>, <span class="st">&quot;start&quot;</span>, <span class="st">&quot;--&quot;</span>, <span class="st">&quot;--env&quot;</span>, <span class="st">&quot;$NODE_ENV&quot;</span>]</span></code></pre></div></li>
<li><p><strong>Avoid Hardcoding Values</strong>: We should not hardcode
values directly in the <code>CMD</code> instruction. Instead, we can
reference variables. This makes updates easier.</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;python&quot;</span>, <span class="st">&quot;app.py&quot;</span>, <span class="st">&quot;--config&quot;</span>, <span class="st">&quot;/configs/$CONFIG_FILE&quot;</span>]</span></code></pre></div></li>
<li><p><strong>Use Shell Form for Variable Expansion</strong>: If we
need to use shell form (which is a single string), shell features like
variable expansion will work fine.</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> <span class="ex">my_command</span> <span class="at">--option</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$MY_VARIABLE</span><span class="st">&quot;</span></span></code></pre></div></li>
<li><p><strong>Check for Undefined Variables</strong>: We need to make
sure our variables are defined. We can use conditional logic or defaults
to handle cases when a variable is not set correctly.</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ENV</span> MY_VAR=${MY_VAR:-default_value}</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;some_command&quot;</span>, <span class="st">&quot;$MY_VAR&quot;</span>]</span></code></pre></div></li>
<li><p><strong>Keep CMD Simple</strong>: The <code>CMD</code>
instruction should be simple. If we have complex logic, it is better to
put that in scripts or in the application itself instead of in the
Dockerfile.</p></li>
<li><p><strong>Document Variable Usage</strong>: We should clearly
document what each variable does and what values we expect. This helps
others understand our work better.</p></li>
</ul>
<p>By following these best practices, we can manage variables in the
<code>CMD</code> instruction of our Dockerfile better. This way, our
Docker images will be flexible and easy to maintain. For more tips on
Docker best practices, check out <a
href="https://bestonlinetutorial.com/docker/how-can-i-pass-environment-variables-to-docker-containers.html">this
article on Docker environment variables</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3
id="how-do-i-use-environment-variables-in-the-cmd-instruction-of-a-dockerfile">1.
How do I use environment variables in the CMD instruction of a
Dockerfile?</h3>
<p>We can use environment variables in the CMD instruction of a
Dockerfile. First, we define them in the Dockerfile using the
<code>ENV</code> command. For example, we can write
<code>ENV MY_VAR=hello</code>. Then we can use it in the CMD instruction
like this: <code>CMD ["echo", "$MY_VAR"]</code>. This lets the command
run based on the value of the variable.</p>
<h3 id="can-i-pass-variables-to-a-docker-container-at-runtime">2. Can I
pass variables to a Docker container at runtime?</h3>
<p>Yes, we can pass variables to a Docker container when it runs. We do
this with the <code>-e</code> option in the <code>docker run</code>
command. For example, we can write
<code>docker run -e MY_VAR=value my_image</code>. This sets the
environment variable <code>MY_VAR</code> inside the container. We can
then use this variable in our CMD instruction or in the application
code. This way, we can change how the container behaves.</p>
<h3
id="what-is-the-difference-between-cmd-and-entrypoint-in-a-dockerfile">3.
What is the difference between CMD and ENTRYPOINT in a Dockerfile?</h3>
<p>CMD and ENTRYPOINT in a Dockerfile have different roles. CMD gives
default arguments for the ENTRYPOINT command. It also shows what command
to run if there is no ENTRYPOINT defined. ENTRYPOINT, on the other hand,
tells what main command to run when the container starts. This
difference helps us use variables in CMD easily. We can change behavior
without altering the main command.</p>
<h3
id="how-can-i-use-arg-variables-in-the-cmd-instruction-of-a-dockerfile">4.
How can I use ARG variables in the CMD instruction of a Dockerfile?</h3>
<p>We can define ARG variables at the start of a Dockerfile. We pass
these during the build process. For example, we can write
<code>ARG MY_ARG=default_value</code>. Then we can use it in CMD as
<code>CMD ["sh", "-c", "echo $MY_ARG"]</code>. But we must remember that
ARG variables are not available when the container runs. They are only
for the build process.</p>
<h3
id="what-are-the-best-practices-for-using-variables-in-the-cmd-instruction-of-a-dockerfile">5.
What are the best practices for using variables in the CMD instruction
of a Dockerfile?</h3>
<p>Some best practices for using variables in CMD include defining
environment variables with <code>ENV</code> for when the container runs.
We can use <code>ARG</code> for settings during the build. It is good to
comment on our variables and keep commands easy to understand. We should
avoid hardcoding values. Also, we can use Docker Compose to manage
environment variables in setups with multiple containers. For more tips
on Docker best practices, check this <a
href="https://bestonlinetutorial.com/docker/what-are-docker-security-best-practices.html">guide
on Docker security best practices</a>.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            