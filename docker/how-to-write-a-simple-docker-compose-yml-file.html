
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TFCQEJR7TD');
</script>
            <title>How to Write a Simple `docker-compose.yml` File?</title>
            <meta name="description" content="Learn how to create a simple `docker-compose.yml` file with our easy step-by-step guide. Perfect for beginners!">

            <div id="head-placeholder"></div>
            <script src="/assets/js/blog.js" defer></script>
            <link rel="stylesheet" href="/assets/css/post.css">
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">How to Write a Simple `docker-compose.yml` File?</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>A <code>docker-compose.yml</code> file is a YAML file we use to set
up and run apps with multiple Docker containers. This file tells us
about the services, networks, and volumes we need to run different parts
of our application together.</p>
<p>In this article, we will talk about how to make a simple
<code>docker-compose.yml</code> file. We will go over the main parts of
this file. We will learn how to define services, set up networking,
create volumes, and use environment variables. At the end of this guide,
we will know how to organize our <code>docker-compose.yml</code> file
for better container management. Here are the topics we will cover:</p>
<ul>
<li>How Can You Create a Basic <code>docker-compose.yml</code>
File?</li>
<li>What Are the Essential Components of a
<code>docker-compose.yml</code> File?</li>
<li>How to Define Services in Your <code>docker-compose.yml</code>
File?</li>
<li>How to Configure Networking for Services in
<code>docker-compose.yml</code>?</li>
<li>How to Set Up Volumes in Your <code>docker-compose.yml</code>
File?</li>
<li>How to Use Environment Variables in
<code>docker-compose.yml</code>?</li>
<li>Frequently Asked Questions</li>
</ul>
<p>It is important for us to know how to write a simple
<code>docker-compose.yml</code> file if we are developers using Docker.
This file helps us manage our container apps easily. For more details on
Docker and its parts, we can check out articles like <a
href="https://bestonlinetutorial.com/docker/what-is-docker-and-why-should-you-use-it.html">What
is Docker and Why Should You Use It?</a> and <a
href="https://bestonlinetutorial.com/docker/what-is-docker-compose-and-how-does-it-simplify-multi-container-applications.html">What
is Docker Compose and How Does it Simplify Multi-Container
Applications?</a>.</p>
<h2
id="what-are-the-essential-components-of-a-docker-compose.yml-file">What
Are the Essential Components of a <code>docker-compose.yml</code>
File?</h2>
<p>A <code>docker-compose.yml</code> file is a simple YAML file. We use
it with Docker Compose. It helps us define and run applications with
multiple containers. Here are the important parts of a
<code>docker-compose.yml</code> file:</p>
<ol type="1">
<li><p><strong>Version</strong>: This tells which version of the Docker
Compose file we are using. It is necessary for using different Docker
Compose features.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3.8&#39;</span></span></code></pre></div></li>
<li><p><strong>Services</strong>: This part defines the services that
make our application. Each service is a container.</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">web</span><span class="kw">:</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> nginx:latest</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">db</span><span class="kw">:</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> postgres:latest</span></span></code></pre></div></li>
<li><p><strong>Networks</strong>: Here we set up custom networks for the
services to talk to each other. If we do not say anything, Docker makes
a default network.</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">mynetwork</span><span class="kw">:</span></span></code></pre></div></li>
<li><p><strong>Volumes</strong>: This part gives storage that lasts for
our containers. We use volumes to keep data safe even when we remove
containers.</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">db_data</span><span class="kw">:</span></span></code></pre></div></li>
<li><p><strong>Environment Variables</strong>: We use these to send
environment variables to the services. We can do this directly or with a
<code>.env</code> file.</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> POSTGRES_USER=myuser</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> POSTGRES_PASSWORD=mypassword</span></span></code></pre></div></li>
<li><p><strong>Ports</strong>: This maps container ports to host ports.
It let us access the services from outside the container.</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;80:80&quot;</span></span></code></pre></div></li>
<li><p><strong>Build</strong>: This part tells where to find the build
context and Dockerfile if we want to build an image from the source.</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">build</span><span class="kw">:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">context</span><span class="kw">:</span><span class="at"> ./app</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">dockerfile</span><span class="kw">:</span><span class="at"> Dockerfile</span></span></code></pre></div></li>
<li><p><strong>Depends_on</strong>: This part shows the dependencies
between services. It makes sure a service starts only after its needed
services are running.</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">depends_on</span><span class="kw">:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> db</span></span></code></pre></div></li>
</ol>
<p>These parts together help us define the structure of our application.
They show how services talk to each other and how we manage data. So,
the <code>docker-compose.yml</code> file is very important for using
Docker Compose well. For more details on making a basic
<code>docker-compose.yml</code> file, check out <a
href="https://bestonlinetutorial.com/docker/what-is-docker-compose-and-how-does-it-simplify-multi-container-applications.html">this
article</a>.</p>
<h2 id="how-to-define-services-in-your-docker-compose.yml-file">How to
Define Services in Your <code>docker-compose.yml</code> File?</h2>
<p>Defining services in our <code>docker-compose.yml</code> file is
important for setting up multi-container apps. Each service matches a
container. We can define it using this simple structure:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3&#39;</span><span class="co"> # This is the Compose file format version</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">web</span><span class="kw">:</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> nginx:latest</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;80:80&quot;</span><span class="co"> # This connects port 80 on the host to port 80 on the container</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">app</span><span class="kw">:</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">build</span><span class="kw">:</span><span class="at"> ./app</span><span class="co"> # This builds from the Dockerfile in the ./app folder</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">depends_on</span><span class="kw">:</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> db</span><span class="co"> # This shows which services it depends on</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">db</span><span class="kw">:</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> postgres:latest</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">POSTGRES_USER</span><span class="kw">:</span><span class="at"> user</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">POSTGRES_PASSWORD</span><span class="kw">:</span><span class="at"> password</span></span></code></pre></div>
<h3 id="key-elements-in-service-definitions">Key Elements in Service
Definitions:</h3>
<ul>
<li><strong>image</strong>: This tells which Docker image to use for the
service.</li>
<li><strong>build</strong>: This shows that Docker will build the image
from a folder with a Dockerfile.</li>
<li><strong>ports</strong>: This connects container ports to host ports.
It allows access from outside.</li>
<li><strong>depends_on</strong>: This defines service dependencies. It
makes sure that needed services start before this one.</li>
<li><strong>environment</strong>: This sets environment variables for
the container.</li>
</ul>
<h3 id="example">Example:</h3>
<p>In this example, we define three services: <code>web</code>,
<code>app</code>, and <code>db</code>. The <code>web</code> service uses
the Nginx image. The <code>app</code> service builds from a local
folder. The <code>db</code> service uses the PostgreSQL image with some
environment variables.</p>
<p>Using this simple structure helps us manage many services easily with
Docker Compose. It makes it easier to run our application. For more info
on Docker Compose, we can check <a
href="https://bestonlinetutorial.com/docker/what-is-docker-compose-and-how-does-it-simplify-multi-container-applications.html">what
is Docker Compose and how does it simplify multi-container
applications</a>.</p>
<h2
id="how-to-configure-networking-for-services-in-docker-compose.yml">How
to Configure Networking for Services in
<code>docker-compose.yml</code>?</h2>
<p>In a <code>docker-compose.yml</code> file, networking helps different
services talk to each other. By default, Docker Compose makes one
network for your app. This lets all services connect easily. But we can
also create custom networks to control how services work together.</p>
<h3 id="defining-networks">Defining Networks</h3>
<p>We can define networks at the bottom of our
<code>docker-compose.yml</code> file in the <code>networks</code>
section. Here is a simple example:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3.8&#39;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">app</span><span class="kw">:</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> myapp:latest</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> my_custom_network</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">db</span><span class="kw">:</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> postgres:latest</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> my_custom_network</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">my_custom_network</span><span class="kw">:</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">driver</span><span class="kw">:</span><span class="at"> bridge</span></span></code></pre></div>
<h3 id="connecting-services-to-networks">Connecting Services to
Networks</h3>
<p>To connect a service to a network, we use the <code>networks</code>
property under the service. We can put a service in more than one
network if we want:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">web</span><span class="kw">:</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> nginx:latest</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> frontend</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> backend</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">backend</span><span class="kw">:</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my_backend:latest</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> backend</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">frontend</span><span class="kw">:</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">backend</span><span class="kw">:</span></span></code></pre></div>
<h3 id="using-external-networks">Using External Networks</h3>
<p>If we want to connect our services to an already existing Docker
network, we can use it as an external network:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3.8&#39;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">app</span><span class="kw">:</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> myapp:latest</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> external_network</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">external_network</span><span class="kw">:</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">external</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code></pre></div>
<h3 id="network-configuration-options">Network Configuration
Options</h3>
<p>We can set different options for networks, like IPAM (IP Address
Management):</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">my_custom_network</span><span class="kw">:</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">driver</span><span class="kw">:</span><span class="at"> bridge</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ipam</span><span class="kw">:</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">config</span><span class="kw">:</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">subnet</span><span class="kw">:</span><span class="at"> 172.28.0.0/16</span></span></code></pre></div>
<p>This lets us set a specific subnet for our network. It helps us
manage IP addresses better.</p>
<h3 id="service-communication">Service Communication</h3>
<p>Services can talk to each other using the service name as the
hostname. For example, if we have a service called <code>db</code>,
other services can connect to it using <code>db:port</code>.</p>
<p>Here is an example of how to connect a <code>web</code> service to a
<code>db</code> service:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">web</span><span class="kw">:</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> nginx:latest</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">depends_on</span><span class="kw">:</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> db</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">db</span><span class="kw">:</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> postgres:latest</span></span></code></pre></div>
<p>In this case, the <code>web</code> service can connect to the
<code>db</code> service using <code>db:5432</code>.</p>
<p>For more detailed info on Docker networking, check the article on <a
href="https://bestonlinetutorial.com/docker/what-are-docker-networks-and-why-are-they-necessary.html">Docker
networks</a>.</p>
<h2 id="how-to-set-up-volumes-in-your-docker-compose.yml-file">How to
Set Up Volumes in Your <code>docker-compose.yml</code> File?</h2>
<p>To set up volumes in our <code>docker-compose.yml</code> file, we
need to define them in the <code>volumes</code> section. Volumes help us
keep data that Docker containers create and use. Here is how we can do
it:</p>
<h3 id="basic-volume-configuration">Basic Volume Configuration</h3>
<p>We can define a volume for a service like this:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3.8&#39;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">app</span><span class="kw">:</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> myapp:latest</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> mydata:/data</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./localdir:/app</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> /tmp:/tmp</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">mydata</span><span class="kw">:</span></span></code></pre></div>
<h3 id="explanation-of-volume-definitions">Explanation of Volume
Definitions</h3>
<ol type="1">
<li><p><strong>Named Volume</strong>: <code>mydata:/data</code> means we
have a named volume called <code>mydata</code>. Docker creates and
manages this volume. The data in this volume stays even if we remove the
container.</p></li>
<li><p><strong>Bind Mount</strong>: <code>./localdir:/app</code>
connects our local folder <code>localdir</code> to the <code>/app</code>
folder inside the container. This way we can share files between our
computer and the container.</p></li>
<li><p><strong>Anonymous Volume</strong>: <code>/tmp:/tmp</code> uses an
anonymous volume. It lets the container write to the <code>/tmp</code>
folder inside it but this data does not stay after we remove the
container.</p></li>
</ol>
<h3 id="common-use-cases-for-volumes">Common Use Cases for Volumes</h3>
<ul>
<li><strong>Data Persistence</strong>: We store database data so it does
not get lost when we stop or remove the container.</li>
<li><strong>Development</strong>: We use bind mounts to see changes made
in our local folder right away in the container.</li>
<li><strong>Configuration Files</strong>: We keep configuration files in
a volume for easy access and changes.</li>
</ul>
<h3 id="volume-options">Volume Options</h3>
<p>We can add more options for volumes like <code>driver</code>,
<code>driver_opts</code>, and <code>external</code>:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">mydata</span><span class="kw">:</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">driver</span><span class="kw">:</span><span class="at"> local</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">driver_opts</span><span class="kw">:</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> none</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">device</span><span class="kw">:</span><span class="at"> /path/on/host</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">o</span><span class="kw">:</span><span class="at"> bind</span></span></code></pre></div>
<p>This setup makes a local volume with specific options. It helps us
control how our data is managed.</p>
<p>For more information on volumes, we can check the article on <a
href="https://bestonlinetutorial.com/docker/what-are-docker-volumes-and-how-do-they-work.html">what
are Docker volumes and how do they work</a>.</p>
<h2 id="how-to-use-environment-variables-in-docker-compose.yml">How to
Use Environment Variables in <code>docker-compose.yml</code>?</h2>
<p>We can use environment variables in a <code>docker-compose.yml</code>
file to set up our services based on where they run. We have a few ways
to define environment variables:</p>
<ol type="1">
<li><p><strong>Directly in the <code>docker-compose.yml</code></strong>:
We can add environment variables right under the service setup.</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3&#39;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">app</span><span class="kw">:</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> myapp:latest</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> NODE_ENV=production</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> DB_HOST=db</span></span></code></pre></div></li>
<li><p><strong>Using a <code>.env</code> File</strong>: We can make a
<code>.env</code> file in the same folder as our
<code>docker-compose.yml</code> and write our variables there. Docker
Compose will find these variables automatically.</p>
<p><strong>.env file</strong>:</p>
<pre><code>NODE_ENV=production
DB_HOST=db</code></pre>
<p><strong>docker-compose.yml</strong>:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3&#39;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">app</span><span class="kw">:</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> myapp:latest</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> NODE_ENV</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> DB_HOST</span></span></code></pre></div></li>
<li><p><strong>Using Shell Environment Variables</strong>: We can also
use shell environment variables in our <code>docker-compose.yml</code>
file. We need to use the <code>${VARIABLE}</code> format.</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3&#39;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">app</span><span class="kw">:</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> myapp:latest</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> NODE_ENV=${NODE_ENV}</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> DB_HOST=${DB_HOST}</span></span></code></pre></div></li>
<li><p><strong>Default Values for Environment Variables</strong>: We can
set default values for environment variables right in the
<code>docker-compose.yml</code> file.</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3&#39;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">app</span><span class="kw">:</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> myapp:latest</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> NODE_ENV=${NODE_ENV:-development}</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> DB_HOST=${DB_HOST:-localhost}</span></span></code></pre></div></li>
</ol>
<p>By using these ways, we can manage our app settings in different
environments. This helps us avoid putting sensitive information directly
in our <code>docker-compose.yml</code> file. For more about managing
Docker setups, see <a
href="https://bestonlinetutorial.com/docker/what-is-docker-compose-and-how-does-it-simplify-multi-container-applications.html">what
is Docker Compose and how does it simplify multi-container
applications</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3 id="what-is-a-docker-compose.yml-file-used-for">1. What is a
<code>docker-compose.yml</code> file used for?</h3>
<p>We use a <code>docker-compose.yml</code> file to set up and manage
applications with multiple Docker containers. This file is in YAML
format. It helps us define the services, networks, and volumes needed
for our application. With this file, we can start our whole application
using just one command. This makes it easier to handle complex
setups.</p>
<h3 id="how-do-i-create-a-docker-compose.yml-file">2. How do I create a
<code>docker-compose.yml</code> file?</h3>
<p>To create a <code>docker-compose.yml</code> file, we just need to
make a new text file and name it <code>docker-compose.yml</code> in our
project folder. Then, we can use a text editor to write our services,
networks, and volumes in YAML format. We should start with a version
line and then list our services. We need to mention the image, ports,
and environment variables if needed. You can see our guide on <a
href="https://bestonlinetutorial.com/docker/how-to-install-docker-compose.html">how
to set up Docker Compose</a> for more info.</p>
<h3
id="can-i-use-environment-variables-in-my-docker-compose.yml-file">3.
Can I use environment variables in my <code>docker-compose.yml</code>
file?</h3>
<p>Yes, we can use environment variables in our
<code>docker-compose.yml</code> file. This helps us make our setup more
flexible and safe. We can add environment variables directly in the YAML
file under the <code>environment</code> section for each service. We can
also use an external <code>.env</code> file to reference them. This way,
we can keep sensitive information like passwords out of our main
configuration.</p>
<h3 id="how-does-networking-work-in-a-docker-compose.yml-file">4. How
does networking work in a <code>docker-compose.yml</code> file?</h3>
<p>Networking in a <code>docker-compose.yml</code> file lets our
services talk to each other easily. By default, Docker Compose makes a
separate network for our application. All services connect to this
network. We can also create custom networks and choose which services
can talk over them. This helps us keep things secure and organized in
our Docker setup. We can learn more about <a
href="https://bestonlinetutorial.com/docker/what-are-docker-networks-and-why-are-they-necessary.html">Docker
networking</a> for multi-container applications.</p>
<h3
id="what-are-volumes-in-a-docker-compose.yml-file-and-why-are-they-important">5.
What are volumes in a <code>docker-compose.yml</code> file and why are
they important?</h3>
<p>Volumes in a <code>docker-compose.yml</code> file help us keep data
that our Docker containers create and use. They let us store data
outside the container filesystem. This means our data stays safe even if
we stop or remove the containers. By defining volumes in our setup, we
can manage our data better. This is really important for applications
that need to keep data saved. For more details, check our article on <a
href="https://bestonlinetutorial.com/docker/how-to-create-and-use-docker-volumes.html">how
to create and use Docker volumes</a>.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            