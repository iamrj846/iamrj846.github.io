
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
            <!-- Google tag (gtag.js) -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
            <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-TFCQEJR7TD');
            </script>
            <meta charset="utf-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
<script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "BestOnlineTutorial",
      "url": "https://www.bestonlinetutorial.com/"
    }
    </script>
            <!-- Common CSS & Icons -->
            <link rel="icon" href="/favicon.ico" type="image/x-icon">
            <link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
            <link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
            <link rel="stylesheet" href="/assets/css/post.css">
            <title>Can You Run Multiple Programs in a Docker Container?</title>
            <meta name="description" content="Discover how to run multiple programs in a Docker container effectively with our step-by-step guide and expert tips.">
            <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	        <script src="/assets/js/blog.js"></script>
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">Can You Run Multiple Programs in a Docker Container?</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>Yes, we can run many programs in a Docker container. But it is better
to run one main service per container. This way, it is easier to manage
and scale. If our application needs it, there are ways to run multiple
processes. We can use tools like Supervisor or Docker Compose. These
tools help us manage many programs in one container.</p>
<p>In this article, we will look at different ways to run multiple
programs in a Docker container. We will talk about how to use Supervisor
for managing processes. We will see how Docker Compose can help us with
multiple services. We will also check how init systems manage processes.
Plus, we will explore using shell scripts to start many applications. We
will share best practices when we use these methods. Here is what we
will cover:</p>
<ul>
<li>Can You Run Multiple Programs in a Docker Container?</li>
<li>How to Run Multiple Programs in a Docker Container with
Supervisor?</li>
<li>Using Docker Compose to Manage Multiple Programs in a Single
Container?</li>
<li>Running Multiple Services in a Docker Container with Init
Systems?</li>
<li>Is It Possible to Use a Shell Script to Run Multiple Programs in a
Docker Container?</li>
<li>Best Practices for Running Multiple Programs in a Docker
Container?</li>
<li>Frequently Asked Questions</li>
</ul>
<h2
id="how-to-run-multiple-programs-in-a-docker-container-with-supervisor">How
to Run Multiple Programs in a Docker Container with Supervisor?</h2>
<p>We can manage multiple programs in a Docker container using
Supervisor. It is a tool that helps us monitor and control different
processes in one container. This is very helpful for apps that need more
than one service to run at the same time, like web servers and
databases.</p>
<h3 id="step-1-install-supervisor">Step 1: Install Supervisor</h3>
<p>First, we need to make sure Supervisor is installed in our Docker
image. We can do this by adding these lines to our Dockerfile:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> ubuntu:20.04</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Install Supervisor</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">apt-get</span> update <span class="kw">&amp;&amp;</span> <span class="ex">apt-get</span> install <span class="at">-y</span> supervisor</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the directory for Supervisor configuration files</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="fu">mkdir</span> <span class="at">-p</span> /var/log/supervisor</span></code></pre></div>
<h3 id="step-2-create-a-supervisor-configuration-file">Step 2: Create a
Supervisor Configuration File</h3>
<p>Next, we create a Supervisor configuration file to tell it which
programs to run. For example, we can create a file called
<code>supervisord.conf</code> with this content:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[supervisord]</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="dt">nodaemon</span><span class="ot">=</span><span class="kw">true</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">[program:program1]</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="dt">command</span><span class="ot">=</span><span class="st">/path/to/program1</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="dt">autostart</span><span class="ot">=</span><span class="kw">true</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="dt">autorestart</span><span class="ot">=</span><span class="kw">true</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="dt">stderr_logfile</span><span class="ot">=</span><span class="st">/var/log/program1.err.log</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="dt">stdout_logfile</span><span class="ot">=</span><span class="st">/var/log/program1.out.log</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="kw">[program:program2]</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="dt">command</span><span class="ot">=</span><span class="st">/path/to/program2</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="dt">autostart</span><span class="ot">=</span><span class="kw">true</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="dt">autorestart</span><span class="ot">=</span><span class="kw">true</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="dt">stderr_logfile</span><span class="ot">=</span><span class="st">/var/log/program2.err.log</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="dt">stdout_logfile</span><span class="ot">=</span><span class="st">/var/log/program2.out.log</span></span></code></pre></div>
<h3 id="step-3-include-the-configuration-in-the-dockerfile">Step 3:
Include the Configuration in the Dockerfile</h3>
<p>Now we add the configuration file to our Docker image by copying it
to the right place:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy Supervisor configuration file</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> supervisord.conf /etc/supervisor/conf.d/supervisord.conf</span></code></pre></div>
<h3 id="step-4-run-supervisor-in-the-docker-container">Step 4: Run
Supervisor in the Docker Container</h3>
<p>Finally, we need to change the CMD instruction in our Dockerfile to
run Supervisor:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;/usr/bin/supervisord&quot;</span>, <span class="st">&quot;-c&quot;</span>, <span class="st">&quot;/etc/supervisor/conf.d/supervisord.conf&quot;</span>]</span></code></pre></div>
<h3 id="complete-dockerfile-example">Complete Dockerfile Example</h3>
<p>Here is how our complete Dockerfile might look:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> ubuntu:20.04</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Install Supervisor</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">apt-get</span> update <span class="kw">&amp;&amp;</span> <span class="ex">apt-get</span> install <span class="at">-y</span> supervisor</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create log directory</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="fu">mkdir</span> <span class="at">-p</span> /var/log/supervisor</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy Supervisor configuration file</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> supervisord.conf /etc/supervisor/conf.d/supervisord.conf</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Command to run Supervisor</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;/usr/bin/supervisord&quot;</span>, <span class="st">&quot;-c&quot;</span>, <span class="st">&quot;/etc/supervisor/conf.d/supervisord.conf&quot;</span>]</span></code></pre></div>
<h3 id="build-and-run-the-docker-container">Build and Run the Docker
Container</h3>
<p>To build and run our Docker container, we use these commands:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> build <span class="at">-t</span> my-multi-service-app .</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-d</span> my-multi-service-app</span></code></pre></div>
<p>Using Supervisor helps us manage multiple programs in a Docker
container. It gives us better control and monitoring. Our services can
run smoothly and restart automatically if they fail. For more info on
Docker and its features, check <a
href="https://bestonlinetutorial.com/docker/what-is-docker-and-why-should-you-use-it.html">this
guide</a>.</p>
<h2
id="using-docker-compose-to-manage-multiple-programs-in-a-single-container">Using
Docker Compose to Manage Multiple Programs in a Single Container?</h2>
<p>Docker Compose is a useful tool. It helps us define and run
multi-container Docker applications. We can also use Docker Compose to
manage multiple programs in one container. We usually do this with a
<code>docker-compose.yml</code> file. This file lets us specify the
services, networks, and volumes our application needs.</p>
<p>Here are some steps to run multiple programs in one container with
Docker Compose:</p>
<ol type="1">
<li><p><strong>Create a Dockerfile</strong>: We need to define the
environment and install necessary packages. For example, if we want to
run a web server and a database in one container, we can install both in
our Dockerfile.</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> ubuntu:20.04</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">apt-get</span> update <span class="kw">&amp;&amp;</span> <span class="ex">apt-get</span> install <span class="at">-y</span> <span class="dt">\</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    nginx <span class="dt">\</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    mysql-server <span class="dt">\</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&amp;&amp;</span> <span class="fu">rm</span> <span class="at">-rf</span> /var/lib/apt/lists/<span class="pp">*</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> ./nginx.conf /etc/nginx/nginx.conf</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> ./start.sh /start.sh</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="fu">chmod</span> +x /start.sh</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;/start.sh&quot;</span>]</span></code></pre></div></li>
<li><p><strong>Create a Start Script</strong>: This shell script will
start the services we need when the container runs.</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ex">service</span> mysql start</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="ex">service</span> nginx start</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span> <span class="at">-f</span> /var/log/nginx/access.log</span></code></pre></div></li>
<li><p><strong>Define your Docker Compose File</strong>: The
<code>docker-compose.yml</code> file will tell how to build and run the
container.</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3&#39;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">myservice</span><span class="kw">:</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">build</span><span class="kw">:</span><span class="at"> .</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;80:80&quot;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;3306:3306&quot;</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./data:/var/lib/mysql</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">MYSQL_ROOT_PASSWORD</span><span class="kw">:</span><span class="at"> example</span></span></code></pre></div></li>
<li><p><strong>Build and Run Your Application</strong>: We can use this
command to build and run our app with Docker Compose.</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker-compose</span> up <span class="at">--build</span></span></code></pre></div></li>
</ol>
<p>This setup helps us manage multiple programs inside one Docker
container. It makes it easier to configure, build, and deploy apps that
need several services. For more info on Docker Compose, you can check <a
href="https://bestonlinetutorial.com/docker/what-is-docker-compose-and-how-does-it-simplify-multi-container-applications.html">this
article on Docker Compose</a>.</p>
<h2
id="running-multiple-services-in-a-docker-container-with-init-systems">Running
Multiple Services in a Docker Container with Init Systems?</h2>
<p>Yes, we can run multiple services in a Docker container. We can use
init systems like <code>systemd</code> or <code>supervisord</code>.
These tools help manage many processes. They make sure all services
start and stop properly.</p>
<h3 id="using-systemd-in-docker">Using Systemd in Docker</h3>
<p>To use <code>systemd</code> in a Docker container, we need to run the
container in privileged mode. We also need the right systemd files. Here
is a simple example:</p>
<ol type="1">
<li><strong>Dockerfile</strong>:</li>
</ol>
<div class="sourceCode" id="cb11"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> ubuntu:20.04</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">apt-get</span> update <span class="kw">&amp;&amp;</span> <span class="ex">apt-get</span> install <span class="at">-y</span> <span class="dt">\</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    systemd <span class="dt">\</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&amp;&amp;</span> <span class="ex">apt-get</span> clean</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="kw">VOLUME</span> [ <span class="st">&quot;/sys/fs/cgroup&quot;</span> ]</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;/lib/systemd/systemd&quot;</span>]</span></code></pre></div>
<ol start="2" type="1">
<li><strong>Building the Image</strong>:</li>
</ol>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> build <span class="at">-t</span> my-systemd-image .</span></code></pre></div>
<ol start="3" type="1">
<li><strong>Running the Container</strong>:</li>
</ol>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">--privileged</span> <span class="at">-d</span> <span class="at">--name</span> my-systemd-container <span class="dt">\</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">--volume</span> /sys/fs/cgroup:/sys/fs/cgroup:ro <span class="dt">\</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    my-systemd-image</span></code></pre></div>
<ol start="4" type="1">
<li><strong>Starting Services</strong>: Inside the container, we can
start services with <code>systemctl</code>:</li>
</ol>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">systemctl</span> start my-service</span></code></pre></div>
<h3 id="using-supervisord-in-docker">Using Supervisord in Docker</h3>
<p><code>supervisord</code> is a simpler option for managing many
processes. Here is how we can set it up:</p>
<ol type="1">
<li><strong>Dockerfile</strong>:</li>
</ol>
<div class="sourceCode" id="cb15"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> ubuntu:20.04</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">apt-get</span> update <span class="kw">&amp;&amp;</span> <span class="ex">apt-get</span> install <span class="at">-y</span> <span class="dt">\</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    supervisor <span class="dt">\</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&amp;&amp;</span> <span class="ex">apt-get</span> clean</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> supervisord.conf /etc/supervisor/conf.d/supervisord.conf</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;/usr/bin/supervisord&quot;</span>]</span></code></pre></div>
<ol start="2" type="1">
<li><strong>supervisord.conf</strong>:</li>
</ol>
<div class="sourceCode" id="cb16"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[supervisord]</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="dt">nodaemon</span><span class="ot">=</span><span class="kw">true</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="kw">[program:service1]</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="dt">command</span><span class="ot">=</span><span class="st">/path/to/service1</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="dt">autostart</span><span class="ot">=</span><span class="kw">true</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="dt">autorestart</span><span class="ot">=</span><span class="kw">true</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="kw">[program:service2]</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="dt">command</span><span class="ot">=</span><span class="st">/path/to/service2</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="dt">autostart</span><span class="ot">=</span><span class="kw">true</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="dt">autorestart</span><span class="ot">=</span><span class="kw">true</span></span></code></pre></div>
<ol start="3" type="1">
<li><strong>Building the Image</strong>:</li>
</ol>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> build <span class="at">-t</span> my-supervisor-image .</span></code></pre></div>
<ol start="4" type="1">
<li><strong>Running the Container</strong>:</li>
</ol>
<div class="sourceCode" id="cb18"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-d</span> <span class="at">--name</span> my-supervisor-container my-supervisor-image</span></code></pre></div>
<h3 id="advantages-of-using-init-systems">Advantages of Using Init
Systems</h3>
<ul>
<li><strong>Process Management</strong>: It restarts crashed services
automatically.</li>
<li><strong>Logging</strong>: It logs all services in one place.</li>
<li><strong>Dependency Handling</strong>: It manages service
dependencies well.</li>
</ul>
<p>For more details on containerization with Docker, we can check <a
href="https://bestonlinetutorial.com/docker/what-is-containerization-and-how-does-it-relate-to-docker.html">what
is containerization and how does it relate to Docker</a>.</p>
<h2
id="is-it-possible-to-use-a-shell-script-to-run-multiple-programs-in-a-docker-container">Is
It Possible to Use a Shell Script to Run Multiple Programs in a Docker
Container?</h2>
<p>Yes, we can use a shell script to run multiple programs in a Docker
container. This way, we can start more than one process in a single
container easily. Here is how we can do it:</p>
<ol type="1">
<li><p><strong>Create a Shell Script</strong>: We need to write a shell
script with commands to start our programs. For example, we can create a
file called <code>start_services.sh</code>:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Start the first service</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="ex">service1</span> <span class="kw">&amp;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Start the second service</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="ex">service2</span> <span class="kw">&amp;</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Wait for all background jobs to finish</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="bu">wait</span></span></code></pre></div>
<p>Remember to change <code>service1</code> and <code>service2</code> to
the real commands for our programs.</p></li>
<li><p><strong>Make the Script Executable</strong>: Before we use the
script in our Docker container, we must make it executable:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> +x start_services.sh</span></code></pre></div></li>
<li><p><strong>Dockerfile Configuration</strong>: We can use this shell
script in our Dockerfile. Here is an example:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> ubuntu:latest</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy the shell script into the container</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> start_services.sh /usr/local/bin/start_services.sh</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Install necessary packages (if any)</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">apt-get</span> update <span class="kw">&amp;&amp;</span> <span class="ex">apt-get</span> install <span class="at">-y</span> <span class="dt">\</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    service1-package <span class="dt">\</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    service2-package <span class="dt">\</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&amp;&amp;</span> <span class="fu">rm</span> <span class="at">-rf</span> /var/lib/apt/lists/<span class="pp">*</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the default command to run the shell script</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;/usr/local/bin/start_services.sh&quot;</span>]</span></code></pre></div></li>
<li><p><strong>Build and Run the Docker Container</strong>: We need to
build the Docker image and run the container:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> build <span class="at">-t</span> my-multi-service .</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-d</span> my-multi-service</span></code></pre></div></li>
</ol>
<p>Using a shell script, we can manage many services better in one
Docker container. This way is good for small applications or when we are
developing. It is okay to manage multiple services in one container.</p>
<p>For more information about Docker and what it can do, we can read
about <a
href="https://bestonlinetutorial.com/docker/how-does-docker-differ-from-virtual-machines.html">how
Docker is different from virtual machines</a> or <a
href="https://bestonlinetutorial.com/docker/what-are-the-benefits-of-using-docker-in-development.html">the
benefits of using Docker in development</a>.</p>
<h2
id="best-practices-for-running-multiple-programs-in-a-docker-container">Best
Practices for Running Multiple Programs in a Docker Container</h2>
<p>When we run multiple programs in a Docker container, we must follow
some best practices. This helps us keep things easy to maintain,
efficient, and reliable. Here are some important tips to think
about:</p>
<ol type="1">
<li><p><strong>Use a Process Manager</strong>: We should use a process
manager like Supervisor or systemd. It helps us manage many services in
one container. This way, we can handle the program lifecycles well.</p>
<p>Here is an example of a Supervisor configuration:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[supervisord]</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="dt">nodaemon</span><span class="ot">=</span><span class="kw">true</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="kw">[program:service1]</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="dt">command</span><span class="ot">=</span><span class="st">/usr/bin/service1</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="dt">autostart</span><span class="ot">=</span><span class="kw">true</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="dt">autorestart</span><span class="ot">=</span><span class="kw">true</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="kw">[program:service2]</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="dt">command</span><span class="ot">=</span><span class="st">/usr/bin/service2</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="dt">autostart</span><span class="ot">=</span><span class="kw">true</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="dt">autorestart</span><span class="ot">=</span><span class="kw">true</span></span></code></pre></div></li>
<li><p><strong>Keep Containers Single-Purpose</strong>: We should design
containers to run one service if we can. This fits with microservices
architecture. It makes scaling and managing easier.</p></li>
<li><p><strong>Leverage Docker Compose</strong>: We can use Docker
Compose to define and run multi-container applications. This helps us
manage services separately while keeping them connected.</p>
<p>Here is a sample <code>docker-compose.yml</code>:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3&#39;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">app</span><span class="kw">:</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> myapp:latest</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">depends_on</span><span class="kw">:</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> db</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">db</span><span class="kw">:</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> postgres:latest</span></span></code></pre></div></li>
<li><p><strong>Run Services on Different Ports</strong>: If we need to
run many services in one container, we must make sure they listen on
different ports. This avoids conflicts. We can use the <code>-p</code>
flag to expose different ports.</p></li>
<li><p><strong>Use Init Systems</strong>: For more complex setups, we
can think about using an init system like runit or s6. These systems
help us manage many processes better and provide good logging.</p></li>
<li><p><strong>Monitor Resource Usage</strong>: We must keep an eye on
how much resources each service uses. We can use Docker’s built-in tools
or other solutions to track performance.</p></li>
<li><p><strong>Avoid Running Multiple Processes with CMD</strong>: We
should not use the <code>CMD</code> instruction to run many processes
directly. This can cause problems with stopping processes and
logging.</p></li>
<li><p><strong>Implement Health Checks</strong>: We need to define
health checks for our services. This makes sure they run correctly. It
helps restart services that fail automatically.</p>
<p>Here is an example of a health check in the Dockerfile:</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">HEALTHCHECK</span> <span class="op">--interval=30s</span> <span class="op">--timeout=3s</span> <span class="op">--retries=3</span> <span class="kw">CMD</span> <span class="ex">curl</span> <span class="at">-f</span> http://localhost/ <span class="kw">||</span> <span class="bu">exit</span> 1</span></code></pre></div></li>
<li><p><strong>Log Management</strong>: We must ensure we have
centralized logging for all services in the container. We can redirect
logs to stdout/stderr or use a logging driver to collect logs for
checking.</p></li>
<li><p><strong>Security Best Practices</strong>: We should limit the
privileges of the container. We can run services as a non-root user.
Using Docker’s security options makes our multi-program setup more
secure.</p></li>
</ol>
<p>By following these best practices for running multiple programs in a
Docker container, we can make our applications more robust and easier to
maintain. We can also take advantage of Docker’s efficiency. For more
insights on managing Docker well, we can check out <a
href="https://bestonlinetutorial.com/docker/what-are-the-benefits-of-using-docker-in-development.html">this
article on Docker’s benefits</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3 id="can-we-run-multiple-processes-in-a-single-docker-container">1.
Can we run multiple processes in a single Docker container?</h3>
<p>Yes, we can run multiple processes in one Docker container. But it’s
better to run one process per container. This way, we keep things clear
and easy to manage. If we need to run many programs, we can use tools
like Supervisor or Docker Compose. They help us manage those processes
better. For best practices, we can read our article on <a
href="https://bestonlinetutorial.com/docker/best-practices-for-running-multiple-programs-in-a-docker-container.html">Best
Practices for Running Multiple Programs in a Docker Container</a>.</p>
<h3 id="what-is-the-supervisor-tool-and-how-does-it-help-in-docker">2.
What is the Supervisor tool and how does it help in Docker?</h3>
<p>Supervisor is a tool that helps us control processes. It lets us
manage many processes in a Docker container. We can start, stop, and
restart processes easily with it. This way, we can run multiple
applications in one container without losing stability. For more details
on how to use Supervisor, we can check our guide on <a
href="https://bestonlinetutorial.com/docker/how-to-run-multiple-programs-in-a-docker-container-with-supervisor.html">How
to Run Multiple Programs in a Docker Container with Supervisor</a>.</p>
<h3 id="how-can-docker-compose-help-with-multiple-programs">3. How can
Docker Compose help with multiple programs?</h3>
<p>Docker Compose is a tool that makes it easy to run many Docker
containers as one service. We can write multiple services in a
<code>docker-compose.yml</code> file. This helps us manage them
together. It makes our work more organized and helps manage dependencies
between services. To learn how to use Docker Compose well, we can visit
our article on <a
href="https://bestonlinetutorial.com/docker/what-is-docker-compose-and-how-does-it-simplify-multi-container-applications.html">What
is Docker Compose and How Does It Simplify Multi-Container
Applications</a>.</p>
<h3
id="are-there-best-practices-for-running-multiple-services-in-a-docker-container">4.
Are there best practices for running multiple services in a Docker
container?</h3>
<p>When we run multiple services in a Docker container, we should
remember some best practices. These include using a process manager like
Supervisor, having clear service boundaries, and making sure we have
proper logging and monitoring. Also, using Docker Compose can help us
manage dependencies better. For more best practices, we can check our
article on <a
href="https://bestonlinetutorial.com/docker/best-practices-for-running-multiple-programs-in-a-docker-container.html">Best
Practices for Running Multiple Programs in a Docker Container</a>.</p>
<h3
id="can-we-use-a-shell-script-to-run-multiple-programs-in-a-docker-container">5.
Can we use a shell script to run multiple programs in a Docker
container?</h3>
<p>Yes, we can use a shell script to run multiple programs in a Docker
container. But we need to make sure the script manages processes well.
This includes logging and health checks. While this way works, using a
process manager or Docker Compose is often better for managing many
applications. For more insights, we can read our article on <a
href="https://bestonlinetutorial.com/docker/is-it-possible-to-use-a-shell-script-to-run-multiple-programs-in-a-docker-container.html">Is
It Possible to Use a Shell Script to Run Multiple Programs in a Docker
Container?</a>.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            