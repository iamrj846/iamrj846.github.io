
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
            <!-- Google tag (gtag.js) -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
            <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-TFCQEJR7TD');
            </script>
            <meta charset="utf-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
<script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "BestOnlineTutorial",
      "url": "https://www.bestonlinetutorial.com/"
    }
    </script>
            <!-- Common CSS & Icons -->
            <link rel="icon" href="/favicon.ico" type="image/x-icon">
            <link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
            <link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
            <link rel="stylesheet" href="/assets/css/post.css">
            <title>How can you keep a container running on Kubernetes with Docker?</title>
            <meta name="description" content="Learn how to keep your container running on Kubernetes with Docker. Discover best practices and tips for seamless deployment.">
            <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	        <script src="/assets/js/blog.js"></script>
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">How can you keep a container running on Kubernetes with Docker?</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>To keep a container running on Kubernetes with Docker, we can use
Kubernetes tools like Deployments, StatefulSets, and DaemonSets. These
tools help our container applications stay up and running. They can
restart our containers if they fail and manage their lifecycle well.
With these Kubernetes features, we can make our container environment
stronger and easier to scale.</p>
<p>In this article, we will look at different ways to keep a container
running on Kubernetes using Docker. We will talk about how to use
Kubernetes Deployments for stateless applications. We will also see how
to use StatefulSets for stateful applications. Plus, we will discuss
DaemonSets for running containers on each node. Also, we will explain
how Kubernetes Jobs can help with batch processing. We will give tips
for monitoring and fixing container health too.</p>
<ul>
<li>How to Keep a Container Running on Kubernetes with Docker</li>
<li>How can we use Kubernetes Deployments to keep a container running
with Docker?</li>
<li>How do we use Kubernetes StatefulSets for persistent container
management with Docker?</li>
<li>What are Kubernetes DaemonSets for running containers all the time
with Docker?</li>
<li>How can we use Kubernetes Jobs for container execution with
Docker?</li>
<li>How do we monitor and troubleshoot container health in Kubernetes
with Docker?</li>
<li>Frequently Asked Questions</li>
</ul>
<h2
id="how-can-we-use-kubernetes-deployments-to-keep-a-container-running-with-docker">How
can we use Kubernetes Deployments to keep a container running with
Docker?</h2>
<p>Kubernetes Deployments help us manage applications that run in
containers. They make sure that the desired state matches the current
state. To keep a container running with Docker on Kubernetes, we can
define a Deployment resource. Here is an example of how to create a
Deployment using YAML.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app-deployment</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-app</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-app-container</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-docker-image:latest</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span></span></code></pre></div>
<p>In this example:</p>
<ul>
<li><code>replicas: 3</code> means we want three instances of the
container to be running.</li>
<li>The <code>selector</code> tells how to find the pods that this
Deployment manages.</li>
<li>The <code>template</code> shows the pod setup including the
container image and ports.</li>
</ul>
<p>To apply this Deployment, we use this command:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> deployment.yaml</span></code></pre></div>
<p>We can check the status of the Deployment with this command:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get deployments</span></code></pre></div>
<p>If a container crashes or stops, the Deployment controller will
automatically create a new pod. This keeps the desired number of
replicas. Our application can stay running all the time.</p>
<p>For more information on managing containers with Docker in
Kubernetes, we can learn how to <a
href="https://bestonlinetutorial.com/docker/how-to-use-docker-with-kubernetes-for-orchestration.html">use
Docker with Kubernetes for orchestration</a>.</p>
<h2
id="how-do-we-leverage-kubernetes-statefulsets-for-persistent-container-management-with-docker">How
do we leverage Kubernetes StatefulSets for persistent container
management with Docker?</h2>
<p>Kubernetes StatefulSets help us manage stateful applications in a
Kubernetes cluster. They are especially useful for apps that need
persistent storage. When we use Docker containers with Kubernetes, we
can use StatefulSets to keep the identity and storage of our containers
safe, even if they get rescheduled.</p>
<h3 id="key-features-of-statefulsets">Key Features of StatefulSets:</h3>
<ul>
<li><strong>Stable Network Identity</strong>: Each pod in a StatefulSet
has its own unique and stable network name. It also has a predictable
hostname.</li>
<li><strong>Ordered Deployment and Scaling</strong>: StatefulSets make
sure that pods are deployed and scaled in a specific order.</li>
<li><strong>Persistent Storage</strong>: StatefulSets can handle
persistent volumes for every pod. These volumes stay even when the pod
is rescheduled.</li>
</ul>
<h3 id="example-yaml-configuration">Example YAML Configuration:</h3>
<p>Here is a sample config for a StatefulSet that uses Docker:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> StatefulSet</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-stateful-app</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">serviceName</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;my-service&quot;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-stateful-app</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> my-stateful-app</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-container</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-docker-image:latest</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">volumeMounts</span><span class="kw">:</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-volume</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">mountPath</span><span class="kw">:</span><span class="at"> /data</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">volumeClaimTemplates</span><span class="kw">:</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-volume</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">accessModes</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">&quot;ReadWriteOnce&quot;</span><span class="kw">]</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">requests</span><span class="kw">:</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">storage</span><span class="kw">:</span><span class="at"> 1Gi</span></span></code></pre></div>
<h3 id="explanation-of-the-configuration">Explanation of the
Configuration:</h3>
<ul>
<li><strong>serviceName</strong>: This is the name of the headless
service that controls the domain of the pods.</li>
<li><strong>replicas</strong>: This tells how many pods we want to
run.</li>
<li><strong>selector</strong>: These are labels that help identify the
pods managed by the StatefulSet.</li>
<li><strong>volumeClaimTemplates</strong>: This defines the
PersistentVolumeClaim for each pod. It makes sure that storage is
persistent and linked to each pod.</li>
</ul>
<h3 id="deploying-the-statefulset">Deploying the StatefulSet:</h3>
<p>To deploy the StatefulSet, we save the YAML config above in a file
called <code>statefulset.yaml</code> and run this command:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> statefulset.yaml</span></code></pre></div>
<h3 id="managing-persistent-data">Managing Persistent Data:</h3>
<p>When we use StatefulSets, the persistent volumes are created
automatically and linked to the pods. This allows our Docker containers
to keep their data even during pod restarts or rescheduling.</p>
<p>By using StatefulSets, we can manage stateful applications well in a
Kubernetes environment. This helps us keep data safe and consistent
across different instances. For more about managing containers with
Docker in Kubernetes, check out <a
href="https://bestonlinetutorial.com/docker/how-to-use-docker-with-kubernetes-for-orchestration.html">this
article on container orchestration</a>.</p>
<h2
id="what-are-kubernetes-daemonsets-for-running-containers-continuously-with-docker">What
are Kubernetes DaemonSets for running containers continuously with
Docker?</h2>
<p>We use Kubernetes DaemonSets to make sure a specific container runs
on every node in a Kubernetes cluster or just on some nodes. This is
very helpful for services that need to run all the time. Examples are
monitoring agents, log collectors, and network proxies.</p>
<h3 id="key-features-of-daemonsets">Key Features of DaemonSets:</h3>
<ul>
<li><strong>Node Coverage</strong>: It automatically puts pods on every
eligible node.</li>
<li><strong>Automatic Updates</strong>: When a new node joins the
cluster, the DaemonSet puts the specified pod on that node
automatically.</li>
<li><strong>Selective Deployment</strong>: We can use node selectors or
affinity rules to choose which nodes should run the DaemonSet.</li>
</ul>
<h3 id="how-to-create-a-daemonset">How to Create a DaemonSet:</h3>
<p>We can define a DaemonSet in a YAML configuration file. Here is a
simple example of a DaemonSet that runs a logging agent on all
nodes.</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> DaemonSet</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> logging-agent</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">namespace</span><span class="kw">:</span><span class="at"> kube-system</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> logging-agent</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> logging-agent</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> logging-agent</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> logging-agent-image:latest</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">tolerations</span><span class="kw">:</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">key</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;node-role.kubernetes.io/master&quot;</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">effect</span><span class="kw">:</span><span class="at"> NoSchedule</span></span></code></pre></div>
<h3 id="deploying-the-daemonset">Deploying the DaemonSet:</h3>
<p>To create the DaemonSet, we apply the YAML file using the kubectl
command:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> daemonset.yaml</span></code></pre></div>
<h3 id="managing-daemonsets">Managing DaemonSets:</h3>
<ul>
<li><strong>List DaemonSets</strong>: We can see all DaemonSets in a
namespace with:</li>
</ul>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get daemonsets <span class="at">-n</span> kube-system</span></code></pre></div>
<ul>
<li><strong>Delete a DaemonSet</strong>: To remove a DaemonSet, we
run:</li>
</ul>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> delete daemonset logging-agent <span class="at">-n</span> kube-system</span></code></pre></div>
<p>Kubernetes DaemonSets are important for running containers all the
time on all or some nodes in our cluster. For more details on how to use
Docker with Kubernetes, you can check <a
href="https://bestonlinetutorial.com/docker/how-to-use-docker-with-kubernetes-for-orchestration.html">this
article on using Docker with Kubernetes</a>.</p>
<h2
id="how-can-you-implement-kubernetes-jobs-for-container-execution-with-docker">How
can you implement Kubernetes Jobs for container execution with
Docker?</h2>
<p>Kubernetes Jobs help us run tasks that we need to do just once or for
a certain time. They make sure that a set number of pods finish
successfully. This makes them great for batch processing or one-time
tasks.</p>
<p>To implement a Kubernetes Job for container execution with Docker, we
can follow these steps:</p>
<ol type="1">
<li><p><strong>Create a Job YAML file</strong>. This file tells us how
the Job should work. It includes the container image to use, the command
to run, and any needed settings.</p>
<p>Here is an example of <code>job.yaml</code>:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> batch/v1</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Job</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-job</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-container</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> my-docker-image:latest</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">command</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">&quot;echo&quot;</span><span class="kw">,</span><span class="at"> </span><span class="st">&quot;Hello, World!&quot;</span><span class="kw">]</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">restartPolicy</span><span class="kw">:</span><span class="at"> Never</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">backoffLimit</span><span class="kw">:</span><span class="at"> </span><span class="dv">4</span></span></code></pre></div>
<ul>
<li><code>apiVersion</code>: Shows the API version.</li>
<li><code>kind</code>: Tells us the type of resource (Job).</li>
<li><code>metadata</code>: Holds information about the job, like its
name.</li>
<li><code>spec</code>: Explains how we want it to be, including the pod
template.</li>
<li><code>restartPolicy</code>: We set this to <code>Never</code> to
stop the pod from restarting after it has finished.</li>
<li><code>backoffLimit</code>: This is how many times to retry before we
think the job has failed.</li>
</ul></li>
<li><p><strong>Apply the Job</strong>. We can use <code>kubectl</code>
to create the Job in our Kubernetes cluster.</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> job.yaml</span></code></pre></div></li>
<li><p><strong>Monitor the Job</strong>. We should check the status of
the Job to make sure it finished successfully.</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get jobs</span></code></pre></div></li>
<li><p><strong>View logs</strong>. If we want to see what the Job did,
we can get logs from the pod:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> logs job/my-job</span></code></pre></div></li>
<li><p><strong>Clean up</strong>. After the Job has finished, we may
want to delete it to save resources.</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> delete job my-job</span></code></pre></div></li>
</ol>
<p>Using Kubernetes Jobs for container execution with Docker helps us
manage batch tasks better. It makes sure they run to finish without us
having to do it manually. For more details on using Docker in a
Kubernetes environment, we can check <a
href="https://bestonlinetutorial.com/docker/how-to-use-docker-with-kubernetes-for-orchestration.html">using
Docker with Kubernetes for orchestration</a>.</p>
<h2
id="how-do-we-monitor-and-troubleshoot-container-health-in-kubernetes-with-docker">How
do we monitor and troubleshoot container health in Kubernetes with
Docker?</h2>
<p>Monitoring and troubleshooting container health in Kubernetes with
Docker is very important for keeping our applications working well.
Kubernetes gives us many tools to check if containers are running
properly.</p>
<h3 id="health-checks">1. Health Checks</h3>
<p>Kubernetes uses liveness and readiness probes to check container
health.</p>
<ul>
<li><strong>Liveness Probes</strong>: Check if a container is alive and
needs a restart.</li>
<li><strong>Readiness Probes</strong>: Show if a container is ready to
take traffic.</li>
</ul>
<p>Here is an example of a Deployment YAML:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> example-app</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> example</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> example</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> example-container</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> example-image:latest</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">livenessProbe</span><span class="kw">:</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">httpGet</span><span class="kw">:</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /health</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">initialDelaySeconds</span><span class="kw">:</span><span class="at"> </span><span class="dv">30</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">periodSeconds</span><span class="kw">:</span><span class="at"> </span><span class="dv">10</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">readinessProbe</span><span class="kw">:</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">httpGet</span><span class="kw">:</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /ready</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">initialDelaySeconds</span><span class="kw">:</span><span class="at"> </span><span class="dv">30</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">periodSeconds</span><span class="kw">:</span><span class="at"> </span><span class="dv">10</span></span></code></pre></div>
<h3 id="monitoring-tools">2. Monitoring Tools</h3>
<ul>
<li><strong>Prometheus</strong>: It helps us collect and store metrics.
We can also query them and set alerts.</li>
<li><strong>Grafana</strong>: It helps us visualize metrics from
Prometheus or other places.</li>
<li><strong>Kube-state-metrics</strong>: It exposes metrics about the
state of Kubernetes objects.</li>
</ul>
<h3 id="logging">3. Logging</h3>
<p>We can use logging agents like Fluentd or Logstash to collect logs
from containers. Then, we send these logs to a logging system like
Elasticsearch.</p>
<p>Here is an example Fluentd configuration:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;source&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="at">  @type docker</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="at">  path /var/lib/docker/containers/*.log</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="at">  pos_file /var/log/td-agent/docker.pos</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="at">  tag docker.*</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;/source&gt;</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;match docker.**&gt;</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="at">  @type elasticsearch</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="at">  host es-server</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="at">  port 9200</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="at">  logstash_format true</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;/match&gt;</span></span></code></pre></div>
<h3 id="kubernetes-events">4. Kubernetes Events</h3>
<p>Kubernetes keeps a record of events that help us fix problems. We can
use <code>kubectl get events</code> to see events related to pods,
deployments, and other resources. This gives us clues about failures or
warnings.</p>
<h3 id="command-line-tools">5. Command Line Tools</h3>
<ul>
<li><strong>kubectl</strong>: We can use commands like
<code>kubectl logs &lt;pod-name&gt;</code> to see logs. Also,
<code>kubectl describe pod &lt;pod-name&gt;</code> gives us detailed
information about the pod and its status.</li>
<li><strong>kubectl exec</strong>: This lets us run commands inside a
running container for debugging.</li>
</ul>
<p>Example command:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> exec <span class="at">-it</span> <span class="op">&lt;</span>pod-name<span class="op">&gt;</span> -- /bin/sh</span></code></pre></div>
<h3 id="resource-monitoring">6. Resource Monitoring</h3>
<p>We can check resource usage (CPU, memory) with
<code>kubectl top</code>:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> top pod</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> top node</span></code></pre></div>
<h3 id="network-troubleshooting">7. Network Troubleshooting</h3>
<p>We can use tools like <code>kubectl port-forward</code> to access
services locally. We can also run network checks (like <code>curl</code>
or <code>ping</code>) from inside a container with
<code>kubectl exec</code>.</p>
<h3 id="alerts-and-notifications">8. Alerts and Notifications</h3>
<p>We can set alerts based on metrics and logs. We can use Prometheus
Alertmanager or connect with services like PagerDuty or Slack to notify
us about container health issues.</p>
<p>By using these methods, we can monitor and troubleshoot container
health in Kubernetes with Docker. This helps us keep our applications
available and performing well.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3
id="how-do-kubernetes-and-docker-work-together-to-manage-containers">1.
How do Kubernetes and Docker work together to manage containers?</h3>
<p>Kubernetes and Docker work well together. We use Docker to create and
manage containers. Then, Kubernetes helps us to manage these containers
across many servers. It makes sure they run smoothly and can grow when
needed. When we use Kubernetes with Docker, we can automate things like
deployment and scaling. This makes it easier to keep containers running
well.</p>
<h3
id="what-are-the-differences-between-kubernetes-deployments-and-statefulsets">2.
What are the differences between Kubernetes Deployments and
StatefulSets?</h3>
<p>Kubernetes Deployments and StatefulSets have different jobs in
managing applications. Deployments are for stateless apps. They give us
features like rolling updates and scaling. On the other hand,
StatefulSets are for stateful apps. These apps need stable identities
and storage that lasts. Knowing these differences is important to keep
our containers running well on Kubernetes with Docker.</p>
<h3 id="how-do-i-monitor-the-health-of-my-containers-in-kubernetes">3.
How do I monitor the health of my containers in Kubernetes?</h3>
<p>We need to monitor container health in Kubernetes to keep our apps
running well. We can use health checks like liveness and readiness
probes to check if containers are okay. Also, we can use tools like
Prometheus and Grafana. These tools help us see the health of our
containers. By using them, we can fix problems before they get
worse.</p>
<h3
id="how-can-i-ensure-my-docker-containers-restart-automatically-in-kubernetes">4.
How can I ensure my Docker containers restart automatically in
Kubernetes?</h3>
<p>To make sure Docker containers restart automatically in Kubernetes,
we can set the restart policy in the Pod settings. The
<code>restartPolicy</code> field can be <code>Always</code>,
<code>OnFailure</code>, or <code>Never</code>. If we set it to
<code>Always</code>, our containers will restart by themselves if they
fail. This helps us keep our apps running all the time.</p>
<h3 id="what-role-do-kubernetes-jobs-play-in-container-management">5.
What role do Kubernetes Jobs play in container management?</h3>
<p>Kubernetes Jobs help us run batch processes or short tasks in
containers. They make sure a certain number of pods finish their jobs.
By using Kubernetes Jobs, we can manage one-time tasks in our Docker
containers. This way, they complete their work while keeping our
Kubernetes cluster stable.</p>
<p>For more insights on using Docker with Kubernetes, check out <a
href="https://bestonlinetutorial.com/docker/how-to-use-docker-with-kubernetes-for-orchestration.html">how
to use Docker with Kubernetes for orchestration</a>.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            