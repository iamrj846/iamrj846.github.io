
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
            <!-- Google tag (gtag.js) -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
            <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-TFCQEJR7TD');
            </script>
            <meta charset="utf-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
<script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "BestOnlineTutorial",
      "url": "https://www.bestonlinetutorial.com/"
    }
    </script>
            <!-- Common CSS & Icons -->
            <link rel="icon" href="/favicon.ico" type="image/x-icon">
            <link rel="stylesheet" href="/assets/plugins/highlight/styles/monokai-sublime.css">
            <link id="theme-style" rel="stylesheet" href="/assets/css/theme-8.css">
            <link rel="stylesheet" href="/assets/css/post.css">
            <title>What Are the Key Differences Between the 'COPY' and 'ADD' Commands in a Dockerfile?</title>
            <meta name="description" content="Discover the key differences between the 'COPY' and 'ADD' commands in a Dockerfile to optimize your container image builds.">
            <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	        <script src="/assets/js/blog.js"></script>
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">What Are the Key Differences Between the 'COPY' and 'ADD' Commands in a Dockerfile?</h1>
                        </header>

                        <div class="blog-post-body">
                            <p><strong>Understanding the Key Differences Between the COPY and ADD
Commands in a Dockerfile</strong></p>
<p>We need to understand the key differences between the ‘COPY’ and
‘ADD’ commands in a Dockerfile. This is important for creating Docker
images well. The ‘COPY’ command is simple. It moves files and folders
from the host to the Docker image. On the other hand, ‘ADD’ has more
features. It can work with remote URLs and also unpack compressed files.
These differences can change how we build Docker images. So, it is
important for developers to pick the right command for their needs.</p>
<p>In this article, we will look closely at the differences between
‘COPY’ and ‘ADD’ commands in a Dockerfile. We will explain what each
command does. We will see how ‘COPY’ handles file context. We will also
look at when to use ‘ADD’ and how both commands affect performance.
Plus, we will answer common questions to help us understand how to make
our Dockerfile better.</p>
<ul>
<li>What Are the Key Differences Between the COPY and ADD Commands in a
Dockerfile</li>
<li>Understanding the COPY Command in a Dockerfile</li>
<li>Exploring the ADD Command in a Dockerfile</li>
<li>How Does COPY Handle File Context in a Dockerfile</li>
<li>What Are the Use Cases for ADD in a Dockerfile</li>
<li>Performance Considerations for COPY and ADD in a Dockerfile</li>
<li>Frequently Asked Questions</li>
</ul>
<h2 id="understanding-the-copy-command-in-a-dockerfile">Understanding
the COPY Command in a Dockerfile</h2>
<p>We use the <code>COPY</code> command in a Dockerfile to move files
and folders from our host system into the Docker image. This command is
simple. It lets us set the source and destination paths.</p>
<h3 id="syntax">Syntax</h3>
<div class="sourceCode" id="cb1"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> &lt;source&gt; &lt;destination&gt;</span></code></pre></div>
<h3 id="example">Example</h3>
<p>If we want to copy a local folder called <code>app</code> into the
<code>/usr/src/app</code> folder in the image, we write:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> app /usr/src/app</span></code></pre></div>
<h3 id="key-points">Key Points</h3>
<ul>
<li>The <code>&lt;source&gt;</code> can be a file or folder path. This
path is relative to the build context.</li>
<li>The <code>&lt;destination&gt;</code> is where the files go inside
the image.</li>
<li>We can use wildcards in the source path.</li>
<li>The <code>COPY</code> command keeps the ownership and permissions of
the files.</li>
</ul>
<h3 id="context">Context</h3>
<p>The files or folders we mention in the <code>COPY</code> command need
to be in the build context. The build context is usually the folder
where the Dockerfile is located.</p>
<h3 id="limitations">Limitations</h3>
<ul>
<li>The <code>COPY</code> command cannot extract tar files. If we need
to do that, we should use the <code>ADD</code> command.</li>
<li>It also does not support downloading files from remote URLs. The
files must be in the build context.</li>
</ul>
<p>Using the <code>COPY</code> command helps us manage files in Docker
images in a clean way. It keeps the original file permissions and
attributes. For more details on Dockerfile basics, check out <a
href="https://bestonlinetutorial.com/docker/what-is-the-dockerfile-and-how-do-you-create-one.html">what
is a Dockerfile and how do you create one</a>.</p>
<h2 id="exploring-the-add-command-in-a-dockerfile">Exploring the ADD
Command in a Dockerfile</h2>
<p>The <code>ADD</code> command in a Dockerfile helps us copy files and
folders from a source on our host to the Docker image’s filesystem. It
has some special features compared to the <code>COPY</code> command.</p>
<h3 id="syntax-1">Syntax</h3>
<div class="sourceCode" id="cb3"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ADD</span> [source] [destination]</span></code></pre></div>
<h3 id="features-of-add">Features of ADD</h3>
<ul>
<li><p><strong>Local and Remote Sources</strong>: We can use
<code>ADD</code> for both local files and URLs. This means we can
download files from the internet while building the image.</p>
<p>Example:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ADD</span> https://example.com/file.tar.gz /app/</span></code></pre></div></li>
<li><p><strong>Automatic Extraction</strong>: If the source is a
compressed file like <code>.tar</code>, <code>.tar.gz</code>, or
<code>.zip</code>, <code>ADD</code> will automatically unpack the
contents to the destination we choose.</p>
<p>Example:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ADD</span> archive.tar.gz /app/</span></code></pre></div></li>
</ul>
<h3 id="limitations-of-add">Limitations of ADD</h3>
<ul>
<li><p><strong>Less Predictable</strong>: The automatic extraction
feature might give us unexpected results. This can happen if the file
types are not clear.</p></li>
<li><p><strong>No Cache</strong>: Unlike <code>COPY</code>, when we use
<code>ADD</code> with a URL, it does not use the Docker cache well. It
does not check the content of the URL.</p></li>
</ul>
<h3 id="use-cases-for-add">Use Cases for ADD</h3>
<ul>
<li>When we need to get files from a URL that we need during the image
build.</li>
<li>When we want to copy and unpack compressed files directly into the
image.</li>
</ul>
<h3 id="example-1">Example</h3>
<p>Here’s an example Dockerfile that uses the <code>ADD</code>
command:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> ubuntu:latest</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a local file</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="kw">ADD</span> ./local-file.txt /app/local-file.txt</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a remote file and extract it</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="kw">ADD</span> https://example.com/archive.tar.gz /app/</span></code></pre></div>
<p>In summary, the <code>ADD</code> command gives us extra features
compared to <code>COPY</code>. But we should use it carefully because it
can be unpredictable and not work well with caching. For most cases, we
should use <code>COPY</code> unless we really need what <code>ADD</code>
offers. For more details about Dockerfile commands, we can check the <a
href="https://bestonlinetutorial.com/docker/what-are-the-key-differences-between-cmd-and-entrypoint-in-a-dockerfile.html">differences
between <code>COPY</code> and <code>ADD</code></a>.</p>
<h2 id="how-does-copy-handle-file-context-in-a-dockerfile">How Does COPY
Handle File Context in a Dockerfile</h2>
<p>In a Dockerfile, the <code>COPY</code> command copies files and
folders from the source path on the host to the container’s filesystem
at the destination path we choose. It is important to understand how
<code>COPY</code> works with file context. This knowledge helps us build
Docker images better.</p>
<h3 id="file-context">File Context</h3>
<ul>
<li><strong>Build Context</strong>: The build context is the folder we
send to the Docker daemon during the build process. Only files in this
context can be used by commands like <code>COPY</code> and
<code>ADD</code>.</li>
<li><strong>Limitation</strong>: The <code>COPY</code> command cannot
reach files outside of the build context. For instance, if our build
context is <code>/app</code>, and we try to copy a file from
<code>/home/user/config.json</code>, it will not work.</li>
</ul>
<h3 id="syntax-2">Syntax</h3>
<p>The basic way to write the <code>COPY</code> command is:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> &lt;source_path&gt; &lt;destination_path&gt;</span></code></pre></div>
<h3 id="example-2">Example</h3>
<p>Let’s say our build context is <code>/app</code>. We can use this
command to copy a file named <code>example.txt</code> from the context
into the container:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> example.txt /usr/src/app/</span></code></pre></div>
<p>If we want to copy a folder and what is inside, we write:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> my_folder/ /usr/src/app/my_folder/</span></code></pre></div>
<h3 id="handling-wildcards">Handling Wildcards</h3>
<p>The <code>COPY</code> command can also use wildcards. For
example:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> *.txt /usr/src/app/</span></code></pre></div>
<p>This command copies all <code>.txt</code> files from the build
context to the specified folder in the container.</p>
<h3 id="permissions">Permissions</h3>
<p>The files we copy keep their original permissions. If we need to
change permissions, we can do that in a later <code>RUN</code>
command.</p>
<h3 id="best-practices">Best Practices</h3>
<ul>
<li>Always write the destination path clearly.</li>
<li>Keep the number of files in the build context low. This helps speed
up the build.</li>
<li>Use a <code>.dockerignore</code> file to leave out files and folders
that we do not need in the image.</li>
</ul>
<p>For more details on Docker commands and how to use them, check out <a
href="https://bestonlinetutorial.com/docker/what-is-the-dockerfile-and-how-do-you-create-one.html">this
complete guide on Docker commands</a>.</p>
<h2 id="what-are-the-use-cases-for-add-in-a-dockerfile">What Are the Use
Cases for ADD in a Dockerfile</h2>
<p>The <code>ADD</code> command in a Dockerfile is useful and can be
used in many situations. It does more than just copy files. Here are the
main uses for <code>ADD</code>:</p>
<ul>
<li><p><strong>Copying Files and Directories</strong>: Just like
<code>COPY</code>, we can use <code>ADD</code> to copy files and folders
from our computer into the Docker image.</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ADD</span> myfile.txt /app/</span></code></pre></div></li>
<li><p><strong>Extracting Tar Archives</strong>: When we add a
<code>.tar</code>, <code>.tar.gz</code>, or similar file,
<code>ADD</code> will automatically unpack it into the folder we
choose.</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ADD</span> myarchive.tar.gz /app/</span></code></pre></div></li>
<li><p><strong>Fetching Remote Files</strong>: <code>ADD</code> can get
files from a website and put them in the image. This is very helpful for
downloading things we need during the build.</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ADD</span> https://example.com/myfile.txt /app/</span></code></pre></div></li>
<li><p><strong>Handling Local Context</strong>: If we need to add files
that are not directly in the build context but can be accessed through
links or archives, we should use <code>ADD</code>.</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ADD</span> https://example.com/data.tar.gz /data/</span></code></pre></div></li>
<li><p><strong>Simplifying Multi-Stage Builds</strong>: In complex
Dockerfiles, especially with multi-stage builds, <code>ADD</code> can
help us get and use files from different places easily.</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> base <span class="kw">AS</span> builder</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">ADD</span> source.tar.gz /src/</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> runtime</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> <span class="op">--from=builder</span> /src/bin /app/bin</span></code></pre></div></li>
</ul>
<p>Even if <code>ADD</code> has these extra features, we often suggest
to use <code>COPY</code> for simple file copying tasks. This helps us
avoid surprises, like automatic unpacking or getting files from the
internet. For more about Docker commands, you can check <a
href="https://bestonlinetutorial.com/docker/what-is-the-dockerfile-and-how-do-you-create-one.html">this
article</a>.</p>
<h2
id="performance-considerations-for-copy-and-add-in-a-dockerfile">Performance
Considerations for COPY and ADD in a Dockerfile</h2>
<p>When we think about the performance of the <code>COPY</code> and
<code>ADD</code> commands in a Dockerfile, we see some important
factors. Both commands copy files from our host system to the Docker
image. But they have different effects on performance.</p>
<ol type="1">
<li><strong>File Size and Layering</strong>:
<ul>
<li>Both <code>COPY</code> and <code>ADD</code> make a new layer in the
Docker image. We usually like to use <code>COPY</code> because it is
simple and works well, especially for copying files without extra
steps.</li>
<li><code>ADD</code> is stronger since it can unpack compressed files.
But it can slow down the process if the files are big.</li>
</ul></li>
<li><strong>Context Handling</strong>:
<ul>
<li><code>COPY</code> follows the build context strictly. This means it
only looks at files in the context directory we choose. This way, we can
make the build faster by not moving too much data.</li>
<li><code>ADD</code> can get files from remote URLs. This may slow down
our builds because of network delays and possible problems when
downloading.</li>
</ul></li>
<li><strong>Cache Efficiency</strong>:
<ul>
<li>The Docker build cache prefers <code>COPY</code> commands. It can
easily cache these based on when the files were changed.</li>
<li>With <code>ADD</code>, if the source file changes, it can break the
cache. This can happen even if the change does not affect the final
image. So, it can take longer to build.</li>
</ul></li>
<li><strong>Example Usage</strong>:
<ul>
<li><p>Here is how we use <code>COPY</code> for local files:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> ./localfile.txt /app/localfile.txt</span></code></pre></div></li>
<li><p>Here is how we use <code>ADD</code> for unpacking a tarball:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ADD</span> ./archive.tar.gz /app/</span></code></pre></div></li>
</ul></li>
<li><strong>Best Practices</strong>:
<ul>
<li>We should use <code>COPY</code> when we just need to copy files
without other features.</li>
<li>We should use <code>ADD</code> only when we need its special
features like unpacking files or getting files from the internet.</li>
</ul></li>
</ol>
<p>By knowing these performance points, we can choose better between
<code>COPY</code> and <code>ADD</code> in our Dockerfile. This helps us
make the build process smoother and makes our Docker images work
better.</p>
<p>For more tips on Docker commands, we can check <a
href="https://bestonlinetutorial.com/docker/what-is-docker-and-why-should-you-use-it.html">this
article</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3
id="what-is-the-main-difference-between-the-copy-and-add-commands-in-a-dockerfile">1.
What is the main difference between the COPY and ADD commands in a
Dockerfile?</h3>
<p>The main difference between the <code>COPY</code> and
<code>ADD</code> commands in a Dockerfile is in what they can do. Both
commands move files from our computer to the Docker image. But
<code>ADD</code> has extra features. It can extract tar files and get
files from the internet. For most cases, we should use <code>COPY</code>
because it is simpler and clearer.</p>
<h3 id="when-should-i-use-add-instead-of-copy-in-my-dockerfile">2. When
should I use ADD instead of COPY in my Dockerfile?</h3>
<p>We should use the <code>ADD</code> command in a Dockerfile when we
need its special features. This includes when we want to automatically
extract compressed files or get files from a URL. But for just copying
files, the <code>COPY</code> command is better. It is simple and keeps
us from pulling in files from the internet by mistake, which is
safer.</p>
<h3
id="how-does-the-file-context-affect-the-behavior-of-copy-and-add-commands">3.
How does the file context affect the behavior of COPY and ADD
commands?</h3>
<p>The file context in a Dockerfile decides which files we can use with
the <code>COPY</code> and <code>ADD</code> commands. Both commands can
only see files in the build context. This context is set when we run the
<code>docker build</code> command. If we try to access files outside of
this context, we will get an error. This keeps our build environment
safe and contained.</p>
<h3
id="are-there-performance-implications-when-using-copy-vs.-add-in-dockerfiles">4.
Are there performance implications when using COPY vs. ADD in
Dockerfiles?</h3>
<p>Yes, there are performance issues when we use <code>COPY</code> and
<code>ADD</code>. The <code>COPY</code> command is usually faster
because it just copies files. In contrast, <code>ADD</code> can slow
things down because it might extract files or download them from URLs.
For the best performance, we should use <code>COPY</code> for simple
file transfers unless we need extra features.</p>
<h3
id="can-i-use-the-add-command-to-copy-files-from-a-remote-server-in-a-dockerfile">5.
Can I use the ADD command to copy files from a remote server in a
Dockerfile?</h3>
<p>Yes, the <code>ADD</code> command lets us copy files from a remote
server into our Docker image. But this can cause problems if the remote
files change. For stable builds, it is better to download files first
and then use the <code>COPY</code> command to add them to our Docker
image. This way, we keep the build context controlled.</p>
<p>These questions and answers help us understand the key differences
between the <code>COPY</code> and <code>ADD</code> commands in
Dockerfiles. This knowledge helps us make better choices when we create
Docker images. For more information about Docker basics, we can read
articles like <a
href="https://bestonlinetutorial.com/docker/what-is-docker-and-why-should-you-use-it.html">What
is Docker and Why Should You Use It</a> or <a
href="https://bestonlinetutorial.com/docker/what-are-docker-images-and-how-do-they-work.html">What
Are Docker Images and How Do They Work</a>.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            