
    
            <!DOCTYPE html>
        <html lang="en">

        <head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TFCQEJR7TD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TFCQEJR7TD');
</script>
            <title>How to Rollback Docker Swarm Services?</title>
            <meta name="description" content="Learn how to easily rollback Docker Swarm services with our step-by-step guide. Ensure seamless deployments and uptime!">

            <div id="head-placeholder"></div>
            <script src="/assets/js/blog.js" defer></script>
            <link rel="stylesheet" href="/assets/css/post.css">
        </head>

        <body>

            <div id="header-placeholder"></div>

            <div class="main-wrapper">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container single-col-max-width">
                        <header class="blog-post-header">
                            <h1 class="title mb-2">How to Rollback Docker Swarm Services?</h1>
                        </header>

                        <div class="blog-post-body">
                            <p>Rolling back Docker Swarm services mean going back to a previous
stable version after an update or deployment did not work well. This is
very important for keeping our applications running smoothly. It helps
us fix problems quickly when new deployments cause issues without making
users wait too long.</p>
<p>In this article, we will look at the main steps for rolling back
Docker Swarm services. We will learn how to understand Docker Swarm
service deployments. Then, we will check the current state of services.
Next, we will find previous versions and roll back a service using the
command line. We will also verify the rollback and answer some common
questions. This will help us understand the rollback process in Docker
Swarm better.</p>
<ul>
<li>How to Effectively Rollback Docker Swarm Services?</li>
<li>Understanding Docker Swarm Service Deployments?</li>
<li>Checking the Current State of Docker Swarm Services?</li>
<li>How to Identify the Previous Version of a Service?</li>
<li>Rolling Back a Docker Swarm Service Using Command Line?</li>
<li>Verifying the Rollback of Docker Swarm Services?</li>
<li>Frequently Asked Questions</li>
</ul>
<p>For more information about Docker and container orchestration, we can
read these articles: <a
href="https://bestonlinetutorial.com/docker/what-is-docker-and-why-should-you-use-it.html">What
is Docker and Why Should You Use It?</a>, <a
href="https://bestonlinetutorial.com/docker/what-is-docker-swarm-and-how-does-it-enable-container-orchestration.html">What
is Docker Swarm and How Does it Enable Container Orchestration?</a>, and
<a
href="https://bestonlinetutorial.com/docker/how-to-update-services-in-docker-swarm.html">How
to Update Services in Docker Swarm</a>.</p>
<h2 id="understanding-docker-swarm-service-deployments">Understanding
Docker Swarm Service Deployments</h2>
<p>Docker Swarm is a tool for managing containers. It helps us manage a
group of Docker nodes as one system. A service in Docker Swarm is a
container that runs for a long time in a Swarm cluster. When we deploy
services, we can set different properties like the image, number of
copies, update settings, and restart rules.</p>
<h3 id="key-concepts-of-docker-swarm-service-deployments">Key Concepts
of Docker Swarm Service Deployments</h3>
<ul>
<li><strong>Service</strong>: A service helps us decide how many copies
of a container we want to run in our swarm.</li>
<li><strong>Task</strong>: Each running copy of a service is called a
task. We spread tasks across the nodes in the swarm.</li>
<li><strong>Replicas</strong>: We can choose the number of replicas for
a service to keep it available and balance the load.</li>
<li><strong>Scaling</strong>: We can easily scale services up or down
with commands. This changes the number of replicas we need.</li>
<li><strong>Update Configuration</strong>: This feature helps us control
how updates happen for the service. We can set the speed and delay for
updates.</li>
<li><strong>Rollback Configurations</strong>: This is important. It
allows us to go back to the old version of a service if an update
fails.</li>
</ul>
<h3 id="deploying-a-service-in-docker-swarm">Deploying a Service in
Docker Swarm</h3>
<p>To deploy a simple service in Docker Swarm, we can use this
command:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> service create <span class="at">--name</span> my_service <span class="at">--replicas</span> 3 my_image:latest</span></code></pre></div>
<p>This command makes a service called <code>my_service</code> with 3
copies running the image we chose.</p>
<h3 id="updating-a-service">Updating a Service</h3>
<p>To update a service, we can use this command:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> service update <span class="at">--image</span> my_image:latest my_service</span></code></pre></div>
<p>This command updates <code>my_service</code> to use the latest
version of <code>my_image</code>.</p>
<h3 id="checking-service-status">Checking Service Status</h3>
<p>To check the status of our services, we can run:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> service ls</span></code></pre></div>
<p>This command shows us all services and their current state in the
Swarm.</p>
<p>By managing services well in Docker Swarm, we can keep our container
applications available and strong. For more tips on deploying Docker
services, we can check the article on <a
href="https://bestonlinetutorial.com/docker/how-to-create-and-deploy-services-in-docker-swarm.html">how
to create and deploy services in Docker Swarm</a>.</p>
<h2 id="checking-the-current-state-of-docker-swarm-services">Checking
the Current State of Docker Swarm Services?</h2>
<p>To check the current state of Docker Swarm services, we can use the
<code>docker service ls</code> command. This command shows all services
that are running in the swarm. It also shows their current state, number
of replicas, and image info.</p>
<p>Here is how we can use the command:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> service ls</span></code></pre></div>
<p>Example output:</p>
<pre><code>ID            NAME            MODE        REPLICAS  IMAGE
abc123def456  my_service      replicated  3/3      my_image:latest
def456abc123  another_service  global      5/5      another_image:1.0</code></pre>
<h3 id="inspecting-a-specific-service">Inspecting a Specific
Service</h3>
<p>If we want more detailed info about a service, we can use the
<code>docker service inspect</code> command. We need to add the service
name or ID after it:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> service inspect my_service</span></code></pre></div>
<p>This gives us a JSON output with details about the service. It
includes the desired state, update status, and task info.</p>
<h3 id="checking-service-tasks">Checking Service Tasks</h3>
<p>To see the current tasks of a specific service and their states, we
can use this command:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> service ps my_service</span></code></pre></div>
<p>This command gives us a list of tasks that the service manages. It
shows their states like running or failed:</p>
<pre><code>ID            NAME               SERVICE       IMAGE          NODE         DESIRED STATE  CURRENT STATE
xyz789abc123  my_service.1      my_service    my_image:latest node1        Running        Running 2 minutes ago
xyz789abc124  my_service.2      my_service    my_image:latest node2        Running        Running 2 minutes ago</code></pre>
<p>With these commands, we can easily check the current state of Docker
Swarm services and their tasks. For more info on managing Docker Swarm
services, we can read the article on <a
href="https://bestonlinetutorial.com/docker/how-to-create-and-deploy-services-in-docker-swarm.html">How
to Create and Deploy Services in Docker Swarm</a>.</p>
<h2 id="how-to-identify-the-previous-version-of-a-service">How to
Identify the Previous Version of a Service?</h2>
<p>To find the previous version of a Docker Swarm service, we can use
some simple Docker CLI commands. These commands give us info about
service updates and their versions. Here is how we can do it:</p>
<ol type="1">
<li><p><strong>List Services</strong>: First, we need to list all
services in the swarm. This helps us find the name of the service we
want.</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> service ls</span></code></pre></div></li>
<li><p><strong>Inspect Service</strong>: Next, we use the
<code>docker service inspect</code> command. This command shows us
detailed info about a specific service. It includes the current and
previous versions of the service.</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> service inspect <span class="op">&lt;</span>service_name<span class="op">&gt;</span> --pretty</span></code></pre></div>
<p>We should look at the <code>Spec</code> section. It has the
<code>TaskTemplate</code> with the image and settings. The
<code>ID</code> field shows our current service ID.</p></li>
<li><p><strong>Check the Service History</strong>: To see the update
history of the service, we can run the
<code>docker service inspect</code> command again. This time, we should
focus on the <code>UpdateStatus</code> section. It tells us about the
last update and its image version.</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> service inspect <span class="op">&lt;</span>service_name<span class="op">&gt;</span> --format <span class="st">&#39;{{.UpdateStatus}}&#39;</span></span></code></pre></div></li>
<li><p><strong>Using Docker Events</strong>: We can also look at Docker
events. This shows when the service was updated and which version was
used. This helps us understand the previous versions.</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> events <span class="at">--filter</span> <span class="st">&#39;event=update&#39;</span> <span class="at">--filter</span> <span class="st">&#39;event=rollback&#39;</span></span></code></pre></div></li>
<li><p><strong>Docker Swarm’s Rollback Feature</strong>: If we have
updated a service before, we can use the rollback feature. This lets us
go back to the last stable version without tracking versions
ourselves.</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> service rollback <span class="op">&lt;</span>service_name<span class="op">&gt;</span></span></code></pre></div></li>
</ol>
<p>By following these steps, we can find the previous version of a
Docker Swarm service. This helps us manage our deployments well. For
more details on how to deploy and manage services in Docker Swarm, check
out <a
href="https://bestonlinetutorial.com/docker/how-to-create-and-deploy-services-in-docker-swarm.html">how
to create and deploy services in Docker Swarm</a>.</p>
<h2 id="rolling-back-a-docker-swarm-service-using-command-line">Rolling
Back a Docker Swarm Service Using Command Line?</h2>
<p>To rollback a Docker Swarm service using the command line, we can use
the <code>docker service update</code> command with the
<code>--rollback</code> option. This helps us go back to the last
version of the service. Here’s how we can do it:</p>
<ol type="1">
<li><p><strong>Identify the Service Name</strong>: First, we need to
find the name or ID of the service we want to rollback.</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> service ls</span></code></pre></div></li>
<li><p><strong>Rollback the Service</strong>: Now we use this command to
start the rollback.</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> service rollback <span class="op">&lt;</span>service_name<span class="op">&gt;</span></span></code></pre></div>
<p>Here, we need to replace <code>&lt;service_name&gt;</code> with the
real name of our service.</p></li>
<li><p><strong>Monitor the Rollback Progress</strong>: We can check the
status of the rollback by using:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> service ps <span class="op">&lt;</span>service_name<span class="op">&gt;</span></span></code></pre></div></li>
<li><p><strong>Confirm the Rollback</strong>: After the rollback is
done, we should check that the service is back to its previous
state:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> service inspect <span class="op">&lt;</span>service_name<span class="op">&gt;</span></span></code></pre></div></li>
</ol>
<p>This command will show us the current setup of the service, including
the image version.</p>
<ol start="5" type="1">
<li><p><strong>Rollback to a Specific Revision (Optional)</strong>: If
we want to rollback to a specific version, we can do this by using the
<code>--image</code> flag with the image version we want during the
update command.</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> service update <span class="at">--image</span> <span class="op">&lt;</span>image_name<span class="op">&gt;</span>:<span class="op">&lt;</span>tag<span class="op">&gt;</span> <span class="op">&lt;</span>service_name<span class="op">&gt;</span></span></code></pre></div></li>
</ol>
<p>By following these steps, we can easily rollback Docker Swarm
services through the command line. This is important for keeping our
services stable and making sure our applications work well. For more
information on Docker Swarm and its services, we can check out <a
href="https://bestonlinetutorial.com/docker/what-is-docker-swarm-and-how-does-it-enable-container-orchestration.html">What
is Docker Swarm and How Does It Enable Container Orchestration?</a>.</p>
<h2 id="verifying-the-rollback-of-docker-swarm-services">Verifying the
Rollback of Docker Swarm Services?</h2>
<p>After we roll back a Docker Swarm service, it is important to check
if the rollback worked and if the service is running well. We can do
this in a few ways.</p>
<ol type="1">
<li><p><strong>Check Service Status</strong>: We can use this command to
see the current state of the service.</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> service ls</span></code></pre></div>
<p>This command will show all services in the swarm. It will tell us
their current state, how many replicas there are, and what image is
being used.</p></li>
<li><p><strong>Inspect Service Details</strong>: If we want more details
about a specific service, we can use:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> service inspect <span class="at">--pretty</span> <span class="op">&lt;</span>service_name<span class="op">&gt;</span></span></code></pre></div>
<p>We should replace <code>&lt;service_name&gt;</code> with the real
name of our service. This will show us detailed information like the
image used and the current task state.</p></li>
<li><p><strong>View Service Logs</strong>: Looking at the logs of the
service can give us useful information after the rollback. We can use
this command to see the logs:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> service logs <span class="op">&lt;</span>service_name<span class="op">&gt;</span></span></code></pre></div>
<p>This command will show us the logs from the service. It can help us
find issues or confirm that everything is working fine.</p></li>
<li><p><strong>Check Task Status</strong>: To check the status of
individual tasks in the service, we can use:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> ps <span class="at">--filter</span> <span class="st">&quot;name=&lt;service_name&gt;&quot;</span></span></code></pre></div>
<p>This command will list all tasks that are running with the service.
We can check if they are healthy and running the right version.</p></li>
<li><p><strong>Health Checks</strong>: If we have health checks set up
for our service, we can check the health status using:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> inspect <span class="at">--format</span> <span class="st">&quot;{{json .Spec.TaskTemplate.ContainerSpec.Healthcheck}}&quot;</span> <span class="op">&lt;</span>service_name<span class="op">&gt;</span></span></code></pre></div>
<p>This command gives us information about health check settings. We can
also check if the tasks are healthy.</p></li>
</ol>
<p>These steps will help us make sure that the rollback of Docker Swarm
services was done correctly and that the services are running as they
should. For more details on managing Docker Swarm services, we can look
at <a
href="https://bestonlinetutorial.com/docker/how-to-update-services-in-docker-swarm.html">how
to update services in Docker Swarm</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<h3 id="what-is-a-docker-swarm-rollback">1. What is a Docker Swarm
rollback?</h3>
<p>We can say that a Docker Swarm rollback is a way to go back to an
earlier stable version of a service we deployed. This helps a lot when a
new deployment causes problems or strange behavior. By rolling back, we
bring the service back to the last good setup. This way, we keep our
application running smoothly. For more details about Docker Swarm
services, check out <a
href="https://bestonlinetutorial.com/docker/what-is-docker-swarm-and-how-does-it-enable-container-orchestration.html">this
article</a>.</p>
<h3
id="how-can-i-check-the-current-version-of-a-docker-swarm-service">2.
How can I check the current version of a Docker Swarm service?</h3>
<p>To check the current version of a Docker Swarm service, we can use
the command <code>docker service ls</code>. This command shows us all
services in the swarm and their current state and image version. If we
want more details, we can use
<code>docker service inspect &lt;service_name&gt;</code>. This command
gives us detailed info about the service, including the image version it
is using. This is very important for us to keep track of our service
deployments.</p>
<h3
id="how-do-i-identify-the-previous-version-of-a-docker-swarm-service">3.
How do I identify the previous version of a Docker Swarm service?</h3>
<p>To find the previous version of a Docker Swarm service, we can look
at the service’s deployment history. We can use
<code>docker service inspect &lt;service_name&gt;</code> to see the
details of the service, which includes its last image version. It is
good to keep track of tags in our Docker images. These tags help us
quickly find and go back to the version we want.</p>
<h3 id="can-i-automate-docker-swarm-service-rollbacks">4. Can I automate
Docker Swarm service rollbacks?</h3>
<p>Yes, we can automate Docker Swarm service rollbacks. We can do this
by adding scripts into our continuous deployment pipeline. Tools like
Jenkins or GitLab CI/CD can help us set up a rollback command using
<code>docker service update --rollback &lt;service_name&gt;</code>. This
will happen if a deployment fails. This way, we can fix any issues fast
and keep our application stable.</p>
<h3 id="what-should-i-do-if-the-rollback-fails-in-docker-swarm">5. What
should I do if the rollback fails in Docker Swarm?</h3>
<p>If a rollback fails in Docker Swarm, we should first check the
service logs for errors by using
<code>docker service logs &lt;service_name&gt;</code>. We can also look
at the service details for more information. If we still have problems,
we can try to manually scale the service down and then back up. We can
also deploy the previous version directly with
<code>docker service update --image &lt;image_name&gt;:&lt;tag&gt; &lt;service_name&gt;</code>.
For more on managing services, see <a
href="https://bestonlinetutorial.com/docker/how-to-update-services-in-docker-swarm.html">this
resource</a>.</p>

                        </div>

                    </div>
                    <!--//container-->
                </article>

            </div>
            <!--//main-wrapper-->

            <div id="footer-placeholder"></div>

            <!-- Javascript -->
            <script src="/assets/plugins/popper.min.js" defer></script>
            <script src="/assets/plugins/bootstrap/js/bootstrap.min.js" defer></script>
            <script src="/assets/fontawesome/js/all.min.js" defer></script>
        </body>

        </html>
            
            